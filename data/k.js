function swipedetect(el,callback){console.log(el);var swipedir,startX,startY,distX,distY,elapsedTime,startTime,touchsurface=el,threshold=150,restraint=100,allowedTime=300,handleswipe=callback||function(){};touchsurface.addEventListener("touchstart",function(e){var touchobj=e.changedTouches[0];swipedir="none",dist=0,startX=touchobj.pageX,startY=touchobj.pageY,startTime=(new Date).getTime(),e.preventDefault(),console.log("touch start ~")},!1),touchsurface.addEventListener("touchmove",function(e){e.preventDefault(),console.log("touch move ~")},!1),touchsurface.addEventListener("touchend",function(e){var touchobj=e.changedTouches[0];distX=touchobj.pageX-startX,distY=touchobj.pageY-startY,elapsedTime=(new Date).getTime()-startTime,allowedTime>=elapsedTime&&(Math.abs(distX)>=threshold&&Math.abs(distY)<=restraint?swipedir=0>distX?"left":"right":Math.abs(distY)>=threshold&&Math.abs(distX)<=restraint&&(swipedir=0>distY?"up":"down")),handleswipe(swipedir),e.preventDefault(),console.log("touch end ~")},!1)}angular.module("gogoro.smarter.moduleSmarter9IqSystemView",[]).controller("moduleSmarter9IqSystemController",["$scope","$element",function(){var moduleSmarter9IqSystem={configure:{currentState:gogoro.App.getBreakpoint()},init:function(){var obj=this;obj.getState(),$(window).on("resize",function(){obj.configure.currentState!==gogoro.App.getBreakpoint()&&(obj.configure.currentState=gogoro.App.getBreakpoint(),obj.getState())})},getState:function(){var obj=this;"lg"===obj.configure.currentState||"md"===obj.configure.currentState?(obj.fallback.destroy(),obj.standard.init()):("sm"===obj.configure.currentState||"xs"===obj.configure.currentState)&&(obj.standard.destroy(),obj.fallback.init())},standard:{init:function(){console.log("---standard---"),console.log(gogoro.App.getBreakpoint()),console.log(gogoro.App.currentState)},destroy:function(){}},fallback:{init:function(){console.log("---fallback---"),console.log(gogoro.App.getBreakpoint()),console.log(gogoro.App.currentState)},destroy:function(){}}};moduleSmarter9IqSystem.init()}]),angular.module("gogoro.partial.GaContentTracking",[]).service("GATrackingService",function(){{var $rootEl,$rootId,gaConfig,debugMode=!1,idContainer=[];document.title}this.init=function(configs){gaConfig=configs,$rootId=gaConfig.id,$rootEl=$("#"+gaConfig.id),$rootEl.length>0?(debugMode===!1?ga("send","event",$rootId," PageLoaded"):console.log($rootId+" page loaded"),-1!=jQuery.inArray($rootId,idContainer)||(this._switcher($rootId),idContainer.push($rootId))):console.log("The ID of "+$rootId+" was not exist!!!")},this._switcher=function(id){switch(id){case"faster":this._trackingFaster(id);break;case"smarter":this._trackingSmarter(id);break;case"easier":this._trackingEasier(id);break;case"customize":this._trackingCustomize(id)}},this._trackingFaster=function(id){var category=id,actions={scrolling:"scrolling",play:"play"},sections=[{"class":".module-faster-0-site-intro",category:category,action:actions.scrolling,label:"site-intro"},{"class":".module-faster-1-page-intro",category:category,action:actions.scrolling,label:"page-intro"},{"class":".module-faster-2-clean-video",category:category,action:actions.scrolling,label:"clean-video"},{"class":".module-faster-3-summary-info",category:category,action:actions.scrolling,label:"summary-info"},{"class":".module-faster-4-performance-hero",category:category,action:actions.scrolling,label:"performance-hero"},{"class":".module-faster-5-powertrain",category:category,action:actions.scrolling,label:"powertrain"},{"class":".module-faster-7-comparison-infographic",category:category,action:actions.scrolling,label:"comparison-infographic"},{"class":".module-faster-8-control-hero",category:category,action:actions.scrolling,label:"control-hero"},{"class":".module-faster-9-chassis",category:category,action:actions.scrolling,label:"chassis"},{"class":".module-faster-10-suspension",category:category,action:actions.scrolling,label:"suspension"},{"class":".module-faster-11-compound-tire",category:category,action:actions.scrolling,label:"compound-tire"},{"class":".module-faster-12-13-balance-lean-angle",category:category,action:actions.scrolling,label:"balance-lean-angle"},{"class":".module-faster-14-aerodynamic-design",category:category,action:actions.scrolling,label:"aerodynamic-design"},{"class":".module-faster-15-waterproof",category:category,action:actions.scrolling,label:"waterproof"},{"class":".module-faster-16-design-ethos",category:category,action:actions.scrolling,label:"design-ethos"}];this._buildScrollingContentTracking(sections)},this._trackingSmarter=function(id){var category=id,actions={scrolling:"scrolling",play:"play"},sections=[{"class":".module-smarter-1-page-intro",category:category,action:actions.scrolling,label:"page-intro"},{"class":".module-smarter-2-clean-video",category:category,action:actions.scrolling,label:"clean-video"},{"class":".module-smarter-3-summary-info",category:category,action:actions.scrolling,label:"summary-info"},{"class":".module-smarter-4-ride-smart",category:category,action:actions.scrolling,label:"ride-smart"},{"class":".module-smarter-4a-ride-smart",category:category,action:actions.scrolling,label:"4a-ride-smart"},{"class":".module-smarter-4b-smart-mode-chart",category:category,action:actions.scrolling,label:"smart-mode-chart"},{"class":".module-smarter-5-gogoro-app",category:category,action:actions.scrolling,label:"gogoro-app"},{"class":".module-smarter-6-smart-battery",category:category,action:actions.scrolling,label:"smart-battery"},{"class":".module-smarter-7-vm",category:category,action:actions.scrolling,label:"vm"},{"class":".module-smarter-8-smart-vision",category:category,action:actions.scrolling,label:"smart-vision"},{"class":".module-smarter-auto-blinker-off",category:category,action:actions.scrolling,label:"auto-blinker-off"},{"class":".module-smarter-9-12-iq-system",category:category,action:actions.scrolling,label:"iq-system"},{"class":".module-smarter-13-design-ethos",category:category,action:actions.scrolling,label:"design-ethos"}];this._buildScrollingContentTracking(sections)},this._trackingEasier=function(id){var category=id,actions={scrolling:"scrolling",play:"play"},sections=[{"class":".module-easier-1-page-intro",category:category,action:actions.scrolling,label:"page-intro"},{"class":".module-easier-2-clean-video",category:category,action:actions.scrolling,label:"clean-video"},{"class":".module-easier-3-summary-info",category:category,action:actions.scrolling,label:"summary-info"},{"class":".module-easier-4-all-you-can-ride",category:category,action:actions.scrolling,label:"all-you-can-ride"},{"class":".module-easier-6-map",category:category,action:actions.scrolling,label:"map"},{"class":".module-easier-7-service-hero",category:category,action:actions.scrolling,label:"service-hero"},{"class":".module-easier-8-radical-simplicity",category:category,action:actions.scrolling,label:"radical-simplicity"},{"class":".module-easier-8-center-lock",category:category,action:actions.scrolling,label:"center-lock"},{"class":".module-easier-8-quick-fix",category:category,action:actions.scrolling,label:"quick-fix"},{"class":".module-easier-10-12-network-sos-service-staff",category:category,action:actions.scrolling,label:"network-sos-service-staff"},{"class":".module-easier-13-design-ethos",category:category,action:actions.scrolling,label:"design-ethos"}];this._buildScrollingContentTracking(sections)},this._trackingCustomize=function(id){var category=id,actions={scrolling:"scrolling",play:"play"},sections=[{"class":".module-customize-1-page-intro",category:category,action:actions.scrolling,label:"page-intro"},{"class":".module-customize-2-clean-video",category:category,action:actions.scrolling,label:"clean-video"},{"class":".module-customize-3-summary-info",category:category,action:actions.scrolling,label:"summary-info"},{"class":".module-customize-4-dashboard",category:category,action:actions.scrolling,label:"dashboard"},{"class":".module-customize-5-lighting-themes",category:category,action:actions.scrolling,label:"lighting-themes"},{"class":".module-customize-6-sounds-themes",category:category,action:actions.scrolling,label:"sounds-themes"},{"class":".module-customize-9-design-ethos",category:category,action:actions.scrolling,label:"design-ethos"}];this._buildScrollingContentTracking(sections)},this._buildScrollingContentTracking=function(sections){angular.forEach(sections,function(section){new ScrollScene({triggerElement:$(section["class"]),duration:0}).on("enter",function(){debugMode===!1?ga("send","event",section.category,section.action,section.label,1):(console.log("****************************"),console.log("Category:"+section.category),console.log("Class:"+section["class"]),console.log("Action:"+section.action),console.log("Label:"+section.label))}).addTo(new ScrollMagic)})}}),angular.module("gogoro.partial.moduleImageSequence",[]).controller("moduleImageSequenceController",["$scope","$element","frameCount","framePrefix",function($scope,$element,frameCount,framePrefix){for(var $el=$($element),$imageEl=$el.find("img.frame"),images=[],frameCountStringLength=String(frameCount).length,i=2;frameCount>=i;i++){var s="00"+String(i);s=s.substr(s.length-frameCountStringLength,frameCountStringLength),images.push(framePrefix+s+".jpg")}$.preloadimages(images);var obj={currImg:0},tween=TweenMax.to(obj,images.length/15,{currImg:images.length-1,roundProps:"currImg",repeat:0,immediateRender:!0,ease:Linear.easeNone,onUpdate:function(){$imageEl.attr("src",images[obj.currImg])},onComplete:function(){controller.removeScene(scene)}}),controller=new ScrollMagic,scene=new ScrollScene({triggerElement:$el.find(".trigger"),duration:0}).setTween(tween).addTo(controller)}]),angular.module("gogoro.partial.modulePageIntro",[]).service("ModulePageIntroService",function(){this.createElementFadeInTween=function($element,duration,delay,properties){var toProperties={opacity:1,delay:delay,repeat:0,immediateRender:!0,ease:Linear.easeNone},tween=TweenMax.fromTo($element,duration,{opacity:0},$.extend(toProperties,properties));return tween},this.createElementFadeOutTween=function($element,duration,delay,properties){var toProperties={opacity:0,delay:delay,repeat:0,immediateRender:!1,ease:Linear.easeNone},tween=TweenMax.to($element,duration,$.extend(toProperties,properties));return tween},this.createTitleFadeInTween=function($element,callback){var $el=$($element),duration=.75,delay=.5;return this.createElementFadeInTween($el,duration,delay,{onComplete:callback})},this.createTitleStaggeredFadeTween=function($element,callback){var that=this,$el=$($element).find(".title-wrapper tspan"),duration=.5,delay=.5,timeline=new TimelineMax,callbackWrapper={onComplete:callback};return $el.each(function(i,$tspanEl){timeline.add(that.createElementFadeInTween($tspanEl,duration,delay,i===$el.length-1?callbackWrapper:null))}),timeline},this.createBodyFadeInTween=function($element,callback,additionalDelay){void 0===additionalDelay&&(additionalDelay=2);var $el=$($element),$bodyEl=$el.find(".body"),opacityDuration=.9,slideDuration=.6,opacityDelay=.225+additionalDelay,slideDelay=.15+additionalDelay,opacityTween=TweenMax.fromTo($bodyEl,opacityDuration,{opacity:0},{opacity:1,delay:opacityDelay,repeat:0,immediateRender:!0,ease:Cubic.easeIn}),bottomTween=TweenMax.fromTo($bodyEl,slideDuration,{bottom:0},{bottom:"74px",delay:slideDelay,repeat:0,immediateRender:!0,ease:Linear.easeOut,onComplete:function(){callback&&callback()}}),timeline=new TimelineMax;return timeline.insert(opacityTween).insert(bottomTween),timeline}}),angular.module("gogoro.partial.moduleSummaryInfo",[]).controller("ModuleSummaryInfoController",["$scope","$element",function($scope,$element){var duration=.3,tween=TweenMax.staggerFromTo($($element).find(".title"),duration,{opacity:0,"margin-left":"-10%"},{opacity:1,"margin-left":0,repeat:0,immediateRender:!0,ease:Linear.easeNone},duration);this.controller=new ScrollMagic;new ScrollScene({triggerElement:$element,duration:0}).setTween(tween).addTo(this.controller)}]),angular.module("gogoro.partial.moduleVideoSlider",[]).controller("ModuleVideoSliderController",["$scope","$element","$window","$timeout","videoFrameTimes","shouldCrossFade","$timeout",function($scope,$element,$window,$timeout,videoFrameTimes,shouldCrossFade,$timeout){var $el=$($element),$contentEl=$el.children(".module-video-slider-content"),moduleHeightDidChange=function(){$contentEl.find(".video-viewport-wrapper").width($el.width())};$scope.playFrame=0,$scope.playNext=!1;var setCurrentContentFrame=function(targetContentFrame){if(currentContentFrame!==targetContentFrame){var lastContentFrame=currentContentFrame;currentContentFrame=targetContentFrame,$paginationEl.children(".page").removeClass("active").eq(currentContentFrame).addClass("active");var $textEl=$contentFramesEl.eq(currentContentFrame);if($contentFramesEl.not(":eq("+currentContentFrame+")").stop().fadeTo(shouldCrossFade?"fast":0,0).data("fading",!1),$videoEl.off("timeupdate",checkFrameTime),$videoEl.off("ended",checkFrameTime),lastContentFrame>=currentContentFrame||currentContentFrame-lastContentFrame>1){var time=videoFrameTimes[currentContentFrame];$videoEl[0].pause(),$videoEl[0].readyState>0&&($videoEl[0].currentTime=time),$textEl.data("fading")||$textEl.data("fading",!0).stop().delay(200).fadeTo("fast",1);var frame=currentContentFrame;$timeout(function(){frame===currentContentFrame&&$videoEl[0].readyState>0&&($videoEl[0].currentTime=time)},250)}else shouldCrossFade&&($textEl.data("fading")||$textEl.data("fading",!0).stop().fadeTo("fast",1)),$videoEl[0].readyState>0&&($videoEl[0].currentTime=videoFrameTimes[currentContentFrame-1]),$videoEl.on("timeupdate",checkFrameTime),currentContentFrame===totalContentFrames-1&&$videoEl.on("ended",checkFrameTime),$videoEl[0].play()}},checkFrameTime=function(e){if($videoEl[0].currentTime>=videoFrameTimes[currentContentFrame]||"ended"===e.type){$videoEl[0].pause(),$videoEl[0].readyState>0&&($videoEl[0].currentTime=videoFrameTimes[currentContentFrame]);var $textEl=$contentFramesEl.eq(currentContentFrame);shouldCrossFade||$textEl.data("fading")||$textEl.data("fading",!0).stop().fadeTo("fast",1),$videoEl.off("timeupdate",checkFrameTime),$videoEl.off("ended",checkFrameTime)}},$contentFramesEl=$contentEl.children(".frame"),currentContentFrame=0,totalContentFrames=videoFrameTimes.length,$videoViewportEl=$contentEl.find(".video-viewport"),$videoEl=$videoViewportEl.children("video");$videoViewportEl.width($videoEl.attr("width"));for(var $paginationEl=$contentEl.find(".frame-pagination"),i=0;totalContentFrames>i;i++)$paginationEl.append('<div class="page">');$paginationEl.children(".page").on("click",function(e){var targetContentFrame=$paginationEl.children(".page").index(this);setCurrentContentFrame(targetContentFrame),e.stopPropagation()}).eq(currentContentFrame).addClass("active"),$contentEl.on("click",function(){setCurrentContentFrame(currentContentFrame===totalContentFrames-1?0:currentContentFrame+1)});var resizeTimeout;$($window).resize(function(){clearTimeout(resizeTimeout),resizeTimeout=setTimeout(moduleHeightDidChange,100)}),moduleHeightDidChange()}]),angular.module("gogoro.partial.moduleVideo",[]).controller("ModuleVideoController",["$scope","$element","$window",function($scope,$element,$window){$scope.playVideo=function(){$videoEl[0].play()};var resizeToCover=function(){var containerW=$wrapperEl.width(),containerH=$wrapperEl.height();$viewportEl.width(containerW),$viewportEl.height(containerH);var scaleH=containerW/vidWOrig,scaleV=containerH/vidHOrig,scale=scaleH>scaleV?scaleH:scaleV;$videoEl.width(scale*vidWOrig),$videoEl.height(scale*vidHOrig),$videoEl.css({marginLeft:-(scale*vidWOrig)/2})},$wrapperEl=$($element),$viewportEl=$wrapperEl.children(".video-viewport"),$videoEl=$viewportEl.children("video"),vidWOrig=$videoEl.attr("width"),vidHOrig=$videoEl.attr("height");$($window).resize(resizeToCover),resizeToCover()}]).controller("ModuleVideoFixedHeightController",["$scope","$element","$window",function($scope,$element,$window){$scope.playVideo=function(){$videoEl[0].play()};var resizeToCoverFixedHeight=function(){var containerW=vidWOrig,containerH=$wrapperEl.height();$viewportEl.width(containerW),$viewportEl.height(containerH);var scale=containerH/vidHOrig;$videoEl.width(scale*vidWOrig),$videoEl.height(scale*vidHOrig)},$wrapperEl=$($element),$viewportEl=$wrapperEl.children(".video-viewport"),$videoEl=$viewportEl.children("video"),vidWOrig=$videoEl.attr("width"),vidHOrig=$videoEl.attr("height");$($window).resize(resizeToCoverFixedHeight),resizeToCoverFixedHeight()}]),angular.module("gogoro.partial.fallbackManager",[]).factory("FallbackManagerFactory",["$window",function($window){return{init:function($scope,$element,useFallbackForIE10){var that=this;void 0===useFallbackForIE10&&(useFallbackForIE10=!1),that.setState($scope,$element,useFallbackForIE10),$($window).on("resize",function(){gogoro.App.currentState!==$scope.currentState&&that.setState($scope,$element,useFallbackForIE10)})},isIE10OrLess:function(){return void 0!==document.body.style.msTouchAction||$("html.lt-ie10").length>0},isFF:function(){return"undefined"!=typeof InstallTrigger},setState:function($scope,$element,useFallbackForIE10){var that=this;void 0===useFallbackForIE10&&(useFallbackForIE10=!1),"standard"!==gogoro.App.currentState||useFallbackForIE10&&that.isIE10OrLess()?($($element).addClass("fallback").removeClass("standard"),that.standard.destroy(),that.fallback.init()):($($element).removeClass("fallback").addClass("standard"),that.fallback.destroy(),that.standard.init()),$scope.currentState=gogoro.App.currentState}}}]),function($,global){"use strict";function Footer(){}global.gogoro=global.gogoro||{},global.gogoro.partials=global.gogoro.partials||{},global.gogoro.partials.Footer=Footer}(window.jQuery,window),function($,global){"use strict";function Header(){var self=this;global.Modernizr.svg||$(".gogoro-logo").attr("src","http://images.gogoroapp.com/gogoro.png"),$(".navbar-default-gogoro .navbar-toggle").on("click",function(e){e.stopImmediatePropagation(),e.preventDefault(),self.toggleNav()}),this.$body=$("body"),this.$siteContainer=$("#site-container"),this.$navBrand=$(".navbar-default-gogoro .navbar-brand")}global.gogoro=global.gogoro||{},global.gogoro.partials=global.gogoro.partials||{},global.gogoro.partials.Header=Header;var gogoro=global.gogoro;Header.prototype.setPg=function(state){var $links=$(".navbar-primary a").removeClass("active");$links.filter('[data-state="'+state+'"]').addClass("active")},Header.prototype.toggleNav=function(){this.$body.hasClass("navigation-active")&&!this.$siteContainer.hasClass("velocity-animating")?this.closeNav():this.$siteContainer.hasClass("velocity-animating")||this.openNav()},Header.prototype.openNav=function(){var self=this,navWidth="xs"===gogoro.App.getBreakpoint()?268:400,transitionDuration=220;$(window).on("orientationchange",function(){self.closeNavImmediately()}),this.$body.addClass("navigation-active").css({height:$(window).outerHeight()}),this.$siteContainer.css({height:$(window).outerHeight(),overflow:"hidden",zIndex:100}),$("#site-overlay").length||($("<div>",{id:"site-overlay",css:{right:navWidth}}).appendTo("body"),$("#site-overlay").on("touchmove",function(e){e.preventDefault()})),$(".navbar-toggle .icon-bar:eq(0)").velocity({translateY:"xs"===gogoro.App.getBreakpoint()||"sm"===gogoro.App.getBreakpoint()?7:8},{duration:transitionDuration/2,easing:"easeOut",complete:function(){$(".navbar-toggle .icon-bar:eq(1)").velocity("fadeOut",{duration:transitionDuration/4}),$(this).velocity({rotateZ:"45deg"},{duration:transitionDuration/2,easing:"easeOut"})}}),$(".navbar-toggle .icon-bar:eq(2)").velocity({translateY:"xs"===gogoro.App.getBreakpoint()||"sm"===gogoro.App.getBreakpoint()?-7:-8},{duration:transitionDuration/2,easing:"easeOut",complete:function(){$(this).velocity({rotateZ:"-45deg"},{duration:transitionDuration/2,easing:"easeOut"})}}),$(".navbar-main").css({display:"block",top:0}),$(".navbar-main .navbar-container").scrollTop(0),$("#hero-header .gradient-one").length&&$("#hero-header .gradient-one, #hero-header  .gradient-two").velocity("stop"),this.$siteContainer.velocity({translateX:-navWidth},{duration:transitionDuration,easing:"easeOut"}),("md"===gogoro.App.getBreakpoint()||"lg"===gogoro.App.getBreakpoint())&&$(".navbar-default-gogoro .navbar-brand").velocity({translateX:navWidth},{duration:transitionDuration,easing:"easeOut"}),$(".navbar-items").velocity({translateX:30},{delay:50,duration:transitionDuration,easing:"easeOut"}),$(".navbar-default-gogoro.fixed").velocity({translateX:-navWidth},{duration:transitionDuration,easing:"easeOut"}),$("#site-overlay").on("click",function(e){e.stopImmediatePropagation(),self.toggleNav()}),setTimeout(function(){$(".close-navbar-primary").on("click",function(e){e.stopImmediatePropagation(),e.preventDefault(),self.closeNav()})},transitionDuration)},Header.prototype.closeNav=function(){var self=this,transitionDuration=180;$(window).unbind("orientationchange"),this.$siteContainer.velocity({translateX:0},{delay:50,duration:transitionDuration,easing:"easeOut",complete:function(){$(".navbar-main").attr("style",""),self.$siteContainer.attr("style","")}}),$(".navbar-toggle .icon-bar:eq(0)").velocity({rotateZ:"0deg"},{duration:transitionDuration/2,easing:"easeOut",complete:function(){$(".navbar-toggle .icon-bar:eq(1)").velocity("fadeIn",{duration:transitionDuration/4}),$(this).velocity({translateY:0},{duration:transitionDuration/2,easing:"easeOut"})}}),$(".navbar-toggle .icon-bar:eq(2)").velocity({rotateZ:"0deg"},{duration:transitionDuration/2,easing:"easeOut",complete:function(){$(this).velocity({translateY:0},{duration:transitionDuration/2,easing:"easeOut"})}}),$(".navbar-default-gogoro.fixed").velocity({translateX:0},{delay:50,duration:transitionDuration,easing:"easeOut"}),("md"===gogoro.App.getBreakpoint()||"lg"===gogoro.App.getBreakpoint())&&$(".navbar-default-gogoro .navbar-brand").velocity({translateX:0},{delay:50,duration:transitionDuration,easing:"easeOut"}),$(".navbar-items").velocity({translateX:-30},{duration:transitionDuration,easing:"easeOut"}),this.$body.removeClass("navigation-active").css({height:"auto"}),$("#site-overlay").remove(),$(".close-navbar-primary").unbind()},Header.prototype.closeNavImmediately=function(){var self=this;$(window).unbind("orientationchange"),this.$siteContainer.velocity({translateX:0},{duration:0,complete:function(){$(".navbar-main").attr("style",""),self.$siteContainer.attr("style","")}}),$(".navbar-default-gogoro.fixed").attr("style",""),$(".navbar-primary").attr("style",""),("md"===gogoro.App.getBreakpoint()||"lg"===gogoro.App.getBreakpoint())&&$(".navbar-default-gogoro .navbar-brand").attr("style",""),this.$body.removeClass("navigation-active").css({height:"auto"}),$("#site-overlay").remove(),$(".close-navbar-primary").unbind()}}(window.jQuery,window),angular.module("gogoro.partial.tabbarView",[]).directive("tabbar",["$window",function($window){return{scope:{},link:function(scope,element){{var storedScrollPosition=0,currentScrollPosition=0,navOffset=$(element).offset().top,$el=$(element).find(".tabbar-wrapper");$el.find(".tabbar")}$($window).scrollTop()>=navOffset&&$el.addClass("fixed");var setup=function(){navOffset=$(element).offset().top},showTabbarNav=function(current){var currentSection=current.attr("class").split(" ")[0];$(".tabbar-container").clone().addClass("cloned").addClass(currentSection).appendTo("body"),$("<i>",{"class":"icon icon-close"}).appendTo(".tabbar-container.cloned .tabbar-wrapper"),$(".tabbar-container.cloned .icon-close").on("click",function(){removeTabbarNav()}),$(".tabbar-container.cloned").velocity("fadeIn",{duration:150,ease:"easeOut"}),$(".tabbar-container.cloned .tabbar").velocity("transition.expandIn",{delay:100,duration:150,ease:"easeOut",display:"table-cell"}),$(".tabbar-container.cloned a, .tabbar-overlay").on("click",function(){$(element).removeClass("active"),removeTabbarNav()})},removeTabbarNav=function(){$(".tabbar-container.cloned").velocity("fadeOut",{duration:250,complete:function(){$(".tabbar-container.cloned").remove()}})},xsTabbar=function(){$("a",$el).unbind().on("click",function(e){e.preventDefault();var $this=$(this);showTabbarNav($this)})};"xs"===gogoro.App.getBreakpoint()&&xsTabbar(),setup(),$($window).on("scroll",function(){currentScrollPosition=$($window).scrollTop(),currentScrollPosition>=navOffset?$el.addClass("fixed"):$el.removeClass("fixed"),storedScrollPosition=currentScrollPosition}),$($window).on("resize",function(){"xs"===gogoro.App.getBreakpoint()?xsTabbar():$("a",$el).unbind()})}}}]),function(){for(var method,noop=function(){},methods=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"],length=methods.length,console=window.console=window.console||{};length--;)method=methods[length],console[method]||(console[method]=noop)}(),angular.module("gogoro",["ui.bootstrap","ui.router","angular-inview","gogoro.partial.tabbarView","gogoro.partial.fallbackManager","gogoro.partial.modulePageIntro","gogoro.partial.moduleSummaryInfo","gogoro.partial.moduleVideo","gogoro.partial.moduleVideoSlider","gogoro.partial.GaContentTracking","gogoro.fasterView","gogoro.faster.moduleFaster0SiteIntroView","gogoro.faster.moduleFaster1PageIntroView","gogoro.faster.moduleFaster2CleanVideoView","gogoro.faster.moduleFaster3SummaryInfoView","gogoro.faster.moduleFaster4PerformanceHeroView","gogoro.faster.moduleFaster5PowertrainView","gogoro.faster.moduleFaster7ComparisonInfographicView","gogoro.faster.moduleFasterControlHeroView","gogoro.faster.moduleFaster9ChassisView","gogoro.faster.moduleFaster10SuspensionView","gogoro.faster.moduleFaster11CompoundTireView","gogoro.faster.moduleFaster11aCenterLockView","gogoro.faster.moduleFaster14AerodynamicDesignView","gogoro.faster.moduleFaster15WaterproofView","gogoro.faster.moduleFaster16DesignEthosView","gogoro.smarter.moduleSmarter1PageIntroView","gogoro.smarter.moduleSmarter2CleanVideoView","gogoro.smarter.moduleSmarter3SummaryInfoView","gogoro.smarter.moduleSmarterRideSmartView","gogoro.smarter.moduleSmarter5GogoroAppView","gogoro.smarter.moduleSmarter6SmartBatteryView","gogoro.smarter.moduleSmarter7VMView","gogoro.smarter.moduleSmarter8SmartVisionView","gogoro.smarter.moduleSmarterAutoBLinkerOffView","gogoro.smarter.moduleSmarter9IqSystemView","gogoro.smarter.moduleSmarter12DesignEthosView","gogoro.easier.moduleEasier1PageIntroView","gogoro.easier.moduleEasier2CleanVideoView","gogoro.easier.moduleEasier3SummaryInfoView","gogoro.easier.moduleEasier4AllYouCanRideView","gogoro.easier.moduleEasier5SwapAndGoView","gogoro.easier.moduleEasier6MapView","gogoro.easier.moduleEasier7ServiceHeroView","gogoro.easier.moduleEasier8QuickFixView","gogoro.easier.moduleEasier9CenterLockView","gogoro.easier.moduleEasier9WarrantyView","gogoro.customize.moduleCustomize1PageIntroView","gogoro.customize.moduleCustomize2CleanVideoView","gogoro.customize.moduleCustomize4DashboardView","gogoro.customize.moduleCustomize7LightingThemesView","gogoro.customize.moduleCustomize6SoundsThemesView","gogoro.customize.moduleCustomize9DesignEthosView","gogoro.smarterView","gogoro.easierView","gogoro.customizeView"]).config(["$stateProvider","$urlRouterProvider","$locationProvider",function($stateProvider,$urlRouterProvider){$stateProvider.state("faster",{url:"/faster",templateUrl:"/faster/index.html",controller:"FasterController"}).state("smarter",{url:"/smarter",templateUrl:"/smarter/index.html",controller:"SmarterController"}).state("easier",{url:"/easier",templateUrl:"/easier/index.html",controller:"EasierController"}).state("customize",{url:"/customize",templateUrl:"/customize/index.html",controller:"CustomizeController"}),$urlRouterProvider.otherwise("/faster")}]).controller("AppController",["$scope","$rootScope","$state",function($scope,$rootScope,$state){$rootScope.$on("$stateChangeSuccess",function(){$rootScope.stateName=$state.current.name})}]).run(["$rootScope",function(){}]).directive("ieUpgradeBox",function(){return{restrict:"A",templateUrl:"_partials/ie-upgrade/index.html",controller:function($scope,$element){var $elm=$($element),btn=$elm.find("a.btn.btn-outline");btn.on("click",function(e){e.preventDefault(),$elm.animate({opacity:0},500,function(){$elm.hide()})})},controllerAs:"ieAlert"}});var dist,Application=function($,global){"use strict";function App(){this.header=new global.gogoro.partials.Header,this.footer=new global.gogoro.partials.Footer,FastClick.attach(document.body)}return global.gogoro=global.gogoro||{},global.gogoro.App=App,App.mediaQueries={xs:{min:0,max:767},sm:{min:768,max:991},md:{min:992,max:1199},lg:{min:1200}},App.getBreakpoint=function(){var browserWidth=$(window).outerWidth();return browserWidth>=App.mediaQueries.xs.min&&browserWidth<=App.mediaQueries.xs.max?"xs":browserWidth>=App.mediaQueries.sm.min&&browserWidth<=App.mediaQueries.sm.max?"sm":browserWidth>=App.mediaQueries.md.min&&browserWidth<=App.mediaQueries.md.max?"md":browserWidth>=App.mediaQueries.lg.min?"lg":void 0},App.currentState=null,App.isTakeoverActive=!1,App.getState=function(){var state=null;return state=$("html").hasClass("lt-ie10")||isMobile.any||"xs"===gogoro.App.getBreakpoint()||"sm"===gogoro.App.getBreakpoint()?"fallback":"standard"},App.setState=function(){function setPageState(){"standard"===gogoro.App.currentState?$("body").removeClass("state-fallback").addClass("state-standard"):$("body").removeClass("state-standard").addClass("state-fallback")}gogoro.App.currentState=gogoro.App.getState(),setPageState(),$(window).on("resize",function(){gogoro.App.currentState=gogoro.App.getState(),setPageState()}),App.takeoverDetect=!0,App.enableMove=!1,App.LoadTakeover=function(){$("body").hasClass("intro-takeover-loaded")||($(".navbar-header").removeClass("white"),$(window).scrollTop(0),$("body").addClass("intro-takeover"),$("#landingPage").css({top:0}),$(".module-faster-0-site-intro").css({height:$(window).outerHeight(),top:0,display:"block"}),$(window).on("resize",function(){$("body").hasClass("intro-takeover")&&$(".module-faster-0-site-intro").css({height:$(window).outerHeight()})}),gogoro.scene=0,App.setupMovie(),$(".module-faster-0-site-intro .intro-container").css({top:0}),$(".module-faster-0-site-intro").unbind("mousewheel DOMMouseScroll MozMousePixelScroll").on("mousewheel DOMMouseScroll MozMousePixelScroll",function(event){gogoro.App.enableMove&&gogoro.App.takeoverDetect&&(event.originalEvent.detail>0||event.originalEvent.wheelDelta<0?gogoro.App.removeTakeover():1===gogoro.scene&&App.rollBackTakeover())})),$(".module-faster-0-site-intro")[0]&&"fallback"===gogoro.App.getState&&swipedetect($(".module-faster-0-site-intro")[0],function(swipedir){"up"==swipedir?0===gogoro.scene?gogoro.App.LoadMovieClip():gogoro.App.removeTakeover():"down"==swipedir&&1===gogoro.scene&&App.rollBackTakeover()})},App.setupMovie=function(){function launchPlayer(){gogoro.App.ytplayer=new YT.Player("bgPlayer",{videoId:videoId,playerVars:{controls:1,autoplay:0},events:{onReady:function(){gogoro.App.ytplayer.loadVideoById(videoId,0,"hd1080"),gogoro.App.ytplayer.pauseVideo()},onStateChange:onStateChange}})}function onStateChange(e){0===e.data&&gogoro.App.removeTakeover()}var videoId="zIwkHeG1hAE";if(!gogoro.App.loadedApi){var tag=document.createElement("script");tag.src="https://www.youtube.com/iframe_api";var firstScriptTag=document.getElementsByTagName("script")[0];firstScriptTag.parentNode.insertBefore(tag,firstScriptTag)}if(global.onYouTubeIframeAPIReady=function(){gogoro.App.loadedApi=!0,launchPlayer()},void 0!==gogoro.App.ytplayer)try{gogoro.App.ytplayer.loadVideoById(videoId,0,"hd1080"),gogoro.App.ytplayer.pauseVideo()}catch(e){launchPlayer()}},App.LoadMovieClip=function(){gogoro.App.takeoverDetect=!1,$("#landingPage").animate({top:"-100%"},"slow","linear",function(){$(".navbar-header").addClass("white"),gogoro.App.enableTakeoverDetect(),gogoro.scene=1
})},App.rollBackTakeover=function(){gogoro.scene=0,gogoro.App.takeoverDetect=!1,void 0!==gogoro.App.ytplayer&&gogoro.App.ytplayer.pauseVideo(),$("#landingPage").animate({top:"0"},"slow","linear",function(){gogoro.scene=0,$(".navbar-header").removeClass("white"),gogoro.App.enableTakeoverDetect()})},App.enableTakeoverDetect=function(){setTimeout(function(){gogoro.App.takeoverDetect=!0},1e3)},App.removing=!1,App.removeTakeover=function(){if(!gogoro.App.removing){"standard"===gogoro.App.getState()&&(angular.element(document.getElementById("module-faster-1-page-intro")).scope().standard.destroy(),angular.element(document.getElementById("module-faster-1-page-intro")).scope().standard.init()),gogoro.App.removing=!0,$(".nav-bar-stop").hide(),$(".navbar").show(),$(".navbar-header").removeClass("white"),$(".video_hero .container").removeClass("transparent");var windowHeight=$(window).outerHeight();$("body").scrollTop(0),$(".module-faster-0-site-intro").velocity({top:-2*windowHeight},{duration:windowHeight,ease:"easeOut",complete:function(){$(".module-faster-0-site-intro").unbind("mousewheel").css({display:"none"}),$(".inavbar-header").removeClass("white");try{gogoro.App.ytplayer.stopVideo(),gogoro.App.removing=!1}catch(e){}setTimeout(function(){$("body").removeClass("intro-takeover").addClass("intro-takeover-loaded")},300)}})}}},{init:function(){global.gogoro.app=new global.gogoro.App,gogoro.App.setState(),(isMobile.phone||isMobile.tablet)&&$("body").addClass("mobile"),$(".navbar-brand").on("click",function(){"standard"===gogoro.App.getState()&&(gogoro.App.isTakeoverActive=!0,$("body").removeClass("intro-takeover-loaded").addClass("intro-takeover"),App.removing=!1,App.LoadTakeover())})}}}(window.jQuery,window);$(Application.init),$(document).ready(function(){preloadImg=["//gogoro.imgix.net/site-intro-gogoro.png?w=550"],$.each(preloadImg,function(i,obj){var _img=new Image;_img.src=obj}),$("img.svg").each(function(){var $img=jQuery(this),imgID=$img.attr("id"),imgClass=$img.attr("class"),imgURL=$img.attr("src");jQuery.get(imgURL,function(data){var $svg=jQuery(data).find("svg");"undefined"!=typeof imgID&&($svg=$svg.attr("id",imgID)),"undefined"!=typeof imgClass&&($svg=$svg.attr("class",imgClass+" replaced-svg")),$svg=$svg.removeAttr("xmlns:a"),$img.replaceWith($svg)},"xml"),setTimeout(function(){window.scrollTo(0,1)},100)})}),setTimeout(function(){$("#main-footer").css("display","block")},6e3),angular.module("gogoro.customizeView",[]).controller("CustomizeController",["$scope","$window","GATrackingService",function($scope,$window,GATrackingService){$window.scrollTo(0,0);var gaConfig={id:"customize"};GATrackingService.init(gaConfig),ga("send","pageview","/#/customize"),$("body").hasClass("navigation-active")&&$(".navbar-toggle").click();new gogoro.common.ResponsiveImages;Modernizr.svg||$('img[src*="svg"]').each(function(){var $this=$(this);$this.attr("src",function(){return $this.attr("src").replace(".svg",".png")})})}]),angular.module("gogoro.customize.moduleCustomize1PageIntroView",[]).controller("moduleCustomize1PageIntroController",["$scope","$element","FallbackManagerFactory","ModulePageIntroService",function($scope,$element,FallbackManagerFactory,ModulePageIntroService){angular.extend($scope,FallbackManagerFactory);var $el=$($element);$scope.isIE10OrLess()||$el.find(".title-wrapper").append($el.find("script.svg").html()),$scope.standard={init:function(){imgix.onready(function(){imgix.fluid({fluidClass:"background-image-standard"})});var createTitleFadeInTween=function($el,delay){var duration=.75;return ModulePageIntroService.createElementFadeInTween($el,duration,delay)},createTitleFadeOutTween=function($el,delay){var duration=.5;return ModulePageIntroService.createElementFadeOutTween($el,duration,delay)},$el=$($element),findSuffix=$scope.isFF()?" text":" tspan",title0InTween=createTitleFadeInTween($el.find(".title-0"+findSuffix)),title1InTween=createTitleFadeInTween($el.find(".title-1"+findSuffix)),title1OutTween=createTitleFadeOutTween($el.find(".title-1"+findSuffix),.25),title2InTween=createTitleFadeInTween($el.find(".title-2"+findSuffix)),title2OutTween=createTitleFadeOutTween($el.find(".title-2"+findSuffix),.25),title3InTween=createTitleFadeInTween($el.find(".title-3"+findSuffix)),bodyTween=ModulePageIntroService.createBodyFadeInTween($element,null,.5);this.timeline=new TimelineMax({delay:.25}),this.timeline.insert(bodyTween).add(title0InTween).add(title1InTween).add(title1OutTween).add(title2InTween).add(title2OutTween).add(title3InTween).play()},destroy:function(){this.timeline&&(this.timeline.pause(0,!0).remove(),this.timeline=null),$(".body",$element).attr("style","")}},$scope.fallback={init:function(){imgix.onready(function(){imgix.fluid({fluidClass:"background-image-fallback"})})},destroy:function(){}},$scope.init($scope,$element,!0)}]),angular.module("gogoro.customize.moduleCustomize2CleanVideoView",[]).controller("moduleCustomize2CleanVideoController",["$scope","$element","$window","$controller","FallbackManagerFactory",function($scope,$element,$window,$controller,FallbackManagerFactory){angular.extend($scope,FallbackManagerFactory),$scope.standard={init:function(){$(".video",$element).css({display:"block"}),$.extend(this,$controller("ModuleVideoController",{$scope:$scope,$element:$element,$window:$window}));new gogoro.common.VideoModal},destroy:function(){$(".video",$element).css({display:"none"})}},$scope.fallback={init:function(){},destroy:function(){}},$scope.init($scope,$element)}]),angular.module("gogoro.customize.moduleCustomize4DashboardView",[]).controller("moduleCustomize4DashboardController",["$scope","$element","$window","$document","FallbackManagerFactory",function($scope,$element,$window,$document,FallbackManagerFactory){angular.extend($scope,FallbackManagerFactory),$scope.standard={init:function(){imgix.fluid({fluidClass:"customize-4-standard"});var that=this,draggingDial=!1,steps=[[12,255,255,"rgb(12, 255, 255)"],[12,197,255,"rgb(12, 197, 255)"],[12,139,255,"rgb(12, 139, 255)"],[12,81,255,"rgb(12, 81, 255)"],[12,23,255,"rgb(12, 23, 255)"],[59,12,255,"rgb(59, 12, 255)"],[117,12,255,"rgb(117, 12, 255)"],[175,12,255,"rgb(175, 12, 255)"],[233,12,255,"rgb(233, 12, 255)"],[255,12,218,"rgb(255, 12, 218)"],[255,12,161,"rgb(255, 12, 161)"],[255,12,103,"rgb(255, 12, 103)"],[255,12,45,"rgb(255, 12, 45)"],[255,37,12,"rgb(255, 37, 12)"],[255,95,12,"rgb(255, 95, 12)"],[255,153,12,"rgb(255, 153, 12)"],[255,211,12,"rgb(255, 211, 12)"],[240,255,12,"rgb(240, 255, 12)"],[185,255,12,"rgb(182, 255, 12)"],[125,255,12,"rgb(125, 255, 12)"],[67,255,12,"rgb(67, 255, 12)"],[12,255,15,"rgb(12, 255, 15)"],[12,255,73,"rgb(12, 255, 73)"],[12,255,131,"rgb(12, 255, 131)"],[12,255,189,"rgb(12, 255, 189)"],[12,255,247,"rgb(12, 255, 247)"]],hsvToRgb=function(h,s,v){h*=6;var i=~~h,f=h-i,p=v*(1-s),q=v*(1-f*s),t=v*(1-(1-f)*s),mod=i%6,r=255*[v,q,p,p,t,v][mod],g=255*[t,v,v,q,p,p][mod],b=255*[p,p,t,v,v,q][mod];return[r,g,b,"rgb("+~~r+","+~~g+","+~~b+")"]},rgb2hex=function(rgb){return rgb=rgb.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i),rgb&&4===rgb.length?"#"+("0"+parseInt(rgb[1],10).toString(16)).slice(-2)+("0"+parseInt(rgb[2],10).toString(16)).slice(-2)+("0"+parseInt(rgb[3],10).toString(16)).slice(-2):""},distanceBetweenColors=function(a,b){return Math.sqrt(Math.pow(a[0]-b[0],2)+Math.pow(a[1]-b[1],2)+Math.pow(a[2]-b[2],2))},closestColor=function(color){for(var closestIndex=0,closestDistance=-1,i=0;i<steps.length;i++){var distance=distanceBetweenColors(color,steps[i]);(-1===closestDistance||closestDistance>distance)&&(closestIndex=i,closestDistance=distance)}return steps[closestIndex]},buildColorWheels=function($el){var colorWheelCanvas,width=130,circleMargin=14,diameter=width-2*circleMargin,radius=diameter/2,torusThickness=5,dialTrackRadius=radius-torusThickness/2,createColorWheelCanvas=function(){for(var scaleFactor=4,scaledWidth=width*scaleFactor,scaledRadius=radius*scaleFactor,scaledRadiusSquared=scaledRadius*scaledRadius,scaledTorusThickness=torusThickness*scaleFactor,scaledRMT=scaledRadius-scaledTorusThickness,scaledRMTSquared=scaledRMT*scaledRMT,wheelPixel=4*circleMargin*(scaledWidth+1),canvas=$("<canvas>").attr({width:scaledWidth,height:scaledWidth})[0],context=canvas.getContext("2d"),imageData=context.createImageData(scaledWidth,scaledWidth),pixels=imageData.data,y=0;scaledWidth>y;y++)for(var x=0;scaledWidth>x;x++){var rx=x-scaledRadius,ry=y-scaledRadius,d=rx*rx+ry*ry,rgb=hsvToRgb((Math.atan2(ry,rx)+Math.PI)/(2*Math.PI),Math.sqrt(d)/scaledRadius,1);pixels[wheelPixel++]=rgb[0],pixels[wheelPixel++]=rgb[1],pixels[wheelPixel++]=rgb[2],pixels[wheelPixel++]=d>scaledRadiusSquared||scaledRMTSquared>d?0:255}context.putImageData(imageData,0,0),scaledWidth/=2,colorWheelCanvas=$("<canvas>").attr({width:scaledWidth,height:scaledWidth})[0],colorWheelCanvas.getContext("2d").drawImage(canvas,0,0,scaledWidth,scaledWidth)},buildColorWheel=function(index,element){var $colorWheelEl,$dialEl,dialWidth2,$el=$(element),dialY=1===index?-radius/2:81,dialX=1===index?radius/2:50,iKey=index,isLoop=!1,loopNumber=0,timeoutSec=150,pointParting=10,loopPoints=[],cX=cY=0,redraw=function(e,eX,eY){if(e){isLoop||e.preventDefault();var offset=$colorWheelEl.offset();eX=isNaN(Number(eX))?e.pageX:Number(eX),eY=isNaN(Number(eY))?e.pageY:Number(eY),dialX=eX-offset.left-dialTrackRadius||dialX,dialY=eY-offset.top-dialTrackRadius||dialY}var theta=Math.atan2(dialY,dialX);dialX=dialTrackRadius*Math.cos(theta),dialY=dialTrackRadius*Math.sin(theta);var d=dialX*dialX+dialY*dialY;$dialEl.css({left:dialX+dialTrackRadius-dialWidth2/2+"px",top:dialY+dialTrackRadius-dialWidth2/2+"px"});var rgb=hsvToRgb((theta+Math.PI)/(2*Math.PI),Math.sqrt(d)/radius,1),steppedRgb=closestColor(rgb);colorWheelValues[index]={raw:rgb[3],stepped:steppedRgb[3]},$dialEl[0].style.background=steppedRgb[3],updateBackground()},circlePoint=function(x,y,r){for(var points=[],degree=360;degree>=0;degree-=pointParting){var x2=r*Math.sin(degree*Math.PI/180),y2=r*Math.cos(degree*Math.PI/180);points.push({x:x+x2,y:y+y2})}return points},loopAnimation=function(e){isLoop&&(redraw(e,loopPoints[loopNumber].x,loopPoints[loopNumber].y),loopNumber++,loopNumber=loopNumber>=loopPoints.length?0:loopNumber,setTimeout(function(){loopAnimation(e)},timeoutSec))},startLoop=function(){isLoop||(isLoop=!0,draggingDial=!1,loopNumber=0==iKey?0:30,(0==cX||0==cY)&&(cX=$colorWheelEl.offset().left+50,cY=$colorWheelEl.offset().top+50),loopPoints=circlePoint(cX,cY,100),loopAnimation($dialEl))},stopLoop=function(){isLoop=!1};$colorWheelEl=$("<canvas>").attr({width:width,height:width}),$colorWheelEl[0].getContext("2d").drawImage(colorWheelCanvas,0,0,width,width),$el.append($colorWheelEl),$dialEl=$('<div class="dial"><div class="border"></div></div>'),$el.append($dialEl),dialWidth2=$dialEl.width()/2;var dialElMousedownFn=function(e){e.preventDefault(),draggingDial=!0,$($document).on("mousemove",redraw)};that.dialElMouseupFn=function(){draggingDial=!1,updateSns(),$($document).off("mousemove",redraw)},$dialEl.on("mousedown",dialElMousedownFn),$($document).on("mouseup",that.dialElMouseupFn),redraw();var $gradientToggleEl=$(document).find(".gradient-solid-toggle .gradient"),$solidToggleEl=$(document).find(".gradient-solid-toggle .solid"),$loopToggleEl=$(document).find(".gradient-solid-toggle .loop");$gradientToggleEl.click(function(){stopLoop()}),$solidToggleEl.click(function(){stopLoop()}),$loopToggleEl.click(function(){startLoop()}),$(window).resize(function(){cX=$colorWheelEl.offset().left+50,cY=$colorWheelEl.offset().top+50,loopPoints=circlePoint(cX,cY,100)})};createColorWheelCanvas(),$el.each(buildColorWheel)},updateBackground=function(){if("solid"===mode){var solidColor=colorWheelValues[0].raw;void 0!==solidColor&&($backgroundSolidEl[0].style.background=solidColor)}else{var leftColor=colorWheelValues[0].raw,rightColor=colorWheelValues[1].raw;if(void 0!==leftColor&&void 0!==rightColor){$backgroundGradientEl.css({background:"-moz-linear-gradient(left, "+leftColor+" 0%, "+rightColor+" 100%)"}),$backgroundGradientEl.css({background:"-webkit-gradient(linear, left top, right top, color-stop(0%, "+leftColor+")), color-stop(100%,"+rightColor+"))"}),$backgroundGradientEl.css({background:"-webkit-linear-gradient(left, "+leftColor+" 0%, "+rightColor+" 100%)"}),$backgroundGradientEl.css({background:"-o-linear-gradient(left, "+leftColor+" 0%, "+rightColor+" 100%)"}),$backgroundGradientEl.css({background:"-ms-linear-gradient(left, "+leftColor+" 0%, "+rightColor+" 100%)"}),$backgroundGradientEl.css({background:"-linear-gradient(to right, "+leftColor+" 0%, "+rightColor+" 100%)"});var leftColorHex=rgb2hex(leftColor),rightColorHex=rgb2hex(rightColor);$backgroundGradientEl.css({filter:"progid:DXImageTransform.Microsoft.gradient( startColorstr='"+leftColorHex+"', endColorstr='"+rightColorHex+"',GradientType=1 )"})}}},updateSns=function(){var endColorHex,startColorHex=rgb2hex(colorWheelValues[0].stepped).substr(1,6);endColorHex="gradient"===mode?rgb2hex(colorWheelValues[1].stepped).substr(1,6):startColorHex;var text="Light it up. Make it yours.",facebookUrl="http://www.gogoro.com/about/home/dashboard-social-facebook/"+startColorHex+endColorHex,twitterUrl="http://www.gogoro.com/about/home/dashboard-social-twitter/"+startColorHex+endColorHex;$facebookEl.attr({href:"http://www.facebook.com/sharer.php?u="+encodeURI(facebookUrl),target:"_blank"}),$twitterEl.attr({href:"http://twitter.com/share?text="+encodeURI(text)+"&url="+encodeURI(twitterUrl),target:"_blank"})},$el=$($element),$scooterEl=$el.children(".scooter"),$backgroundGradientEl=$scooterEl.find(".background .gradient"),$backgroundSolidEl=$scooterEl.find(".background .solid"),$gradientToggleEl=$el.find(".gradient-solid-toggle .gradient"),$solidToggleEl=$el.find(".gradient-solid-toggle .solid"),$loopToggleEl=$el.find(".gradient-solid-toggle .loop"),$wheelsEl=$el.find(".color-wheels .wheels"),$facebookEl=$el.find(".sns .facebook"),$twitterEl=$el.find(".sns .twitter"),colorWheelValues=[{},{}];buildColorWheels($wheelsEl.children(".wheel")),updateBackground();var mode="gradient";updateSns();var gradientToggleFn=function(){draggingDial||($gradientToggleEl.stop().fadeTo("fast",1),$solidToggleEl.stop().fadeTo("fast",.3),$loopToggleEl.stop().fadeTo("fast",.3),$wheelsEl.children(".wheel").show(),$backgroundGradientEl.show(),$backgroundSolidEl.hide(),mode="gradient",updateBackground())},solidToggleFn=function(){draggingDial||($gradientToggleEl.stop().fadeTo("fast",.3),$solidToggleEl.stop().fadeTo("fast",1),$loopToggleEl.stop().fadeTo("fast",.3),$wheelsEl.children(".wheel").eq(1).hide(),$backgroundGradientEl.hide(),$backgroundSolidEl.show(),mode="solid",updateBackground())},loopToggleFn=function(){draggingDial||($gradientToggleEl.stop().fadeTo("fast",.3),$solidToggleEl.stop().fadeTo("fast",.3),$loopToggleEl.stop().fadeTo("fast",1),$wheelsEl.children(".wheel").show())};$gradientToggleEl.on("click",gradientToggleFn),$solidToggleEl.on("click",solidToggleFn),$loopToggleEl.on("click",loopToggleFn)},destroy:function(){var $el=$($element),$gradientToggleEl=$el.find(".gradient-solid-toggle .gradient"),$solidToggleEl=$el.find(".gradient-solid-toggle .solid");$gradientToggleEl.off("click"),$solidToggleEl.off("click"),$($document).off("mouseup",this.dialElMouseupFn),$el.find(".wheel").children().remove()}},$scope.fallback={init:function(){},destroy:function(){}},$scope.init($scope,$element)}]),angular.module("gogoro.customize.moduleCustomize7LightingThemesView",[]).controller("moduleCustomize7LightingThemes",["$scope","$element","FallbackManagerFactory",function($scope,$element,FallbackManagerFactory){angular.extend($scope,FallbackManagerFactory),$scope.standard={init:function(){function onTimeUpdate(currentTime,duration){currentTime>lightingTheme.one&&currentTime<lightingTheme.two?($(".video-indicator a",$element).removeClass("active"),$('.video-indicator a[data-theme*="one"]',$element).addClass("active")):currentTime>lightingTheme.two&&currentTime<lightingTheme.three?($(".video-indicator a",$element).removeClass("active"),$('.video-indicator a[data-theme*="two"]',$element).addClass("active")):currentTime>lightingTheme.three&&duration>currentTime&&($(".video-indicator a",$element).removeClass("active"),$('.video-indicator a[data-theme*="three"]',$element).addClass("active"))}var $video,lightingTheme={one:0,two:4,three:8};setTimeout(function(){$(".video-lighting-themes").append('<video class="video-delay" width="2560" height="600" muted preload="auto" loop autoplay  ><source src="//movies.gogoroapp.com/lighting-themes.webm" type="video/webm"><source src="//movies.gogoroapp.com/lighting-themes_2015-01-21.mp4" type="video/mp4"></video>'),$video=$("video",$element)[0],$(".video",$element).css({}),$("video",$element).on("timeupdate",function(){onTimeUpdate(this.currentTime,this.duration)}),$(".video-indicator a",$element).unbind().on("click",function(e){e.preventDefault(),$(".video-overlay").velocity({opacity:.4},{display:"block",duration:50,easing:"easeOut",complete:function(){$(".video-overlay").velocity("fadeOut",{duration:300,easing:"easeOut"})}});var $this=$(this),theme=$this.attr("data-theme");$video.currentTime=lightingTheme[theme],$(".video-indicator a",$element).removeClass("active"),$this.addClass("active")})},500)},destroy:function(){}},$scope.fallback={init:function(){},destroy:function(){}},$scope.init($scope,$element,!0)}]),angular.module("gogoro.customize.moduleCustomize6SoundsThemesView",[]).controller("moduleCustomize6SoundsThemes",["$scope","$element","FallbackManagerFactory",function($scope,$element,FallbackManagerFactory){angular.extend($scope,FallbackManagerFactory),$scope.standard={init:function(){for(var currentTheme,currentAction,that=this,$el=$($element),$themesEl=$el.find(".theme-toggle a"),$triggersEl=$el.find(".preview .sounds .sound"),$canvasEl=($el.find("#gogoro-sound-processing"),$el.find("#gogoro-sound-processing-canvas")),themes=["clean","gamey","bella","slider","pongo"],actions=["kickstandDown","kickstandUp","remoteLock","remoteUnlock","turnSignal"],sounds={},i=0;i<themes.length;i++)sounds[themes[i]]={};var setSoundTitle=function(id){var $triggerEl=$triggersEl.filter(function(){return $(this).data("trigger")===id});$el.find(".preview .sound-title").html($triggerEl.attr("title")),$triggersEl.removeClass("active"),$triggerEl.addClass("active")},trigger=function(id){currentAction=actions.indexOf(id),setSoundTitle(id),sounds[currentTheme][id].play(),null!==that.pjs&&that.pjs.trigger(id)},advance=function(){++currentAction>=actions.length&&(currentAction=0),trigger(actions[currentAction])},loadCurrentThemeSounds=function(){for(var prefix="/sounds/"+currentTheme+"/",i=0;i<actions.length;i++){var action=actions[i];void 0===sounds[currentTheme][action]&&(sounds[currentTheme][action]=new Howl({src:[prefix+action+".mp3",prefix+action+".ogg",prefix+action+".wav"]}))}},setCurrentTheme=function(id){currentTheme=id,loadCurrentThemeSounds(),null!==that.pjs&&that.pjs.setupTheme(id)};$themesEl.on("click",function(){$themesEl.css({opacity:.3}),$(this).css({opacity:1}),setCurrentTheme($(this).data("theme"))}),$triggersEl.on("click",function(e){trigger($(this).data("trigger")),e.stopPropagation()}),$el.find(".preview").on("click",advance);var playfulSounds=function($p){function bindJavascript(js){javascript=js}function setup(){$p.size(480,370);var events=new $p.ArrayList;events.add(new Event(0,drawHeight/5*4.5)),events.add(new Event(100,drawHeight/5*3.5)),events.add(new Event(175,drawHeight/5*2.5)),events.add(new Event(250,drawHeight/5*1.5)),events.add(new Event(300,drawHeight/5*.5)),kickstandDownTimeline=new Timeline,kickstandDownTimeline.events=events,events=new $p.ArrayList,events.add(new Event(0,drawHeight/5*.5)),events.add(new Event(100,drawHeight/5*2.5)),events.add(new Event(150,drawHeight/5*3.5)),events.add(new Event(200,drawHeight/5*4.5)),kickstandUpTimeline=new Timeline,kickstandUpTimeline.events=events,events=new $p.ArrayList,events.add(new Event(0,drawHeight/5*1)),events.add(new Event(25,drawHeight/5*.75)),events.add(new Event(100,drawHeight/5*3.5)),events.add(new Event(200,drawHeight/5*2.5)),events.add(new Event(200,drawHeight/5*4.5)),remoteLockTimeline=new Timeline,remoteLockTimeline.events=events,events.add(new Event(0,drawHeight/5*4.5)),events.add(new Event(0,drawHeight/5*4.25)),events.add(new Event(75,drawHeight/5*2.5)),events.add(new Event(75,drawHeight/5*2.25)),events.add(new Event(150,drawHeight/5*.5)),remoteUnlockTimeline=new Timeline,remoteUnlockTimeline.events=events,events=new $p.ArrayList,events.add(new Event(0,drawHeight/5*2.5)),events.add(new Event(10,drawHeight/5*2.25)),events.add(new Event(10,drawHeight/5*2.75)),turnSignalTimeline=new Timeline,turnSignalTimeline.events=events,movers=new $p.ArrayList,atoms=new $p.ArrayList,$p.background(bgdColor),$p.frameRate(60)}function setupTheme(id){if(atoms.clear(),movers.clear(),"clean"==id){moversVisible=!1;var p=new Parameters;p.lineLength=6,placeAtoms(9,30,!1,orientationTypeNormal,1,p)}else if("gamey"==id){moversVisible=!1;var p=new Parameters;p.lineLength=13.5,p.shapeType=shapeTypeCheckered,p.effectType=effectTypeRotate,p.startColor=$p.color(4282843e3),p.endColor=$p.color(4283367376),p.push=2,placeAtoms(16.667,6,!0,orientationTypeNormal,1,p)}else if("bella"==id){moversVisible=!1;var p=new Parameters;p.rotationSpeed=.15,p.shapeType=shapeTypeTriangle,p.effectType=effectTypeScale,p.push=.66,p.offsetRotationByIndexMultiplier=1,p.startColor=$p.color(4281427413),p.endColor=$p.color(4283226365),placeAtoms(21.75,13.125,!0,orientationTypeMirroredRows,1,p)}}function placeAtoms(densityH,densityV,staggeredGrid,orientationType,rotationMultiplier,p){var index=0,dx=drawWidth/densityH,dy=drawHeight/densityV,startX=dx/2,evenStartY=dy/2,oddStartY=evenStartY;staggeredGrid&&(evenStartY+=dy/4,oddStartY-=dy/4);for(var odd=!1,oddRow=!1,x=startX;drawWidth>x;x+=dx){var currentStartY=odd?oddStartY:evenStartY;odd=!odd;for(var y=currentStartY;drawHeight>y;y+=dy){var rm=rotationMultiplier;orientationType==orientationTypeMirroredRows&&oddRow&&(rm=-rm);var a=new Atom(index++,x,y,rm,p);atoms.add(a),oddRow=!oddRow}}}function draw(){$p.background(bgdColor),null!=currentTimeline&&currentTimeline.play(),$p.pushMatrix(),$p.translate(padding,padding);for(var farLocation=new $p.PVector(-99999,-99999),i=0;i<atoms.size();){var a=atoms.get(i),m=findClosestMover(a);a.draw(null==m?farLocation:m.location),a.draw(null==m?farLocation:m.location),a.draw(null==m?farLocation:m.location),i++}for(i=0;i<movers.size();){var m=movers.get(i);m.update(),m.dead?movers.remove(i):i++}$p.popMatrix()}function findClosestMover(a){for(var closestD=-1,closestM=null,i=0;i<movers.size();){var m=movers.get(i),distance=m.location.dist(a.currentLocation);(-1==closestD||closestD>distance)&&(closestD=distance,closestM=m),i++}return closestM}function trigger(id){"kickstandDown"==id?(currentTimeline=kickstandDownTimeline,currentTimeline.reset()):"kickstandUp"==id?(currentTimeline=kickstandUpTimeline,currentTimeline.reset()):"remoteLock"==id?(currentTimeline=remoteLockTimeline,currentTimeline.reset()):"remoteUnlock"==id?(currentTimeline=remoteUnlockTimeline,currentTimeline.reset()):"turnSignal"==id&&(currentTimeline=turnSignalTimeline,currentTimeline.reset())}var JavaScript=function(){function JavaScript(){throw"Unable to create the interface"}return JavaScript.$isInterface=!0,JavaScript.$methods=["playSound"],JavaScript}();$p.JavaScript=JavaScript;var Timeline=function(){function Timeline(){function $superCstr(){$p.extendClassChain($this_1)}function reset$0(){$this_1.startMillis=$p.millis(),$this_1.lastEventIndex=0}function play$0(){var currentTime=$p.millis()-$this_1.startMillis;if(null!=$this_1.events)for(var i=$this_1.lastEventIndex;i<$this_1.events.size();){var e=$this_1.events.get(i);if(currentTime>=e.time){$this_1.lastEventIndex=i+1;for(var j=0;moverCount>j;j++){var m=new Mover(e.position);movers.add(m)}}i++}}function $constr_0(){$superCstr(),$this_1.$self.reset()}function $constr(){0===arguments.length?$constr_0.apply($this_1,arguments):$superCstr()}var $this_1=this;$this_1.startMillis=0,$this_1.events=null,$this_1.lastEventIndex=0,$p.addMethod($this_1,"reset",reset$0,!1),$p.addMethod($this_1,"play",play$0,!1),$constr.apply(null,arguments)}return Timeline}();$p.Timeline=Timeline;var Event=function(){function Event(){function $superCstr(){$p.extendClassChain($this_1)}function $constr_2(t,p){$superCstr(),$this_1.time=t,$this_1.position=p}function $constr(){2===arguments.length?$constr_2.apply($this_1,arguments):$superCstr()}var $this_1=this;$this_1.time=0,$this_1.position=0,$constr.apply(null,arguments)}return Event}();$p.Event=Event;var Parameters=function(){function Parameters(){function $superCstr(){$p.extendClassChain($this_1)}function $constr_0(){$superCstr(),$this_1.rotationSpeed=0,$this_1.shapeType=shapeTypeLine,$this_1.lineLength=12,$this_1.effectType=effectTypeSpread,$this_1.influence=100,$this_1.push=$this_1.influence,$this_1.affectX=!0,$this_1.affectY=!1,$this_1.offsetRotationByIndexMultiplier=0,$this_1.startColor=$p.color(4289716002),$this_1.endColor=$p.color(4281119547)}function $constr(){0===arguments.length?$constr_0.apply($this_1,arguments):$superCstr()}var $this_1=this;$this_1.rotationSpeed=0,$this_1.shapeType=0,$this_1.lineLength=0,$this_1.effectType=0,$this_1.influence=0,$this_1.push=0,$this_1.affectX=!1,$this_1.affectY=!1,$this_1.offsetRotationByIndexMultiplier=0,$this_1.startColor=0,$this_1.endColor=0,$constr.apply(null,arguments)}return Parameters}();$p.Parameters=Parameters;var Atom=function(){function Atom(){function $superCstr(){$p.extendClassChain($this_1)}function setup$5(i,x,y,rm,p){$this_1.index=i,$this_1.baseLocation=new $p.PVector(x,y),$this_1.currentLocation=new $p.PVector(x,y),$this_1.parameters=p,$this_1.rotation=$this_1.index*$this_1.parameters.offsetRotationByIndexMultiplier,$this_1.rotationMultiplier=rm,$this_1.parameters.shapeType==shapeTypeTriangle&&($this_1.triA=new $p.PVector,$this_1.triB=new $p.PVector,$this_1.triC=new $p.PVector($this_1.parameters.lineLength,$this_1.parameters.lineLength),$this_1.triB.x=$this_1.triC.x*$p.cos(Atom.radians120)-$this_1.triC.y*$p.sin(Atom.radians120),$this_1.triB.y=$this_1.triC.x*$p.sin(Atom.radians120)+$this_1.triC.y*$p.cos(Atom.radians120),$this_1.triA.x=$this_1.triC.x*$p.cos(Atom.radians240)-$this_1.triC.y*$p.sin(Atom.radians240),$this_1.triA.y=$this_1.triC.x*$p.sin(Atom.radians240)+$this_1.triC.y*$p.cos(Atom.radians240));var t=x/drawWidth;$this_1.c=$p.lerpColor($this_1.parameters.startColor,$this_1.parameters.endColor,t)}function draw$1(focusLocation){$p.pushMatrix(),$p.translate($this_1.currentLocation.x,$this_1.currentLocation.y);var v=new $p.PVector($this_1.currentLocation.x-focusLocation.x,$this_1.currentLocation.y-focusLocation.y);v.normalize();var d=($this_1.parameters.influence-Math.min($this_1.parameters.influence,$p.PVector.dist(focusLocation,$this_1.currentLocation)))/$this_1.parameters.influence;for($this_1.parameters.effectType==effectTypeSpread?($this_1.currentLocation.x=$this_1.parameters.affectX?($this_1.currentLocation.x+v.x*d*$this_1.parameters.push+3*$this_1.baseLocation.x)/4:$this_1.baseLocation.x,$this_1.currentLocation.y=$this_1.parameters.affectY?($this_1.currentLocation.y+v.y*d*$this_1.parameters.push+3*$this_1.baseLocation.y)/4:$this_1.baseLocation.y):$this_1.parameters.effectType==effectTypeRotate?$this_1.rotation+=d*$this_1.parameters.push:$this_1.parameters.effectType==effectTypeScale&&$p.scale(d*$this_1.parameters.push+.5),$this_1.parameters.shapeType!=shapeTypePoint&&$this_1.parameters.shapeType!=shapeTypeDekoBoko&&$p.rotate($p.radians($this_1.rotation)),$this_1.rotation+=$this_1.parameters.rotationSpeed*$this_1.rotationMultiplier;$this_1.rotation>360;)$this_1.rotation-=360;for(;$this_1.rotation<360;)$this_1.rotation+=360;switch($this_1.parameters.shapeType){case shapeTypeCheckered:$p.fill($this_1.c),$p.noStroke(),$p.rect(0,0,$this_1.parameters.lineLength,$this_1.parameters.lineLength),$p.rect(0,0,-$this_1.parameters.lineLength,-$this_1.parameters.lineLength);break;case shapeTypePoint:$p.stroke($this_1.c),$p.noFill(),$p.point(0,0);break;case shapeTypeLine:$p.fill($this_1.c),$p.noStroke(),$p.rect(-2,-$this_1.parameters.lineLength,4,2*$this_1.parameters.lineLength);break;case shapeTypeRectCorners:$p.fill($this_1.c),$p.noStroke(),$p.ellipse(-$this_1.parameters.lineLength,-$this_1.parameters.lineLength,2,2),$p.ellipse(-$this_1.parameters.lineLength,$this_1.parameters.lineLength,2,2),$p.ellipse($this_1.parameters.lineLength,$this_1.parameters.lineLength,2,2),$p.ellipse($this_1.parameters.lineLength,-$this_1.parameters.lineLength,2,2);break;case shapeTypeTriangle:$p.fill($this_1.c),$p.noStroke(),$p.triangle($this_1.triA.x,$this_1.triA.y,$this_1.triB.x,$this_1.triB.y,$this_1.triC.x,$this_1.triC.y);break;case shapeTypeDekoBoko:$p.stroke($this_1.c),$p.noFill();var h=$p.sin(2*$p.radians($this_1.rotation)+$this_1.index*$this_1.parameters.offsetRotationByIndexMultiplier)*$this_1.parameters.lineLength,s=($p.cos($p.radians($this_1.rotation)+$this_1.index*$this_1.parameters.offsetRotationByIndexMultiplier)+2)/2;$p.scale(s,s),$p.line(-$this_1.parameters.lineLength/2,0,-$this_1.parameters.lineLength,0),$p.line($this_1.parameters.lineLength/2,0,$this_1.parameters.lineLength,0),$p.line(-$this_1.parameters.lineLength/2,0,-$this_1.parameters.lineLength/2,h),$p.line($this_1.parameters.lineLength/2,0,$this_1.parameters.lineLength/2,h),$p.line(-$this_1.parameters.lineLength/2,h,$this_1.parameters.lineLength/2,h)}$p.popMatrix()}function $constr_5(i,x,y,rm,p){$superCstr(),$this_1.$self.setup(i,x,y,rm,p)}function $constr(){5===arguments.length?$constr_5.apply($this_1,arguments):$superCstr()}var $this_1=this;$p.defineProperty($this_1,"radians120",{get:function(){return Atom.radians120},set:function(val){Atom.radians120=val}}),$p.defineProperty($this_1,"radians240",{get:function(){return Atom.radians240},set:function(val){Atom.radians240=val}}),$this_1.index=0,$this_1.baseLocation=null,$this_1.currentLocation=null,$this_1.rotation=0,$this_1.rotationMultiplier=0,$this_1.parameters=null,$this_1.triA=null,$this_1.triB=null,$this_1.triC=null,$this_1.c=0,$p.addMethod($this_1,"setup",setup$5,!1),$p.addMethod($this_1,"draw",draw$1,!1),$constr.apply(null,arguments)}return Atom.radians120=$p.radians(120),Atom.radians240=$p.radians(240),Atom}();$p.Atom=Atom;var Mover=function(){function Mover(){function $superCstr(){$p.extendClassChain($this_1)}function setup$1(y){$this_1.location=new $p.PVector(0,y),$this_1.target=new $p.PVector(drawWidth,y);var angle=0-$p.random($p.PI/8)+$p.random($p.PI/8);$this_1.direction=new $p.PVector($p.cos(angle),$p.sin(angle)),$this_1.speed=$p.random(12,22),$this_1.forceStrength=$p.random(.1,.2),$this_1.dead=!1}function update$1(){$this_1.$self.seek($this_1.target.x,$this_1.target.y),$this_1.$self.move(),$this_1.$self.draw()}function seek$2(x,y){$this_1.$self.seek(x,y,1)}function seek$3_2(x,y,strength){var angle=$p.atan2(y-$this_1.location.y,x-$this_1.location.x),force=new $p.PVector($p.cos(angle),$p.sin(angle));force.mult($this_1.forceStrength*strength),$this_1.direction.add(force),$this_1.direction.normalize()}function move$0(){var velocity=$this_1.direction.get();velocity.mult($this_1.speed),$this_1.location.x<$this_1.target.x&&$this_1.location.x+velocity.x>=$this_1.target.x?$this_1.dead=!0:$this_1.location.x>$this_1.target.x&&$this_1.location.x+velocity.x<=$this_1.target.x&&($this_1.dead=!0),$this_1.location.add(velocity)}function draw$0(){moversVisible&&($p.noStroke(),$p.fill(4294046707,255),$p.ellipse($this_1.location.x,$this_1.location.y,4,4))}function $constr_1(x){$superCstr(),$this_1.$self.setup(x)}function $constr(){1===arguments.length?$constr_1.apply($this_1,arguments):$superCstr()}var $this_1=this;$this_1.location=null,$this_1.target=null,$this_1.direction=null,$this_1.speed=0,$this_1.forceStrength=0,$this_1.dead=!1,$p.addMethod($this_1,"setup",setup$1,!1),$p.addMethod($this_1,"update",update$1,!1),$p.addMethod($this_1,"seek",seek$2,!1),$p.addMethod($this_1,"seek",seek$3_2,!1),$p.addMethod($this_1,"move",move$0,!1),$p.addMethod($this_1,"draw",draw$0,!1),$constr.apply(null,arguments)
}return Mover}();$p.Mover=Mover,$p.bindJavascript=bindJavascript,bindJavascript=bindJavascript.bind($p);var javascript=null,bgdColor=$p.color(4281479735),screenWidth=480,screenHeight=370,padding=20,drawWidth=screenWidth-2*padding,drawHeight=screenHeight-2*padding,atoms=null,movers=null,moverCount=3,moversVisible=!0,currentTimeline=null,kickstandDownTimeline=null,kickstandUpTimeline=null,remoteLockTimeline=null,remoteUnlockTimeline=null,turnSignalTimeline=null,shapeTypeCheckered=1,shapeTypePoint=2,shapeTypeLine=3,shapeTypeRectCorners=4,shapeTypeTriangle=5,shapeTypeDekoBoko=6,effectTypeSpread=1,effectTypeRotate=2,effectTypeScale=3,orientationTypeNormal=1,orientationTypeMirroredRows=2;$p.setup=setup,setup=setup.bind($p),$p.setupTheme=setupTheme,setupTheme=setupTheme.bind($p),$p.placeAtoms=placeAtoms,placeAtoms=placeAtoms.bind($p),$p.draw=draw,draw=draw.bind($p),$p.findClosestMover=findClosestMover,findClosestMover=findClosestMover.bind($p),$p.trigger=trigger,trigger=trigger.bind($p)};that.pjs=new Processing($canvasEl[0],playfulSounds),null!==that.pjs&&(that.pjs.bindJavascript(this),setCurrentTheme(themes[0]),currentAction=-1)},destroy:function(){this.pjs=null,delete this.pjs;var $el=$($element),$themesEl=$el.find(".theme-toggle a"),$triggersEl=$el.find(".preview .sounds .sound");$themesEl.off("click"),$triggersEl.off("click"),$el.find(".preview").off("click")}},$scope.fallback={init:function(){},destroy:function(){}},$scope.init($scope,$element,!0)}]),angular.module("gogoro.customize.moduleCustomize9DesignEthosView",[]).controller("moduleCustomize9DesignEthosController",["$scope","$element","$window","$controller","FallbackManagerFactory",function($scope,$element,$window,$controller,FallbackManagerFactory){angular.extend($scope,FallbackManagerFactory);var $el=$($element);$scope.standard={init:function(){setTimeout(function(){$(".video-design-ethos").append('<video id="design-ethos-video" class="video-delay" width="2560" height="600" muted preload="auto" autoplay loop  poster="//gogoro.imgix.net/bdg-module-customize-9.jpg"><source src="//movies.gogoroapp.com/module-customize-9-design-ethos.webm" type="video/webm"><source src="//movies.gogoroapp.com/module-customize-9-design-ethos_2015-01-19.mp4" type="video/mp4"></video>');var $video=$el.find("#design-ethos-video");$video.get(0).play(),$video.bind("ended",function(){setTimeout(function(){$video.get(0).play()},2e3)})},1e3)},destroy:function(){}},$scope.fallback={init:function(){function animate_imgs(){setTimeout(function(){$images_elm.prop("src",images[counter]),counter++,12==counter&&(counter=0),animate_imgs()},1e3)}var img_url="http://images.gogoroapp.com/faceplate/600/",images=[img_url+"module-customize-9-design-ethos_.jpg",img_url+"module-customize-9-design-ethos_00.jpg",img_url+"module-customize-9-design-ethos_01.jpg",img_url+"module-customize-9-design-ethos_02.jpg",img_url+"module-customize-9-design-ethos_03.jpg",img_url+"module-customize-9-design-ethos_04.jpg",img_url+"module-customize-9-design-ethos_05.jpg",img_url+"module-customize-9-design-ethos_06.jpg",img_url+"module-customize-9-design-ethos_07.jpg",img_url+"module-customize-9-design-ethos_08.jpg",img_url+"module-customize-9-design-ethos_09.jpg",img_url+"module-customize-9-design-ethos_10.jpg",img_url+"module-customize-9-design-ethos_11.jpg",img_url+"module-customize-9-design-ethos_12.jpg"];$.preloadimages(images);var $images_elm=$el.find(".design-ethos-images"),counter=0;animate_imgs()},destroy:function(){}},$scope.init($scope,$element)}]),angular.module("gogoro.easierView",[]).controller("EasierController",["$scope","$window","GATrackingService",function($scope,$window,GATrackingService){function loadingVideo(){"standard"!==gogoro.App.getState()||_loaded||($("video").each(function(i){$(this).append('<source src="'+videoSetting[i].sources[0].url+'" type="'+videoSetting[i].sources[0].type+'"></source>'),$(this).append('<source src="'+videoSetting[i].sources[1].url+'" type="'+videoSetting[i].sources[1].type+'"></source>')}),_loaded=!0)}$window.scrollTo(0,0);var gaConfig={id:"easier"};GATrackingService.init(gaConfig),ga("send","pageview","/#/easier"),$("body").hasClass("navigation-active")&&$(".navbar-toggle").click();new gogoro.common.ResponsiveImages;Modernizr.svg||$('img[src*="svg"]').each(function(){var $this=$(this);$this.attr("src",function(){return $this.attr("src").replace(".svg",".png")})}),videoSetting=[{sources:[{url:"//movies.gogoroapp.com/easier-2.webm",type:"video/webm"},{url:"//movies.gogoroapp.com/easier-2_2015-01-19.mp4",type:"video/mp4"}]},{sources:[{url:"//movies.gogoroapp.com/easier-5.webm",type:"video/webm"},{url:"//movies.gogoroapp.com/easier-5_2015-01-19.mp4",type:"video/mp4"}]}];var _loaded=!1;loadingVideo(),$(window).on("resize",function(){loadingVideo()})}]),angular.module("gogoro.easier.moduleEasier1PageIntroView",[]).controller("moduleEasier1PageIntroController",["$scope","$element","FallbackManagerFactory","ModulePageIntroService",function($scope,$element,FallbackManagerFactory,ModulePageIntroService){angular.extend($scope,FallbackManagerFactory);var $el=$($element);$scope.isIE10OrLess()||$el.find(".title-wrapper").append($el.find("script.svg").html()),$scope.standard={init:function(){imgix.onready(function(){imgix.fluid({fluidClass:"background-image-standard"})});var createElementRevealDownTween=function($element,startPercent,endPercent,duration,delay){var w=2560,h=800,tween=TweenMax.fromTo($element,duration,{clip:"rect(0, "+w+"px, "+h*startPercent+"px, 0)",opacity:1},{clip:"rect(0, "+w+"px, "+h*endPercent+"px, 0)",opacity:1,delay:delay,repeat:0,immediateRender:!1,ease:Linear.easeOut});return tween},createElementBounceTween=function($element,duration,delay){var tween=TweenMax.to($element,duration,{top:"+=50px",delay:delay,repeat:0,immediateRender:!1,ease:Elastic.easeOut});return tween},gridTween=ModulePageIntroService.createElementFadeInTween($($element).find(".route"),.5,.5),routeTween=createElementRevealDownTween($($element).find(".grid"),.61,.81,2),pinsTimeline=new TimelineMax,fadePinsTween=ModulePageIntroService.createElementFadeInTween($($element).find(".pins"),.5,.25),bouncePinsTween=createElementBounceTween($($element).find(".pins"),.75,.25);pinsTimeline.insert(fadePinsTween),pinsTimeline.insert(bouncePinsTween);var findString=$scope.isFF()?".title-wrapper text":".title-wrapper tspan",titleTween=ModulePageIntroService.createTitleFadeInTween($($element).find(findString)),bodyTween=ModulePageIntroService.createBodyFadeInTween($element,null,.5);this.timeline=new TimelineMax({delay:.25}),this.timeline.insert(bodyTween).add(gridTween).add(routeTween).add(pinsTimeline).add(titleTween).play()},destroy:function(){this.timeline&&(this.timeline.pause(0,!0).remove(),this.timeline=null),$(".body",$element).attr("style","")}},$scope.fallback={init:function(){imgix.onready(function(){imgix.fluid({fluidClass:"background-image-fallback"})})},destroy:function(){}},$scope.init($scope,$element,!0)}]),angular.module("gogoro.easier.moduleEasier2CleanVideoView",[]).controller("moduleEasier2CleanVideoController",["$scope","$element","$window","$controller","FallbackManagerFactory",function($scope,$element,$window,$controller,FallbackManagerFactory){angular.extend($scope,FallbackManagerFactory),$scope.standard={init:function(){$(".video",$element).css({display:"block"}),$.extend(this,$controller("ModuleVideoController",{$scope:$scope,$element:$element,$window:$window}));new gogoro.common.VideoModal},destroy:function(){$(".video",$element).css({display:"none"})}},$scope.fallback={init:function(){},destroy:function(){}},$scope.init($scope,$element)}]),angular.module("gogoro.easier.moduleEasier3SummaryInfoView",[]).controller("moduleEasier3SummaryInfoController",["$scope","$element","$controller","FallbackManagerFactory",function($scope,$element,$controller,FallbackManagerFactory){angular.extend($scope,FallbackManagerFactory),$scope.standard={init:function(){$.extend(this,$controller("ModuleSummaryInfoController",{$scope:$scope,$element:$element}))},destroy:function(){this.controller&&(this.controller.destroy(!0),this.contoller=null)}},$scope.fallback={init:function(){"lg"!==gogoro.App.getBreakpoint()&&($(".row",$element).slick({slide:".slide",dots:!0,arrows:!1,accessibility:!0,infinite:!0,speed:650,cssEase:"ease",slidesToShow:1,draggable:!1}),$(".row .slide",$element).on("click",function(){$(".row",$element).slickNext()}))},destroy:function(){$(".row",$element).unslick()}},$scope.init($scope,$element)}]),angular.module("gogoro.easier.moduleEasier4AllYouCanRideView",[]).controller("moduleEasier4AllYouCanRideController",["$scope","$element","$window","FallbackManagerFactory","$interval",function($scope,$element,$window,FallbackManagerFactory,$interval){function toggleBattery(){$goStationBgdEl.removeClass("active"),$goStationToggleEl.addClass("inactive"),$batteryToggleEl.removeClass("inactive"),$batteryBgdEl.addClass("active"),$goStationDescriptionEl.velocity("stop").velocity("fadeOut",{duration:150,complete:function(){$batteryDescriptionEl.velocity("stop").velocity("fadeIn",{duration:250})}}),$goStationBgdEl.velocity("stop").velocity("fadeOut",{duration:50}),$batteryBgdEl.velocity("stop").velocity("fadeIn",{duration:450}),$partnershipEl.css("opacity","1"),$scope.num=1}function toggleStation(){$batteryBgdEl.removeClass("active"),$batteryToggleEl.addClass("inactive"),$goStationToggleEl.removeClass("inactive"),$goStationBgdEl.addClass("active"),$batteryDescriptionEl.velocity("stop").velocity("fadeOut",{duration:150,complete:function(){$goStationDescriptionEl.velocity("stop").velocity("fadeIn",{duration:250})}}),$batteryBgdEl.velocity("stop").velocity("fadeOut",{duration:50}),$goStationBgdEl.velocity("stop").velocity("fadeIn",{duration:450}),$partnershipEl.css("opacity","0"),$scope.num=0}function setDescriptionHeight(){$(".descriptions",$element).css({height:$(".descriptions .description",$element).outerHeight()})}function setInfinityPlay(){}angular.extend($scope,FallbackManagerFactory),setDescriptionHeight();$(window).on("resize",function(){setDescriptionHeight()});var $el=$($element),$toggleEl=$el.find(".battery-go-station-toggle"),$batteryToggleEl=$toggleEl.children(".battery"),$goStationToggleEl=$toggleEl.children(".go-station"),$batteryBgdEl=$el.find(".background-battery"),$goStationBgdEl=$el.find(".background-go-station"),$batteryDescriptionEl=$(".description.battery"),$goStationDescriptionEl=$(".description.go-station"),$partnershipEl=$(".partnership");$(".battery-go-station-toggle a",$element).on("click",function(e){return e.preventDefault(),$interval.cancel($scope.intervalNum),setInfinityPlay(),$(this).hasClass("inactive")?void($batteryBgdEl.hasClass("active")?toggleStation():toggleBattery()):!1}),$scope.num=1,$scope.intervalNum=null,$scope.standard={init:function(){},destroy:function(){}},$scope.fallback={init:function(){},destroy:function(){}},$scope.init($scope,$element,!0)}]),angular.module("gogoro.easier.moduleEasier5SwapAndGoView",[]).controller("moduleEasier5SwapAndGoController",["$scope","$element","$window","$controller","FallbackManagerFactory",function($scope,$element,$window,$controller,FallbackManagerFactory){angular.extend($scope,FallbackManagerFactory),$scope.standard={init:function(){$(".video",$element).css({display:"block"}),$.extend(this,$controller("ModuleVideoController",{$scope:$scope,$element:$element,$window:$window}));var playVideo=(new gogoro.common.VideoModal,function(){"undefined"!=typeof $("#module-easier-5-swap-and-go_video").get(0)&&$("#module-easier-5-swap-and-go_video").get(0).play()});this.controller=new ScrollMagic;new ScrollScene({triggerElement:$element,duration:400}).on("enter leave",function(){playVideo()}).addTo(this.controller)},destroy:function(){$(".video",$element).css({display:"none"})}},$scope.fallback={init:function(){},destroy:function(){}},$scope.init($scope,$element)}]),angular.module("gogoro.easier.moduleEasier6MapView",[]).controller("moduleEasier6MapController",["$scope","$element",function(){}]),angular.module("gogoro.easier.moduleEasier7ServiceHeroView",[]).controller("moduleEasier7ServiceHeroController",["$scope","$element","$controller","FallbackManagerFactory",function($scope,$element,$controller,FallbackManagerFactory){angular.extend($scope,FallbackManagerFactory),$scope.standard={init:function(){var duration=.3,tween=TweenMax.staggerFromTo($($element).find("h3"),duration,{opacity:0,"margin-left":"-10%"},{opacity:1,"margin-left":0,repeat:0,immediateRender:!0,ease:Linear.easeNone},duration);this.controller=new ScrollMagic;new ScrollScene({triggerElement:$element,duration:400}).setTween(tween).addTo(this.controller)},destroy:function(){}},$scope.fallback={init:function(){},destroy:function(){}},$scope.init($scope,$element)}]),angular.module("gogoro.easier.moduleEasier8QuickFixView",[]).controller("moduleEasier8QuickFixController",["$scope","$element",function(){}]),angular.module("gogoro.easier.moduleEasier9CenterLockView",[]).controller("moduleEasier9CenterLockController",["$scope","$element",function($scope,$element){var $el=$($element),animationDuration=800;$el.on("mouseenter",function(){"xs"!==gogoro.App.getBreakpoint()&&"sm"!==gogoro.App.getBreakpoint()&&$("img.active",$el).velocity("stop").velocity("fadeIn",{duration:animationDuration,easing:"easeIn"})}),$el.on("mouseleave",function(){"xs"!==gogoro.App.getBreakpoint()&&"sm"!==gogoro.App.getBreakpoint()&&$("img.active",$el).velocity("stop").velocity("fadeOut",{duration:animationDuration,easing:"easeIn"})})}]),angular.module("gogoro.easier.moduleEasier9WarrantyView",[]).controller("moduleEasier9WarrantyController",["$scope","$element",function($scope,$element){{var duration=.3,tween=TweenMax.staggerFromTo($($element).find(".years-number .year"),duration,{opacity:0,"margin-left":"-10%"},{opacity:1,"margin-left":0,repeat:0,immediateRender:!0,ease:Linear.easeNone},duration),controller=new ScrollMagic;new ScrollScene({triggerElement:$element,duration:0}).setTween(tween).addTo(controller)}}]),angular.module("gogoro.fasterView",[]).controller("FasterController",["$scope","$window","$rootScope","GATrackingService",function($scope,$window,$rootScope,GATrackingService){function loadingVideo(){"standard"!==gogoro.App.getState()||_loaded||($("video").each(function(i){$(this).append('<source src="'+videoSetting[i].sources[0].url+'" type="'+videoSetting[i].sources[0].type+'"></source>'),$(this).append('<source src="'+videoSetting[i].sources[1].url+'" type="'+videoSetting[i].sources[1].type+'"></source>')}),_loaded=!0)}$(window).scrollTo(0,0);var gaConfig={id:"faster"};GATrackingService.init(gaConfig),ga("send","pageview","/#/faster"),$("body").hasClass("navigation-active")&&$(".navbar-toggle").click();new gogoro.common.ResponsiveImages;Modernizr.svg||$('img[src*="svg"]').each(function(){var $this=$(this);$this.attr("src",function(){return $this.attr("src").replace(".svg",".png")})}),videoSetting=[{sources:[{url:"//movies.gogoroapp.com/module-faster-5-powertrain.webm",type:"video/webm"},{url:"//movies.gogoroapp.com/module-faster-5-powertrain-20150117.mp4",type:"video/mp4"}]},{sources:[{url:"//movies.gogoroapp.com/module-faster-9-chassis.webm",type:"video/webm"},{url:"//movies.gogoroapp.com/module-faster-9-chassis_2015-01-19.mp4",type:"video/mp4"}]},{sources:[{url:"//movies.gogoroapp.com/faster-10-scooter-xray.webm",type:"video/webm"},{url:"//movies.gogoroapp.com/faster-10-scooter-xray.mp4",type:"video/mp4"}]},{sources:[{url:"//movies.gogoroapp.com/module-faster-15-waterproof.webm",type:"video/webm"},{url:"//movies.gogoroapp.com/module-faster-15-waterproof_2015-01-19.mp4",type:"video/mp4"}]}];var _loaded=!1;loadingVideo(),$(window).on("resize",function(){loadingVideo()})}]),angular.module("gogoro.faster.moduleFaster0SiteIntroView",[]).controller("moduleFaster0SiteIntroController",["$scope","$element","FallbackManagerFactory","$rootScope",function($scope,$element,FallbackManagerFactory){angular.extend($scope,FallbackManagerFactory),$scope.playHeroVideo=function(){gogoro.App.ytplayer.playVideo(),$(".nav-bar-stop").show(),$(".navbar").hide(),$(".video_hero .container").addClass("transparent")},$scope.goVideo=function(){gogoro.App.enableMove&&gogoro.App.LoadMovieClip()},$scope.skipVideo=function(){gogoro.App.removeTakeover()},$scope.standard={init:function(){function videoProgress(){if(video.buffered.length>0){var percent=Math.ceil(100*video.buffered.end(0)/video.duration);if($loadingNum.text(percent+"%"),100==parseInt(video.buffered.end(0)/video.duration*100)){video.pause(),video.currentTime=0,$(video).removeAttr("autoplay"),$(video).off("progress",videoProgress),gogoro.App.enableMove=!0;var tl=new TimelineMax;tl.to($loadingCycle,.2,{opacity:0}).to($loadingNum,.2,{opacity:0}).to($introArrow,.2,{opacity:1}).to($introArrowTxt,.2,{opacity:1,onComplete:function(){$loadingCycle.hide(),$loadingNum.hide()}}),TweenMax.ticker.removeEventListener("tick",loadingCycleAnimate)}}}function loadingCycleAnimate(){bgPosition=currentFrame*cycleWidth,elmLoadingCycle.style.backgroundPosition="0 -"+bgPosition+"px",currentFrame>=totalFrames?currentFrame=0:currentFrame++}function adjustIntroOpenWrapPosition(){if(vHeight=$elm.height(),vHeight>800){var reminder=(vHeight-790)/10;$introOpenWrap.stop().velocity({bottom:-reminder+"px"},0)}else vHeight>670?$introOpenWrap.stop().velocity({bottom:"20px"},500):$introOpenWrap.stop().velocity({bottom:"40px"},500)}var $elm=$($element),$introOpenWrap=$(".intro-open-wrap"),$introArrow=$("#intro-open"),$introArrowTxt=$(".icon-arrow-txt"),$loadingCycle=$("#loading-cycle"),vHeight=($(".vertical-center-flex"),$elm.height()),$loadingNum=$elm.find(".sprite-loading-num");gogoro.App.LoadTakeover(),$(".navbar-header").removeClass("white");var video=$("#powertrainVideo").get(0);gogoro.App.enableMove=!0,gogoro.App.enableMove&&($loadingCycle.css("display","none").css("opacity",0),$loadingNum.css("display","none").css("opacity",0),$introArrow.css("opacity",1),$introArrowTxt.css("display","none").css("opacity",0)),gogoro.App.enableMove||$(video).on("progress",videoProgress),$introArrow.on("click",function(){gogoro.App.removeTakeover()});var fps=30,currentFrame=0,cycleWidth=30,totalFrames=40,elmLoadingCycle=document.getElementById("loading-cycle"),bgPosition=0;TweenMax.ticker.fps(fps),TweenMax.ticker.addEventListener("tick",loadingCycleAnimate),adjustIntroOpenWrapPosition(),$(window).resize(function(){adjustIntroOpenWrapPosition()})},destroy:function(){$(".module-faster-0-site-intro").unbind("mousewheel DOMMouseScroll MozMousePixelScroll"),$(".module-faster-0-site-intro").css({display:"none"})}},$scope.fallback={init:function(){var $introArrow=($($element),$(".intro-open-wrap"),$("#intro-open")),$loadingCycle=($(".icon-arrow-txt"),$("#loading-cycle")),$loadingNum=$(".sprite-loading-num");isMobile.any||gogoro.App.LoadTakeover(),gogoro.App.enableMove=!0,$loadingCycle.hide(),$loadingNum.hide(),$introArrow.css("opacity",1),$loadingNum.css("opacity",1),$introArrow.on("click",function(){gogoro.App.removeTakeover()})},destroy:function(){}},$scope.init($scope,$element,!0)}]),angular.module("gogoro.faster.moduleFaster1PageIntroView",[]).controller("moduleFaster1PageIntroController",["$scope","$element","$interval","FallbackManagerFactory","ModulePageIntroService","$rootScope",function($scope,$element,$interval,FallbackManagerFactory,ModulePageIntroService,$rootScope){angular.extend($scope,FallbackManagerFactory);var $el=$($element);$scope.isIE10OrLess()||$el.find(".title-wrapper").append($el.find("script.svg").html()),$scope.standard={init:function(){$rootScope.finishPlay=!1,$(".navbar-header").removeClass("white");var counter,didFinish=!1,speedMultiplier=2,duration=4200/speedMultiplier;imgix.fluid({fluidClass:"background-image-standard"});var resetTimerIfNotRunning=function(){if(!didFinish&&!counter){var startTime=new Date(Date.now()),endTime=new Date(Date.now()+duration),$kmh0El=$($element).find("svg.kmh text tspan").eq(2),$kmh1El=$($element).find("svg.kmh text tspan").eq(3);counter=$interval(function(){var currTime=new Date,diff=(duration-Math.max(0,endTime-currTime))*speedMultiplier,seconds=Math.floor(diff/1e3),secondsString=seconds.toString();1===secondsString.length&&(secondsString="0"+secondsString);var millis=Math.floor((diff-1e3*seconds)/10),millisString=millis.toString();1===millisString.length&&(millisString="0"+millisString);var timeString=secondsString+"."+millisString;$($element).find("svg.title text tspan").each(function(index){this.textContent=timeString[index]});var kmh=Math.min(50,Math.round(50*(currTime-startTime)/duration)),kmh0=Math.floor(kmh/10);$kmh0El[0]&&($kmh0El[0].textContent=kmh0,$kmh1El[0].textContent=kmh-10*kmh0,currTime>endTime&&($interval.cancel(counter),counter=null,didFinish=!0,$rootScope.finishPlay=!0))},1e3/30)}},findString=$scope.isFF()?".title-wrapper text":".title-wrapper tspan",titleTween=ModulePageIntroService.createElementFadeInTween($($element).find(findString),2.5,.5,{ease:Quad.easeIn,onStart:resetTimerIfNotRunning}),bodyTween=ModulePageIntroService.createBodyFadeInTween($element,null,.5);this.timeline=new TimelineMax({delay:.25}),this.timeline.insert(bodyTween).insert(titleTween).play()},destroy:function(){delete $rootScope.finishPlay,this.timeline&&(this.timeline.pause(0,!0).remove(),this.timeline=null),$(".body",$element).attr("style","")}},$scope.fallback={init:function(){$(".navbar-header").removeClass("white"),imgix.onready(function(){imgix.fluid({fluidClass:"background-image-fallback"})})},destroy:function(){}},$scope.init($scope,$element,!0)}]),angular.module("gogoro.faster.moduleFaster10SuspensionView",[]).controller("moduleFaster10SuspensionController",["$scope","$window","$element","$timeout",function($scope,$window,$element,$timeout){var moduleFaster10Suspension={configure:{currentState:gogoro.App.getBreakpoint()},init:function(){var obj=this;obj.getState(),$(window).on("resize",function(){obj.configure.currentState!==gogoro.App.getBreakpoint()&&(obj.configure.currentState=gogoro.App.getBreakpoint(),obj.getState())})},getState:function(){var obj=this;"lg"===obj.configure.currentState||"md"===obj.configure.currentState?(obj.fallback.destroy(),obj.standard.init()):("sm"===obj.configure.currentState||"xs"===obj.configure.currentState)&&(obj.standard.destroy(),obj.fallback.init())},standard:{init:function(){function timelineGoto(item){if(timelineData.isAnimating)return!1;timelineData.isAnimating=!0;var currentItem=timelineData.currentItem;$scope.currentItem=currentItem;var nextItem=function(){return item?1*item+1:currentItem+1},$this=$(".module-faster-10-suspension .timeline");setTimeout(function(){$this.removeClass("current-item-1 current-item-2 current-item-3 current-item-4"),$this.addClass("current-item-"+nextItem())},350),$(".content-wrapper.content-"+currentItem).velocity("fadeOut",{duration:350}),$(".content-wrapper.content-"+nextItem()).velocity("fadeIn",{delay:250,duration:350}),4===nextItem()&&$(".content-wrapper.content-1").velocity("fadeIn",{duration:0}),$(".timeline-control").velocity({left:$($window).outerWidth()/2-timelineData.centerPoint["item_"+nextItem()]},{duration:700,easing:"ease",complete:function(){timelineData.currentItem===timelineData.totalItems&&($(this).css({left:$($window).outerWidth()/2-timelineData.centerPoint.item_1}),timelineData.currentItem=1),timelineData.isAnimating=!1}}),timelineData.currentIndicator=nextItem(),timelineData.currentIndicator===timelineData.totalItems&&(timelineData.currentIndicator=1),$(".timeline-indicator li i.icon-bullet-active").removeClass("icon-bullet-active").addClass("icon-bullet-inactive"),$(".timeline-indicator li i:eq("+(timelineData.currentIndicator-1)+")").removeClass("icon-bullet-inactive").addClass("icon-bullet-active"),nextItem()<=timelineData.totalItems&&(timelineData.currentItem=nextItem()),setPromise()}function setPromise(){}imgix.fluid({fluidClass:"faster-10-standard"}),$(".timeline").css({display:"block"});var timelineData={totalItems:4,currentItem:1,centerPoint:{item_1:"xs"===gogoro.App.getBreakpoint()?640:1280,item_2:"xs"===gogoro.App.getBreakpoint()?120:40,item_3:"xs"===gogoro.App.getBreakpoint()?-420:-1250,item_4:"xs"===gogoro.App.getBreakpoint()?-992:-2500},isAnimating:!1,currentIndicator:1};$(".timeline-indicator").on("click",function(e){e.stopPropagation()}),$(".timeline-indicator i").on("click",function(e){e.preventDefault(),e.stopPropagation();var $this=$(this),selected=$this.attr("data-index");$timeout.cancel($scope.promise),timelineGoto(selected)}),$(".timeline").unbind().on("click",function(){$timeout.cancel($scope.promise),timelineGoto()}),$(".timeline-control").css({left:$($window).outerWidth()/2-timelineData.centerPoint.item_1}),$($window).on("resize",function(){var windowWidth=$($window).outerWidth(),windowCenter=windowWidth/2;$(".timeline-control").css({left:windowCenter-timelineData.centerPoint["item_"+timelineData.currentItem]})}),$scope.promise=null,$scope.currentItem=0},destroy:function(){$(".timeline").css({display:"none"})}},fallback:{init:function(){imgix.fluid({fluidClass:"faster-10-fallback"})},destroy:function(){}}};moduleFaster10Suspension.init()}]),angular.module("gogoro.faster.moduleFaster11CompoundTireView",[]).controller("moduleFaster11CompoundTireController",["$scope","$element",function($scope,$element){var $el=$($element),animationDuration=800;$el.on("mouseenter",function(){"xs"!==gogoro.App.getBreakpoint()&&"sm"!==gogoro.App.getBreakpoint()&&($("img.active",$el).velocity("stop").velocity("fadeIn",{duration:animationDuration,easing:"easeIn"}),$(".descriptions .center, .descriptions .edge",$el).velocity("stop").velocity("transition.slideRightIn",{duration:animationDuration/2,easing:"easeIn",stagger:150}),$(".descriptions .center .line, .descriptions .edge .line",$el).velocity("stop").velocity("fadeIn",{duration:animationDuration/2,easing:"easeIn",delay:animationDuration/2}))}),$el.on("mouseleave",function(){"xs"!==gogoro.App.getBreakpoint()&&"sm"!==gogoro.App.getBreakpoint()&&($("img.active",$el).velocity("stop").velocity("fadeOut",{duration:animationDuration,easing:"easeIn"}),$(".descriptions .center, .descriptions .edge",$el).velocity("stop").velocity("transition.slideRightOut",{duration:animationDuration/2,easing:"easeOut",stagger:150}),$(".descriptions .center .line, .descriptions .edge .line",$el).velocity("stop").velocity("fadeOut",{duration:animationDuration/2,easing:"easeOut"}))})}]),angular.module("gogoro.faster.moduleFaster11aCenterLockView",[]).controller("moduleFaster11aCenterLockController",["$scope","$element",function($scope,$element){var $el=$($element),animationDuration=800;"xs"!==gogoro.App.getBreakpoint()&&($el.on("mouseenter",function(){$("img.active",$el).velocity("stop").velocity("fadeIn",{duration:animationDuration,easing:"easeIn"})}),$el.on("mouseleave",function(){$("img.active",$el).velocity("stop").velocity("fadeOut",{duration:animationDuration,easing:"easeIn"})}))}]),angular.module("gogoro.faster.moduleFaster14AerodynamicDesignView",[]).controller("moduleFaster14AerodynamicDesignController",["$scope","$element",function(){}]),angular.module("gogoro.faster.moduleFaster15WaterproofView",[]).controller("moduleFaster15WaterproofController",["$scope","$element","$window","$controller","FallbackManagerFactory",function($scope,$element,$window,$controller,FallbackManagerFactory){angular.extend($scope,FallbackManagerFactory),$scope.standard={init:function(){$(".water-level").velocity("stop").velocity("transition.slideUpBigIn").velocity({top:25},{loop:!0,duration:1500,ease:"easeOut"})},destroy:function(){}},$scope.fallback={init:function(){imgix.fluid({fluidClass:"faster-15-fallback"})},destroy:function(){}},$scope.init($scope,$element,!0)}]),angular.module("gogoro.faster.moduleFaster16DesignEthosView",[]).controller("moduleFaster16DesignEthosController",["$scope","$element",function(){}]),angular.module("gogoro.faster.moduleFaster2CleanVideoView",[]).controller("moduleFaster2CleanVideoController",["$scope","$element","$window","$controller","FallbackManagerFactory",function($scope,$element,$window,$controller,FallbackManagerFactory){angular.extend($scope,FallbackManagerFactory),$scope.standard={init:function(){$(".video",$element).css({display:"block"}),$.extend(this,$controller("ModuleVideoController",{$scope:$scope,$element:$element,$window:$window}));new gogoro.common.VideoModal},destroy:function(){$(".video",$element).css({display:"none"})}},$scope.fallback={init:function(){new gogoro.common.VideoModal},destroy:function(){}},$scope.init($scope,$element)}]),angular.module("gogoro.faster.moduleFaster3SummaryInfoView",[]).controller("moduleFaster3SummaryInfoController",["$scope","$element","$controller","FallbackManagerFactory",function($scope,$element,$controller,FallbackManagerFactory){angular.extend($scope,FallbackManagerFactory),$scope.standard={init:function(){$.extend(this,$controller("ModuleSummaryInfoController",{$scope:$scope,$element:$element}))},destroy:function(){this.controller&&(this.controller.destroy(!0),this.contoller=null)}},$scope.fallback={init:function(){"lg"!==gogoro.App.getBreakpoint()&&($(".row",$element).slick({slide:".slide",dots:!0,arrows:!1,accessibility:!0,infinite:!0,speed:650,cssEase:"ease",slidesToShow:1,draggable:!1}),$(".row .slide",$element).on("click",function(){$(".row",$element).slickNext()}))},destroy:function(){$(".row",$element).unslick()}},$scope.init($scope,$element)}]),angular.module("gogoro.faster.moduleFaster4PerformanceHeroView",[]).controller("moduleFaster4PerformanceHeroController",["$scope","$element","$controller","FallbackManagerFactory",function($scope,$element,$controller,FallbackManagerFactory){angular.extend($scope,FallbackManagerFactory),$scope.standard={init:function(){var duration=.3,playVideo=function(){},tween=TweenMax.staggerFromTo($($element).find("h3"),duration,{opacity:0,"margin-left":"-10%"},{opacity:1,"margin-left":0,repeat:0,immediateRender:!0,ease:Linear.easeNone},duration);this.controller=new ScrollMagic;new ScrollScene({triggerElement:$element,duration:400}).setTween(tween).on("enter leave",function(){playVideo()}).addTo(this.controller)},destroy:function(){}},$scope.fallback={init:function(){},destroy:function(){}},$scope.init($scope,$element)}]),angular.module("gogoro.faster.moduleFaster5PowertrainView",[]).controller("moduleFaster5PowertrainController",["$rootScope","$scope","$element","$window","$document","$timeout","FallbackManagerFactory","$state",function($rootScope,$scope,$element,$window,$document,$timeout,FallbackManagerFactory){angular.extend($scope,FallbackManagerFactory);var show_info=!1,info=function(msg,value){show_info&&console.log(msg,value)};$scope.standard={init:function(){function clickContentAndPlayVideo(){var targetContentFrame=Math.min(totalContentFrames,currentContentFrame+1);6===targetContentFrame&&(targetContentFrame=0),$scope.playing&&$videoEl.off("timeupdate",checkFrameTime),$scope.playing=!1,setCurrentContentFrame(targetContentFrame),$paginationEl.eq(currentContentFrame).addClass("active")}$(".powertrain-blocker").css({display:"block"});var that=this,didDestroy=!1,videoFrameTimes=[0,2,5,12,16,24],videoFrameTextTimes=[0,-.5,-.5,-2.33,-1.5,-5.5];$scope.playing=!1,$scope.currentPlayFrame=0;var moduleHeight,$el=$($element),$firstModuleEl=($el.height(),$($element).siblings().eq(3)),$prevModuleEl=$($element).prev(),$contentEl=$el.find(".module-video-scroller-content"),$backgroundsEl=$el.find(".module-video-scroller-backgrounds"),posterCounter=0,moduleHeightDidChange=function(){if(!didDestroy){moduleHeight=$contentEl.height();var w=$el.innerWidth();2>posterCounter&&(w-=17,posterCounter++),$contentEl.width(w),$videoViewportWrapperEl.width(w);{(moduleHeight-$videoViewportEl.height())/2+100}info("moduleHeight",moduleHeight),info("$videoViewportEl.height()",$videoViewportEl.height()),$videoViewportWrapperEl.css({"margin-top":"-330px"}),updateVideo()}},setCurrentContentFrame=function(targetContentFrame){if(!($scope.playing||(0>targetContentFrame&&(targetContentFrame=0),targetContentFrame>8&&(targetContentFrame=7),$scope.playing||currentContentFrame===targetContentFrame||!videoLoaded||$videoEl[0].readyState<4))){var lastContentFrame=currentContentFrame;
currentContentFrame=targetContentFrame;var frame=Math.min(currentContentFrame,totalContentFrames-1);$paginationEl.children(".page-wrapper").removeClass("active").eq(frame).addClass("active"),$contentEl.focus();var $textEl=$contentFramesEl.eq(frame);if($contentFramesEl.each(function(index,element){index!==frame&&$(element).stop().fadeTo(0,0).data("fading",!1)}),$videoEl.off("timeupdate",checkFrameTime),$videoEl.off("ended",checkFrameTime),$scope.playing=!0,lastContentFrame>=frame||frame-lastContentFrame>1){var time=videoFrameTimes[frame];$videoEl[0].pause(),$videoEl[0].currentTime=time,$timeout(function(){frame===Math.min(currentContentFrame,totalContentFrames-1)&&($videoEl[0].currentTime=time,$textEl.data("fading")||$textEl.data("fading",!0).stop().fadeTo("fast",1)),setTimeout(function(){$scope.playing=!1,$scope.currentPlayFrame=targetContentFrame},500)},500)}else $videoEl[0].currentTime=videoFrameTimes[frame-1],$videoEl[0].play(),$videoEl.on("timeupdate",checkFrameTime),frame===totalContentFrames-1&&$videoEl.on("ended",checkFrameTime)}},checkFrameTime=function(e){if($videoEl[0].currentTime>=videoFrameTimes[currentContentFrame]||"ended"===e.type){$videoEl[0].pause(),$videoEl[0].currentTime=videoFrameTimes[currentContentFrame];var $textEl=$contentFramesEl.eq(currentContentFrame);$textEl.data("fading")||$textEl.data("fading",!0).stop().fadeTo("fast",1),$videoEl.off("timeupdate",checkFrameTime),$videoEl.off("ended",checkFrameTime),$scope.currentPlayFrame+=1,setTimeout(function(){$scope.playing=!1},200)}else if($videoEl[0].currentTime>=videoFrameTimes[currentContentFrame]+videoFrameTextTimes[currentContentFrame]){var $textEl=$contentFramesEl.eq(currentContentFrame);$textEl.data("fading")||$textEl.data("fading",!0).stop().fadeTo("fast",1)}},updateVideo=function(){if($("#faster").is(":visible")&&$rootScope.finishPlay&&void 0!=$rootScope.finishPlay&&$contentEl.hasClass("pinned")){var targetContentFrame=totalContentFrames;$backgroundsEl.children(".frame").each(function(index,element){$(element);index>0&&totalContentFrames>=index&&backgroundTop>=0&&(targetContentFrame=Math.min(index-1,targetContentFrame))}),setCurrentContentFrame(targetContentFrame)}},$contentFramesEl=$contentEl.children(".frame"),currentContentFrame=0,totalContentFrames=videoFrameTimes.length,$videoViewportWrapperEl=$contentEl.find(".video-viewport-wrapper"),$videoViewportEl=$videoViewportWrapperEl.children(".video-viewport"),$videoEl=$videoViewportEl.children("video"),w=$videoEl.attr("width"),h=$videoEl.attr("height");$videoViewportEl.width(w).height(h),this.controller=new ScrollMagic;var $paginationEl=$contentEl.find(".frame-pagination");$paginationEl.css("opacity",1);for(var i=0;totalContentFrames>i;i++){{$contentFramesEl.eq(i).find(".title").html()}$paginationEl.append('<div class="page-wrapper"><div class="page"></div></div>')}$paginationEl.children(".page-wrapper").on("click",function(){var targetContentFrame=$paginationEl.children(".page-wrapper").index(this);return $scope.playing&&($videoEl.off("timeupdate",checkFrameTime),$videoEl.off("ended",checkFrameTime)),$scope.playing=!1,setCurrentContentFrame(targetContentFrame),!1}).eq(currentContentFrame).addClass("active"),$videoEl.on("playing",function(){$contentEl.off("click"),$paginationEl.velocity({display:"none",opacity:0},{duration:200}),$(".module-video-scroller-content").css("cursor","default")}),$videoEl.on("pause",function(){$contentEl.on("click",clickContentAndPlayVideo),$paginationEl.velocity({display:"block",opacity:1},{duration:500}),$(".module-video-scroller-content").css("cursor","pointer")}),$contentEl.on("click",clickContentAndPlayVideo);var videoLoaded=4===$videoEl[0].readyState;videoLoaded||($videoEl[0].load(),$videoEl.on("canplaythrough",function(){videoLoaded=!0,moduleHeightDidChange()}));var resizeTimeoutPromise,resize=function(){$timeout.cancel(resizeTimeoutPromise),resizeTimeoutPromise=$timeout(moduleHeightDidChange,100)};$($window).on("resize",resize),moduleHeightDidChange();var viewAreaHeight=((moduleHeight-$videoViewportEl.height())/2+100,1120),viewAreaHeight=1160;$videoViewportWrapperEl.css({clip:"rect(330px, "+$videoViewportEl.width()+"px, "+viewAreaHeight+"px, 0)"}),this.destroyVideoScroller=function(){didDestroy=!0,$timeout.cancel(resizeTimeoutPromise),that.controller&&(that.controller.destroy(!0),that.controller=null),$($window).off("resize",resize),$($window).off("scroll",updateVideo),$paginationEl.children().remove(),$contentEl.off("click"),$videoEl.off("canplaythrough"),$videoEl.off("timeupdate"),$videoEl.off("ended"),setCurrentContentFrame(0),$firstModuleEl.velocity("stop").css({"margin-top":0}),$prevModuleEl.velocity("stop").css({"margin-bottom":0}),$el.velocity("stop").css({height:"auto","margin-bottom":0}),$paginationEl.height({height:"auto"}),$contentEl.css({width:"auto"}),$videoViewportWrapperEl.velocity("stop").css({clip:"auto","margin-top":"0",width:"auto",height:"auto"}),$videoViewportEl.css({width:"auto",height:"auto"}),$backgroundsEl.find(".frame-pin .trigger").css({"margin-top":"0"}),$backgroundsEl.children(".frame").each(function(index,element){$(element).css({height:"auto"})}),$(".powertrain-blocker").css({display:"none"})}},destroy:function(){this.destroyVideoScroller&&this.destroyVideoScroller()}},$scope.fallback={init:function(){$(".module-faster-5-content",$element).css({display:"none"}),$(".powertrain-blocker").css({display:"none"}),$(".module-faster-5-fallback",$element).css({display:"block"}).slick({slide:".slide",dots:!0,arrows:!1,infinite:!0,speed:650,cssEase:"ease",slidesToShow:1,draggable:!1,onInit:function(){imgix.onready(function(){imgix.fluid()})}}),$(".module-faster-5-fallback .slide",$element).on("click",function(){$(".module-faster-5-fallback",$element).slickNext()})},destroy:function(){$(".module-faster-5-fallback",$element).unslick().css({display:"none"}),$(".module-faster-5-content",$element).css({display:"block"})}},$scope.init($scope,$element,!0)}]),angular.module("gogoro.faster.moduleFaster7ComparisonInfographicView",[]).controller("moduleFaster7ComparisonInfographicController",["$scope","$element","FallbackManagerFactory",function($scope,$element,FallbackManagerFactory){angular.extend($scope,FallbackManagerFactory),$scope.standard={init:function(){function buildTimeline(){torque_tl.to($torque_gogoro,3,{strokeDashoffset:0}).to($torque_normal,3,{strokeDashoffset:0},"-=3").to($svgRedlines,1,{opacity:1},"-=1.3").to($torque_gogoro_txt,1,{opacity:1},"-=0.3").to($torque_normal_txt,1,{opacity:1},"-=0.3").to($torque_stronger_centerbox,.5,{opacity:1,delay:punchLineDelay})}Modernizr.svg||console.log("svg not support");var setTimeForBar=function(time,$el){var secs=Math.floor(time),millis=Math.floor((1e3*time-1e3*secs)/10);$el.find(".time .second").text(secs),$el.find(".time .millis").text("."+(10>millis?"0"+millis:millis))},$el=$($element),$barsEl=$el.find(".infographic .bars"),speedMultiplier=2,$usEl=$el.find(".us"),$usBarEl=$usEl.find(".bar"),endUsTime=4.2,usDuration=endUsTime/speedMultiplier,usTween=TweenMax.fromTo($usBarEl,usDuration,{width:0},{width:$usBarEl.css("max-width"),roundProps:"width",repeat:0,immediateRender:!0,ease:Linear.easeNone,onUpdateParams:["{self}"],onUpdate:function(self){var time=self._time*speedMultiplier;setTimeForBar(time,$usEl)}}),$themEl=$el.find(".them"),$themBarEl=$themEl.find(".bar"),$themBarRemainderEl=$barsEl.find(".them .bar-remainder"),endThemTime=5.03,themDuration=endThemTime/speedMultiplier,themRemainderDuration=500,themTween=TweenMax.fromTo($themBarEl,themDuration,{width:0},{width:$themBarEl.css("max-width"),roundProps:"width",repeat:0,immediateRender:!0,ease:Linear.easeNone,onUpdateParams:["{self}"],onUpdate:function(self){var time=self._time*speedMultiplier;setTimeForBar(time,$themEl),$themBarRemainderEl.hide()},onComplete:function(){$themBarRemainderEl.fadeIn(themRemainderDuration)}}),$usBarTitleEl=$usBarEl.children(".title"),$themBarTitleEl=$themBarEl.children(".title"),barTitleDuration=1,usBarTitleDelay=.66,usBarTitleTween=TweenMax.fromTo($usBarTitleEl,barTitleDuration,{opacity:0},{opacity:1,delay:usBarTitleDelay,repeat:0,immediateRender:!0,ease:Linear.easeNone}),themBarTitleTween=TweenMax.fromTo($themBarTitleEl,barTitleDuration,{opacity:0},{opacity:1,repeat:0,immediateRender:!0,ease:Linear.easeNone}),$punchLineEl=$el.find(".image .punch-line"),punchLineDuration=.5,punchLineDelay=.33,punchLineTween=TweenMax.fromTo($punchLineEl,punchLineDuration,{opacity:0},{opacity:1,delay:punchLineDelay,repeat:0,immediateRender:!0,ease:Linear.easeNone}),acceleration_tl=new TimelineMax;acceleration_tl.insert(usTween).insert(themTween).add(usBarTitleTween).add(themBarTitleTween).add(punchLineTween),this.controller=new ScrollMagic;var torque_tl,$torque_gogoro=(new ScrollScene({triggerElement:$element,duration:0}).setTween(acceleration_tl).addTo(this.controller),$("#svg-gogoro-torque")),$torque_normal=$("#svg-normal-torque"),$svgRedlines=$("#svg-redlines"),$torque_gogoro_txt=$("#svg-gogoro-text"),$torque_normal_txt=$("#svg-normal-text"),$torque_stronger_centerbox=$(".svg-stronger-center-box"),play_once=!1,torque_tl=new TimelineMax,$acceleEl=$el.find(".charts.acceleration"),$torqueEl=$el.find(".charts.torque"),$themesEl=$el.find(".theme-toggle a"),$accelerationTxtWrap=$el.find(".acceleration-txt-wrap"),$torqueTxtWrap=$el.find(".torque-txt-wrap");$themesEl.eq(0).css("opacity",1),$themesEl.eq(2).css("opacity",1),$torqueTxtWrap.velocity("stop").velocity("fadeOut",{duration:0}),$accelerationTxtWrap.velocity("stop").velocity("fadeIn",{duration:0}),$themesEl.on("click",function(){$themesEl.css("opacity",.3),"acceleration"==$(this).data("chart")?($torqueEl.velocity("stop").velocity("fadeOut",{duration:0,complete:function(){$acceleEl.velocity("stop").velocity("fadeIn",{duration:0})}}),$torqueTxtWrap.velocity("stop").velocity("fadeOut",{duration:0,complete:function(){$accelerationTxtWrap.velocity("stop").velocity("fadeIn",{duration:0})}}),acceleration_tl.restart(),$themesEl.eq(0).css("opacity",1),$themesEl.eq(2).css("opacity",1),$torque_gogoro.css("stroke-dasharray",600).css("stroke-dashoffset",600),$torque_normal.css("stroke-dasharray",600).css("stroke-dashoffset",600),TweenMax.to($svgRedlines,0,{opacity:"0"}),TweenMax.to($torque_gogoro_txt,0,{opacity:0}),TweenMax.to($torque_normal_txt,0,{opacity:0}),TweenMax.to($torque_stronger_centerbox,0,{opacity:0}),$torque_stronger_centerbox.css("opacity",0)):($acceleEl.velocity("stop").velocity("fadeOut",{duration:50,complete:function(){$torqueEl.velocity("stop").velocity("fadeIn",{duration:450,complete:function(){0==play_once?(setTimeout(function(){buildTimeline()},500),play_once=!0):torque_tl.restart()}})}}),$accelerationTxtWrap.velocity("stop").velocity("fadeOut",{duration:0,complete:function(){$torqueTxtWrap.velocity("stop").velocity("fadeIn",{duration:0})}}),$themesEl.eq(1).css("opacity",1),$themesEl.eq(3).css("opacity",1),$punchLineEl.css("opacity",0))})},destroy:function(){this.controller&&(this.controller.destroy(!0),this.contoller=null)}},$scope.fallback={init:function(){function resetChartText(){"sm"===gogoro.App.getBreakpoint()&&($firstlineimage.prop("src",url+images[0]),$accelH2.text(charth2[0]),$accelp.text(charthp[0]),$torqueTxtWrap.show())}var $el=$($element),$accelerationTxtWrap=$el.find(".acceleration-txt-wrap"),$torqueTxtWrap=$el.find(".torque-txt-wrap"),$accelH2=$accelerationTxtWrap.find("h2"),$accelp=$accelerationTxtWrap.find("p"),$themesEl=$el.find(".theme-toggle a"),$firstlineimage=$el.find(".firstlineimage"),charth2=["First off the line","Born to Lead"],charthp=["Instant access to 100% power torque on demand. Our digital throttle in sport mode takes riders from 0-50 km/h in 4.2 seconds. Youll lead the pack, every time.","Gogoros G1 motor serves up full torque from 0 RPM. So while gas guzzling scooters are still busy revving up their engines, youre probably already gone."],url="//images.gogoroapp.com/",images=["faster-7-infographic.fallback-new.png","faster-7-torque.fallback-new.png"];$(".background-image.fallback.firstlineimage").show(),$(".charts.acceleration").hide(),$themesEl.eq(0).css("opacity",1),$themesEl.on("click",function(e){e.preventDefault(),$themesEl.css("opacity",.3),"acceleration"==$(this).data("chart")?($themesEl.eq(0).css("opacity",1),$themesEl.eq(2).css("opacity",1),$firstlineimage.prop("src",url+images[0]),$accelH2.text(charth2[0]),$accelp.text(charthp[0])):($themesEl.eq(1).css("opacity",1),$themesEl.eq(3).css("opacity",1),$firstlineimage.prop("src",url+images[1]),$accelH2.text(charth2[1]),$accelp.text(charthp[1]))}),resetChartText(),$(window).resize(function(){resetChartText()})},destroy:function(){$(".background-image.fallback.firstlineimage").hide(),$(".charts.acceleration").show()}},$scope.init($scope,$element,!0)}]),angular.module("gogoro.faster.moduleFasterControlHeroView",[]).controller("moduleFasterControlHeroController",["$scope","$element","$controller","FallbackManagerFactory",function($scope,$element,$controller,FallbackManagerFactory){angular.extend($scope,FallbackManagerFactory),$scope.standard={init:function(){var duration=.3,playVideo=function(){},tween=TweenMax.staggerFromTo($($element).find("h3"),duration,{opacity:0,"margin-left":"-10%"},{opacity:1,"margin-left":0,repeat:0,immediateRender:!0,ease:Linear.easeNone},duration);this.controller=new ScrollMagic;new ScrollScene({triggerElement:$element,duration:400}).setTween(tween).on("enter leave",function(){playVideo()}).addTo(this.controller)},destroy:function(){}},$scope.fallback={init:function(){},destroy:function(){}},$scope.init($scope,$element)}]),angular.module("gogoro.faster.moduleFaster9ChassisView",[]).controller("moduleFaster9ChassisController",["$scope","$element","$window","$timeout","$controller","FallbackManagerFactory",function($scope,$element,$window,$timeout,$controller,FallbackManagerFactory){angular.extend($scope,FallbackManagerFactory),imgix.fluid({fluidClass:"faster-9-background-image"}),$scope.standard={init:function(){$(".module-video-slider-content",$element).css({display:"block"});var videoFrameTimes=[1,5,14.5,23,30];$.extend(this,$controller("ModuleVideoSliderController",{$scope:$scope,$element:$element,$window:$window,$timeout:$timeout,videoFrameTimes:videoFrameTimes,shouldCrossFade:!0}))},destroy:function(){$(".module-video-slider-content",$element).unbind(),$(".frame-pagination div",$element).remove(),$(".frame",$element).attr("style","")}},$scope.fallback={init:function(){$(".module-video-slider-content",$element).slick({slide:".frame",dots:!0,arrows:!1,infinite:!0,speed:650,cssEase:"ease",slidesToShow:1,draggable:!1,onInit:function(){imgix.onready(function(){imgix.fluid()})}}),$(".module-video-slider-content .frame",$element).on("click",function(){$(".module-video-slider-content",$element).slickNext()})},destroy:function(){$(".module-video-slider-content",$element).unslick().css({display:"none"})}},$scope.init($scope,$element)}]),angular.module("gogoro.smarter.moduleSmarter1PageIntroView",[]).controller("moduleSmarter1PageIntroController",["$scope","$element","ModulePageIntroService","FallbackManagerFactory",function($scope,$element,ModulePageIntroService,FallbackManagerFactory){angular.extend($scope,FallbackManagerFactory);var $el=$($element);$scope.isIE10OrLess()||$el.find(".title-wrapper").append($el.find("script.svg").html()),$scope.standard={init:function(){imgix.onready(function(){imgix.fluid({fluidClass:"background-image-standard"})});for(var createSensorTween=function($element,duration,delay){var fromProperties={opacity:0,width:0,height:0},toProperties={opacity:1,width:14,height:14,left:-7,top:-7,delay:delay,repeat:0,immediateRender:!0,ease:Linear.easeIn};return TweenMax.fromTo($element,duration,fromProperties,toProperties)},createSensorRippleTween=function($element,duration,delay){var $rippleEl=$('<div class="ripple">'),$wrapperEl=$('<div class="sensor-wrapper">').append($rippleEl);$element.parent().parent().append($wrapperEl),$wrapperEl.css({left:$element.parent().css("left"),top:$element.parent().css("top")});var fromProperties={opacity:.5,width:14,height:14,left:-7,top:-7},toProperties={opacity:0,width:128,height:128,left:-64,top:-64,delay:delay,repeat:0,immediateRender:!1,ease:Quad.easeOut};return TweenMax.fromTo($rippleEl,duration,fromProperties,toProperties)},$sensorsEl=$($element).find(".background-image .sensors .sensor"),sensorsTimeline=new TimelineMax,findString=$scope.isFF()?".title-wrapper text":".title-wrapper tspan",$titleLettersEl=$($element).find(findString),order=[1,4,3,0,2],$wifiWavesEl=$($element).find(".title-wrapper .wifi > div"),wifiTimeline=new TimelineMax,smt=$sensorsEl.length-$titleLettersEl.length,i=0;i<$sensorsEl.length;i++)sensorsTimeline.insert(createSensorTween($sensorsEl.eq(i),.5,.2*i)),i>=smt&&sensorsTimeline.insert(ModulePageIntroService.createElementFadeInTween($titleLettersEl.eq(order[i-smt]),.5,.3*i+.2)),sensorsTimeline.insert(createSensorRippleTween($sensorsEl.eq(i),.8,.3*i+.25)),sensorsTimeline.insert(createSensorRippleTween($sensorsEl.eq(i),.8,.3*i+.4));var count=$wifiWavesEl.length;for(i=0;count>i;i++)wifiTimeline.insert(ModulePageIntroService.createElementFadeInTween($wifiWavesEl.eq(i),.4,.2*i));for(i=0;count>i;i++)wifiTimeline.insert(ModulePageIntroService.createElementFadeOutTween($wifiWavesEl.eq(i),.8,.2*i+.2*count));var bodyTween=ModulePageIntroService.createBodyFadeInTween($element,null,.5);this.timeline=new TimelineMax({delay:.25}),this.timeline.insert(bodyTween).add(sensorsTimeline),wifiTimeline.insert(ModulePageIntroService.createElementFadeOutTween($sensorsEl,.8,1)),this.timeline.add(wifiTimeline).play()},destroy:function(){this.timeline&&(this.timeline.pause(0,!0).remove(),this.timeline=null),$(".body",$element).attr("style","")}},$scope.fallback={init:function(){imgix.onready(function(){imgix.fluid({fluidClass:"background-image-fallback"})})},destroy:function(){}},$scope.init($scope,$element,!0)}]),angular.module("gogoro.smarter.moduleSmarter12DesignEthosView",[]).controller("moduleSmarter12DesignEthosController",["$scope","$element","$controller","FallbackManagerFactory",function($scope,$element,$controller,FallbackManagerFactory){angular.extend($scope,FallbackManagerFactory),$scope.standard={init:function(){var $el=$($element),animationDuration=800;$el.on("mouseenter",function(){$(".background-on",$el).velocity("stop").velocity("fadeIn",{duration:animationDuration,easing:"easeIn"})}),$el.on("mouseleave",function(){$(".background-on",$el).velocity("stop").velocity("fadeOut",{duration:animationDuration,easing:"easeIn"})})},destroy:function(){var $el=$($element);$el.unbind(),$(".background-on, .background-off").attr("style","")}},$scope.fallback={init:function(){},destroy:function(){}},$scope.init($scope,$element)}]),angular.module("gogoro.smarter.moduleSmarter2CleanVideoView",[]).controller("moduleSmarter2CleanVideoController",["$scope","$element","$window","$controller","FallbackManagerFactory",function($scope,$element,$window,$controller,FallbackManagerFactory){angular.extend($scope,FallbackManagerFactory),$scope.standard={init:function(){$(".video",$element).css({display:"block"}),$.extend(this,$controller("ModuleVideoController",{$scope:$scope,$element:$element,$window:$window}));new gogoro.common.VideoModal},destroy:function(){$(".video",$element).css({display:"none"})}},$scope.fallback={init:function(){},destroy:function(){}},$scope.init($scope,$element)}]),angular.module("gogoro.smarter.moduleSmarter3SummaryInfoView",[]).controller("moduleSmarter3SummaryInfoController",["$scope","$element","$controller","FallbackManagerFactory",function($scope,$element,$controller,FallbackManagerFactory){angular.extend($scope,FallbackManagerFactory),$scope.standard={init:function(){$.extend(this,$controller("ModuleSummaryInfoController",{$scope:$scope,$element:$element}))},destroy:function(){this.controller&&(this.controller.destroy(!0),this.contoller=null)}},$scope.fallback={init:function(){"lg"!==gogoro.App.getBreakpoint()&&($(".row",$element).slick({slide:".slide",dots:!0,arrows:!1,accessibility:!0,infinite:!0,speed:650,cssEase:"ease",slidesToShow:1,draggable:!1}),$(".row .slide",$element).on("click",function(){$(".row",$element).slickNext()}))},destroy:function(){$(".row",$element).unslick()}},$scope.init($scope,$element)}]),angular.module("gogoro.smarter.moduleSmarterRideSmartView",[]).controller("moduleSmarterRideSmartController",["$scope","$element","$controller","FallbackManagerFactory",function($scope,$element,$controller,FallbackManagerFactory){angular.extend($scope,FallbackManagerFactory),$scope.standard={init:function(){var duration=.3,playVideo=function(){},tween=TweenMax.staggerFromTo($($element).find("h3"),duration,{opacity:0,"margin-left":"-10%"},{opacity:1,"margin-left":0,repeat:0,immediateRender:!0,ease:Linear.easeNone},duration);this.controller=new ScrollMagic;var $module=(new ScrollScene({triggerElement:$element,duration:400}).setTween(tween).on("enter leave",function(){playVideo()}).addTo(this.controller),$(".module-smarter-4b-smart-mode-chart")),$normalMode=$module.find(".svg-normal-mode"),$smartMode=$module.find(".svg-smart-mode"),$squareBg=$module.find(".svg-square-box-bg"),$squareFuther=$module.find(".svg-square-box-futher"),$normalModeLine=$module.find(".module-smarter-4b-normal-mode-line"),smartController=new ScrollMagic,$smartModelinearGradientStop=$smartMode.find(".smart-mode-lg-stop");$smartModelinearGradientStop.eq(0).attr("stop-opacity",.1),$smartModelinearGradientStop.eq(1).attr("stop-opacity",.1);var $normalModeLinearGradientStop=$normalMode.find(".normal-mode-lg-step"),$normalModeLighter=$normalMode.clone();$normalModeLighter.attr("class","svg-normal-mode-lighter"),$normalModeLighter.find("linearGradient").attr("id","normal-mode-lg-lighter"),$normalModeLighter.find("linearGradient").find("stop").attr("class","normal-mode-lg-step-lighter"),$normalModeLighter.find("path").attr("id","normal-mode-path-lighter"),$normalModeLighter.find("path").attr("stroke","url(#normal-mode-lg-lighter)"),$normalModeLinearGradientStop.eq(0).attr("stop-opacity",.1),$normalModeLinearGradientStop.eq(1).attr("stop-opacity",.1),$normalModeLinearGradientStop.each(function(){}),$smartModelinearGradientStop.each(function(){}),$squareBg.css("opacity",0),$squareFuther.css("opacity",0);var tweenNormalModeLine=TweenMax.to($normalModeLine,1,{opacity:0,height:0,top:"225px","background-size":"636px 0px"},"+=0.75"),tweeSmartModelinearGradientStop=TweenMax.to($smartModelinearGradientStop,.2,{"stop-opacity":1}),tweeSquareBg=TweenMax.to($squareBg,.4,{opacity:1,delay:.5}),tweeSquareFuther=TweenMax.to($squareFuther,2,{opacity:1,delay:.5}),smartTimeLines=new TimelineMax;smartTimeLines.add(tweenNormalModeLine).add(tweeSmartModelinearGradientStop).add(tweeSquareBg).add(tweeSquareFuther),new ScrollScene({triggerElement:$module,duration:0}).setTween(smartTimeLines).addTo(smartController).offset(200)},destroy:function(){}},$scope.fallback={init:function(){},destroy:function(){}},$scope.init($scope,$element)}]),angular.module("gogoro.smarter.moduleSmarter5GogoroAppView",[]).controller("moduleSmarter5GogoroAppController",["$scope","$element","$window","$document","$timeout","FallbackManagerFactory",function($scope,$element,$window,$document,$timeout,FallbackManagerFactory){angular.extend($scope,FallbackManagerFactory),$scope.standard={init:function(){function toggleSectionPagination(){var $appPagination=$("#app-pagination",$element);$appPagination.hasClass("active")?$appPagination.velocity("transition.slideRightBigOut",{duration:200}).removeClass("active"):$appPagination.velocity("transition.slideRightBigIn",{duration:200}).addClass("active")}function setSectionHeight(){var windowHeight=$(window).outerHeight();$("#gogoro-app section, #app-pagination",$element).css({height:windowHeight})}var $body=$("body"),$container=$("#gogoro-app",$element);$(window).on("scroll",function(){var scrollPos=$(this).scrollTop(),$firstSection=$("#section-one",$element),$lastSection=$("#section-seven",$element);scrollPos>$firstSection.offset().top&&$container.hasClass("scroll-start")?($container.removeClass("scroll-start"),toggleSectionPagination()):scrollPos<$firstSection.offset().top&&!$container.hasClass("scroll-start")&&($container.addClass("scroll-start"),toggleSectionPagination()),scrollPos>$lastSection.offset().top&&!$container.hasClass("scroll-end")?($container.addClass("scroll-end"),toggleSectionPagination()):scrollPos<$lastSection.offset().top&&$container.hasClass("scroll-end")&&($container.removeClass("scroll-end"),toggleSectionPagination())}),$("section",$element).on("inview",function(event,isInView,visiblePartX,visiblePartY){if(isInView){var currentIndex=$(this).attr("data-index")-1;$("#app-pagination li.active",$element).removeClass("active"),$("#app-pagination li:eq("+currentIndex+")",$element).addClass("active")}}),$("#app-pagination a",$element).on("click",function(e){e.preventDefault();var target=$(this).attr("href");$body.scrollTo(target,400,"easeInOutQuad")}),$(window).on("resize",function(){setSectionHeight()}),setSectionHeight()},destroy:function(){this.destroyApp&&this.destroyApp()}},$scope.fallback={init:function(){$(".module-smarter-5-content, .module-smarter-5-backgrounds",$element).css({display:"none"}),$(".module-smarter-5-fallback",$element).css({display:"block"}).slick({slide:".slide",dots:!0,arrows:!1,accessibility:!0,infinite:!0,speed:650,cssEase:"ease",slidesToShow:1,draggable:!1,onInit:function(){imgix.onready(function(){imgix.fluid()})}}),$(".module-smarter-5-fallback .slide",$element).on("click",function(){$(".module-smarter-5-fallback",$element).slickNext()})},destroy:function(){$(".module-smarter-5-fallback",$element).unslick().css({display:"none"}),$(".module-smarter-5-content, .module-smarter-5-backgrounds",$element).css({display:"block"})}},$scope.init($scope,$element)}]),angular.module("gogoro.smarter.moduleSmarter6SmartBatteryView",[]).controller("moduleSmarter6SmartBatteryController",["$scope","$element",function(){}]),angular.module("gogoro.smarter.moduleSmarter7VMView",[]).controller("moduleSmarter7VMController",["$scope","$element","$window","$controller",function($scope,$element,$window,$controller){var $wrapperElement=$($element).find(".video-wrapper")[0];$.extend(this,$controller("ModuleVideoController",{$scope:$scope,$element:$wrapperElement,$window:$window})),$("body").hasClass("state-standard")&&imgix.fluid({fluidClass:"smarter-7-standard"})}]),angular.module("gogoro.smarter.moduleSmarter8SmartVisionView",[]).controller("moduleSmarter8SmartVisionController",["$scope","$element",function($scope,$element){var $el=$($element),$toggleEl=$el.find(".day-night-toggle"),$dayToggleEl=$toggleEl.children(".day"),$nightToggleEl=$toggleEl.children(".night"),$nightBgdEl=($el.children(".background-day"),$el.children(".background-night")),animationDuration=800;$dayToggleEl.on("click",function(e){e.preventDefault(),$el.hasClass("day")||($dayToggleEl.velocity("stop").velocity({opacity:1}),$nightBgdEl.velocity("stop").velocity({opacity:.3}),$nightBgdEl.velocity("stop").velocity("fadeOut",{duration:animationDuration,easing:"easeIn"}),$("p, h2",$el).velocity("stop").velocity({color:"#000000"},{duration:animationDuration,easing:"easeIn"}),$el.velocity("stop").velocity({backgroundColor:"#eeeeee"},{duration:animationDuration,easing:"easeIn"}),$el.addClass("day"),$el.removeClass("night"))}),$nightToggleEl.on("click",function(e){e.preventDefault(),$el.hasClass("night")||($dayToggleEl.velocity("stop").velocity({opacity:.3}),$nightBgdEl.velocity("stop").velocity({opacity:1}),$nightBgdEl.velocity("stop").velocity("fadeIn",{duration:animationDuration,easing:"easeIn"}),$("p, h2",$el).velocity("stop").velocity({color:"#eeeeee"},{duration:animationDuration,easing:"easeIn"}),$el.velocity("stop").velocity({backgroundColor:"#323237"},{duration:animationDuration,easing:"easeIn"}),$el.addClass("night"),$el.removeClass("day"))})}]),angular.module("gogoro.smarter.moduleSmarter9IqSystemView",[]).controller("moduleSmarter9IqSystemController",["$scope","$element",function(){var moduleSmarter9IqSystem={configure:{currentState:gogoro.App.getBreakpoint()},init:function(){var obj=this;obj.getState(),$(window).on("resize",function(){obj.configure.currentState!==gogoro.App.getBreakpoint()&&(obj.configure.currentState=gogoro.App.getBreakpoint(),obj.getState())})},getState:function(){var obj=this;"lg"===obj.configure.currentState||"md"===obj.configure.currentState?(obj.fallback.destroy(),obj.standard.init()):("sm"===obj.configure.currentState||"xs"===obj.configure.currentState)&&(obj.standard.destroy(),obj.fallback.init())},standard:{init:function(){},destroy:function(){}},fallback:{init:function(){},destroy:function(){}}};moduleSmarter9IqSystem.init()}]),angular.module("gogoro.smarter.moduleSmarterAutoBLinkerOffView",[]).controller("moduleSmarterAutoBLinkerOffController",["$scope","$element","$window","$controller","FallbackManagerFactory",function($scope,$element,$window,$controller,FallbackManagerFactory){angular.extend($scope,FallbackManagerFactory),$scope.standard={init:function(){$(".video",$element).css({display:"block"}),$.extend(this,$controller("ModuleVideoController",{$scope:$scope,$element:$element,$window:$window}));new gogoro.common.VideoModal},destroy:function(){$(".video",$element).css({display:"none"})}},$scope.fallback={init:function(){},destroy:function(){}},$scope.init($scope,$element)}]),angular.module("gogoro.smarterView",[]).controller("SmarterController",["$scope","$window","GATrackingService",function($scope,$window,GATrackingService){function loadingVideo(){"standard"!==gogoro.App.getState()||_loaded||($("video").each(function(i){$(this).append('<source src="'+videoSetting[i].sources[0].url+'" type="'+videoSetting[i].sources[0].type+'"></source>'),$(this).append('<source src="'+videoSetting[i].sources[1].url+'" type="'+videoSetting[i].sources[1].type+'"></source>')}),_loaded=!0)}$window.scrollTo(0,0);var gaConfig={id:"smarter"};GATrackingService.init(gaConfig),ga("send","pageview","/#/smarter"),$("body").hasClass("navigation-active")&&$(".navbar-toggle").click();new gogoro.common.ResponsiveImages;Modernizr.svg||$('img[src*="svg"]').each(function(){var $this=$(this);$this.attr("src",function(){return $this.attr("src").replace(".svg",".png")})}),videoSetting=[{sources:[{url:"//movies.gogoroapp.com/smarter-2.webm",type:"video/webm"},{url:"//movies.gogoroapp.com/smarter-2_2015-01-19.mp4",type:"video/mp4"}]},{sources:[{url:"//movies.gogoroapp.com/vm-flow-20150109.mp4",type:"video/webm"},{url:"//movies.gogoroapp.com/vm-flow_2015-01-19.mp4",type:"video/mp4"}]},{sources:[{url:"//movies.gogoroapp.com/module-smarter-auto-blinker-off.webm",type:"video/webm"},{url:"//movies.gogoroapp.com/module-smarter-auto-blinker-off_2015-01-19.mp4",type:"video/mp4"}]}];var _loaded=!1;loadingVideo(),$(window).on("resize",function(){loadingVideo()})}]);var isIE10OrLess=void 0!==document.body.style.msTouchAction||$("html.lt-ie10").length>0;isIE10OrLess||!function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require){var Browser={isDomPresent:!0,navigator:navigator,window:window,document:document,ajax:function(url){var xhr=new XMLHttpRequest;if(xhr.open("GET",url,!1),xhr.overrideMimeType&&xhr.overrideMimeType("text/plain"),xhr.setRequestHeader("If-Modified-Since","Fri, 01 Jan 1960 00:00:00 GMT"),xhr.send(null),200!==xhr.status&&0!==xhr.status)throw"XMLHttpRequest failed, status code "+xhr.status;return xhr.responseText}};window.Processing=require("./src/")(Browser)},{"./src/":27}],2:[function(require,module){module.exports={name:"Processing.js",version:"1.4.8",dependencies:{argv:"~0.0.2",browserify:"~2.18.1",express:"~3.3.3","node-minify":"~0.7.3",nunjucks:"~0.1.9",open:"0.0.3"},devDependencies:{grunt:"~0.4.1","grunt-cli":"~0.1.8","grunt-contrib-jshint":"~0.4.3"}}
},{}],3:[function(require,module){module.exports=function(obj){if(!(obj instanceof Array)){if(obj.iterator instanceof Function)return obj.iterator();throw"Unable to iterate: "+obj}var index=-1;this.hasNext=function(){return++index<obj.length},this.next=function(){return obj[index]}}},{}],4:[function(require,module){module.exports={X:0,Y:1,Z:2,R:3,G:4,B:5,A:6,U:7,V:8,NX:9,NY:10,NZ:11,EDGE:12,SR:13,SG:14,SB:15,SA:16,SW:17,TX:18,TY:19,TZ:20,VX:21,VY:22,VZ:23,VW:24,AR:25,AG:26,AB:27,DR:3,DG:4,DB:5,DA:6,SPR:28,SPG:29,SPB:30,SHINE:31,ER:32,EG:33,EB:34,BEEN_LIT:35,VERTEX_FIELD_COUNT:36,P2D:1,JAVA2D:1,WEBGL:2,P3D:2,OPENGL:2,PDF:0,DXF:0,OTHER:0,WINDOWS:1,MAXOSX:2,LINUX:3,EPSILON:1e-4,MAX_FLOAT:3.4028235e38,MIN_FLOAT:-3.4028235e38,MAX_INT:2147483647,MIN_INT:-2147483648,PI:Math.PI,TWO_PI:2*Math.PI,TAU:2*Math.PI,HALF_PI:Math.PI/2,THIRD_PI:Math.PI/3,QUARTER_PI:Math.PI/4,DEG_TO_RAD:Math.PI/180,RAD_TO_DEG:180/Math.PI,WHITESPACE:" 	\n\r\f ",RGB:1,ARGB:2,HSB:3,ALPHA:4,CMYK:5,TIFF:0,TARGA:1,JPEG:2,GIF:3,BLUR:11,GRAY:12,INVERT:13,OPAQUE:14,POSTERIZE:15,THRESHOLD:16,ERODE:17,DILATE:18,REPLACE:0,BLEND:1,ADD:2,SUBTRACT:4,LIGHTEST:8,DARKEST:16,DIFFERENCE:32,EXCLUSION:64,MULTIPLY:128,SCREEN:256,OVERLAY:512,HARD_LIGHT:1024,SOFT_LIGHT:2048,DODGE:4096,BURN:8192,ALPHA_MASK:4278190080,RED_MASK:16711680,GREEN_MASK:65280,BLUE_MASK:255,CUSTOM:0,ORTHOGRAPHIC:2,PERSPECTIVE:3,POINT:2,POINTS:2,LINE:4,LINES:4,TRIANGLE:8,TRIANGLES:9,TRIANGLE_STRIP:10,TRIANGLE_FAN:11,QUAD:16,QUADS:16,QUAD_STRIP:17,POLYGON:20,PATH:21,RECT:30,ELLIPSE:31,ARC:32,SPHERE:40,BOX:41,GROUP:0,PRIMITIVE:1,GEOMETRY:3,VERTEX:0,BEZIER_VERTEX:1,CURVE_VERTEX:2,BREAK:3,CLOSESHAPE:4,OPEN:1,CLOSE:2,CORNER:0,CORNERS:1,RADIUS:2,CENTER_RADIUS:2,CENTER:3,DIAMETER:3,CENTER_DIAMETER:3,BASELINE:0,TOP:101,BOTTOM:102,NORMAL:1,NORMALIZED:1,IMAGE:2,MODEL:4,SHAPE:5,SQUARE:"butt",ROUND:"round",PROJECT:"square",MITER:"miter",BEVEL:"bevel",AMBIENT:0,DIRECTIONAL:1,SPOT:3,BACKSPACE:8,TAB:9,ENTER:10,RETURN:13,ESC:27,DELETE:127,CODED:65535,SHIFT:16,CONTROL:17,ALT:18,CAPSLK:20,PGUP:33,PGDN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLK:144,META:157,INSERT:155,ARROW:"default",CROSS:"crosshair",HAND:"pointer",MOVE:"move",TEXT:"text",WAIT:"wait",NOCURSOR:"url('data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=='), auto",DISABLE_OPENGL_2X_SMOOTH:1,ENABLE_OPENGL_2X_SMOOTH:-1,ENABLE_OPENGL_4X_SMOOTH:2,ENABLE_NATIVE_FONTS:3,DISABLE_DEPTH_TEST:4,ENABLE_DEPTH_TEST:-4,ENABLE_DEPTH_SORT:5,DISABLE_DEPTH_SORT:-5,DISABLE_OPENGL_ERROR_REPORT:6,ENABLE_OPENGL_ERROR_REPORT:-6,ENABLE_ACCURATE_TEXTURES:7,DISABLE_ACCURATE_TEXTURES:-7,HINT_COUNT:10,SINCOS_LENGTH:720,PRECISIONB:15,PRECISIONF:32768,PREC_MAXVAL:32767,PREC_ALPHA_SHIFT:9,PREC_RED_SHIFT:1,NORMAL_MODE_AUTO:0,NORMAL_MODE_SHAPE:1,NORMAL_MODE_VERTEX:2,MAX_LIGHTS:8}},{}],5:[function(require,module){module.exports=function(options){function DefaultScope(){}function overloadBaseClassFunction(object,name,basefn){if(!object.hasOwnProperty(name)||"function"!=typeof object[name])return void(object[name]=basefn);var fn=object[name];if("$overloads"in fn)return void(fn.$defaultOverload=basefn);if("$overloads"in basefn||fn.length!==basefn.length){var overloads,defaultOverload;"$overloads"in basefn?(overloads=basefn.$overloads.slice(0),overloads[fn.length]=fn,defaultOverload=basefn.$defaultOverload):(overloads=[],overloads[basefn.length]=basefn,overloads[fn.length]=fn,defaultOverload=fn);var hubfn=function(){var fn=hubfn.$overloads[arguments.length]||("$methodArgsIndex"in hubfn&&arguments.length>hubfn.$methodArgsIndex?hubfn.$overloads[hubfn.$methodArgsIndex]:null)||hubfn.$defaultOverload;return fn.apply(this,arguments)};hubfn.$overloads=overloads,"$methodArgsIndex"in basefn&&(hubfn.$methodArgsIndex=basefn.$methodArgsIndex),hubfn.$defaultOverload=defaultOverload,hubfn.name=name,object[name]=hubfn}}function extendClass(subClass,baseClass){function extendGetterSetter(propertyName){defaultScope.defineProperty(subClass,propertyName,{get:function(){return baseClass[propertyName]},set:function(v){baseClass[propertyName]=v},enumerable:!0})}var properties=[];for(var propertyName in baseClass)"function"==typeof baseClass[propertyName]?overloadBaseClassFunction(subClass,propertyName,baseClass[propertyName]):"$"===propertyName.charAt(0)||propertyName in subClass||properties.push(propertyName);for(;properties.length>0;)extendGetterSetter(properties.shift());subClass.$super=baseClass}function isNumericalJavaType(type){return"string"!=typeof type?!1:-1!==["byte","int","char","color","float","long","double"].indexOf(type)}DefaultScope.prototype=options.PConstants;var defaultScope=new DefaultScope;return Object.keys(options).forEach(function(prop){defaultScope[prop]=options[prop]}),defaultScope.defineProperty=function(obj,name,desc){"defineProperty"in Object?Object.defineProperty(obj,name,desc):(desc.hasOwnProperty("get")&&obj.__defineGetter__(name,desc.get),desc.hasOwnProperty("set")&&obj.__defineSetter__(name,desc.set))},defaultScope.extendClassChain=function(base){for(var path=[base],self=base.$upcast;self;self=self.$upcast)extendClass(self,base),path.push(self),base=self;for(;path.length>0;)path.pop().$self=base},defaultScope.extendStaticMembers=function(derived,base){extendClass(derived,base)},defaultScope.extendInterfaceMembers=function(derived,base){extendClass(derived,base)},defaultScope.addMethod=function(object,name,fn,hasMethodArgs){var existingfn=object[name];if(existingfn||hasMethodArgs){var args=fn.length;if("$overloads"in existingfn)existingfn.$overloads[args]=fn;else{var hubfn=function(){var fn=hubfn.$overloads[arguments.length]||("$methodArgsIndex"in hubfn&&arguments.length>hubfn.$methodArgsIndex?hubfn.$overloads[hubfn.$methodArgsIndex]:null)||hubfn.$defaultOverload;return fn.apply(this,arguments)},overloads=[];existingfn&&(overloads[existingfn.length]=existingfn),overloads[args]=fn,hubfn.$overloads=overloads,hubfn.$defaultOverload=existingfn||fn,hasMethodArgs&&(hubfn.$methodArgsIndex=args),hubfn.name=name,object[name]=hubfn}}else object[name]=fn},defaultScope.createJavaArray=function(type,bounds){var result=null,defaultValue=null;if("string"==typeof type&&("boolean"===type?defaultValue=!1:isNumericalJavaType(type)&&(defaultValue=0)),"number"==typeof bounds[0]){var itemsCount=0|bounds[0];if(bounds.length<=1){result=[],result.length=itemsCount;for(var i=0;itemsCount>i;++i)result[i]=defaultValue}else{result=[];for(var newBounds=bounds.slice(1),j=0;itemsCount>j;++j)result.push(defaultScope.createJavaArray(type,newBounds))}}return result},defaultScope.defineProperty(defaultScope,"screenWidth",{get:function(){return window.innerWidth}}),defaultScope.defineProperty(defaultScope,"screenHeight",{get:function(){return window.innerHeight}}),defaultScope}},{}],6:[function(require,module){module.exports=function(Processing,options){var undef,window=options.window,document=options.document,XMLHttpRequest=window.XMLHttpRequest,noop=options.noop,isDOMPresent=options.isDOMPresent,version=options.version;Processing.version=version?version:"@DEV-VERSION@",Processing.lib={},Processing.registerLibrary=function(name,library){Processing.lib[name]=library,library.hasOwnProperty("init")&&library.init(defaultScope)},Processing.Sketch=function(attachFunction){this.attachFunction=attachFunction,this.options={pauseOnBlur:!1,globalKeyEvents:!1},this.onLoad=noop,this.onSetup=noop,this.onPause=noop,this.onLoop=noop,this.onFrameStart=noop,this.onFrameEnd=noop,this.onExit=noop,this.params={},this.imageCache={pending:0,images:{},operaCache:{},add:function(href,img){if(!this.images[href]&&(isDOMPresent||(this.images[href]=null),img||(img=new Image,img.onload=function(owner){return function(){owner.pending--}}(this),this.pending++,img.src=href),this.images[href]=img,window.opera)){var div=document.createElement("div");div.appendChild(img),div.style.position="absolute",div.style.opacity=0,div.style.width="1px",div.style.height="1px",this.operaCache[href]||(document.body.appendChild(div),this.operaCache[href]=div)}}},this.sourceCode=void 0,this.attach=function(processing){if("function"==typeof this.attachFunction)this.attachFunction(processing);else{if(!this.sourceCode)throw"Unable to attach sketch to the processing instance";var func=new Function("return ("+this.sourceCode+");")();func(processing),this.attachFunction=func}},this.toString=function(){var i,code="((function(Sketch) {\n";code+="var sketch = new Sketch(\n"+this.sourceCode+");\n";for(i in this.options)if(this.options.hasOwnProperty(i)){var value=this.options[i];code+="sketch.options."+i+" = "+("string"==typeof value?'"'+value+'"':""+value)+";\n"}for(i in this.imageCache)this.options.hasOwnProperty(i)&&(code+='sketch.imageCache.add("'+i+'");\n');return code+="return sketch;\n})(Processing.Sketch))"}};var loadSketchFromSources=Processing.loadSketchFromSources=function(canvas,sources){function ajaxAsync(url,callback){var xhr=new XMLHttpRequest;xhr.onreadystatechange=function(){if(4===xhr.readyState){var error;200!==xhr.status&&0!==xhr.status?error="Invalid XHR status "+xhr.status:""===xhr.responseText&&(error="withCredentials"in new XMLHttpRequest&&(new XMLHttpRequest).withCredentials===!1&&"file:"===window.location.protocol?"XMLHttpRequest failure, possibly due to a same-origin policy violation. You can try loading this page in another browser, or load it from http://localhost using a local webserver. See the Processing.js README for a more detailed explanation of this problem and solutions.":"File is empty."),callback(xhr.responseText,error)}},xhr.open("GET",url,!0),xhr.overrideMimeType&&xhr.overrideMimeType("application/json"),xhr.setRequestHeader("If-Modified-Since","Fri, 01 Jan 1960 00:00:00 GMT"),xhr.send(null)}function loadBlock(index,filename){function callback(block,error){if(code[index]=block,++loaded,error&&errors.push(filename+" ==> "+error),loaded===sourcesCount){if(0!==errors.length)throw"Processing.js: Unable to load pjs sketch files: "+errors.join("\n");try{return new Processing(canvas,code.join("\n"))}catch(e){throw e}}}if("#"===filename.charAt(0)){var scriptElement=document.getElementById(filename.substring(1));return void(scriptElement?callback(scriptElement.text||scriptElement.textContent):callback("","Unable to load pjs sketch: element with id '"+filename.substring(1)+"' was not found"))}ajaxAsync(filename,callback)}for(var code=[],errors=[],sourcesCount=sources.length,loaded=0,i=0;sourcesCount>i;++i)loadBlock(i,sources[i])},init=function(){document.removeEventListener("DOMContentLoaded",init,!1),processingInstances=[],Processing.instances=processingInstances;for(var filenames,canvas=document.getElementsByTagName("canvas"),i=0,l=canvas.length;l>i;i++){var processingSources=canvas[i].getAttribute("data-processing-sources");if(null===processingSources&&(processingSources=canvas[i].getAttribute("data-src"),null===processingSources&&(processingSources=canvas[i].getAttribute("datasrc"))),processingSources){filenames=processingSources.split(/\s+/g);for(var j=0;j<filenames.length;)filenames[j]?j++:filenames.splice(j,1);loadSketchFromSources(canvas[i],filenames)}}var s,last,source,instance,nodelist=document.getElementsByTagName("script"),scripts=[];for(s=nodelist.length-1;s>=0;s--)scripts.push(nodelist[s]);for(s=0,last=scripts.length;last>s;s++){var script=scripts[s];if(script.getAttribute){var type=script.getAttribute("type");if(type&&("text/processing"===type.toLowerCase()||"application/processing"===type.toLowerCase())){var target=script.getAttribute("data-processing-target");if(canvas=undef,target)canvas=document.getElementById(target);else{for(var nextSibling=script.nextSibling;nextSibling&&1!==nextSibling.nodeType;)nextSibling=nextSibling.nextSibling;nextSibling&&"canvas"===nextSibling.nodeName.toLowerCase()&&(canvas=nextSibling)}if(canvas){if(script.getAttribute("src")){filenames=script.getAttribute("src").split(/\s+/),loadSketchFromSources(canvas,filenames);continue}source=script.textContent||script.text,instance=new Processing(canvas,source)}}}}};return document.addEventListener("DOMContentLoaded",init,!1),Processing.reload=function(){if(processingInstances.length>0)for(var i=processingInstances.length-1;i>=0;i--)processingInstances[i]&&processingInstances[i].exit();init()},Processing.disableInit=function(){document.removeEventListener("DOMContentLoaded",init,!1)},Processing}},{}],7:[function(require,module){module.exports=function(obj,other){return null===obj||null===other?null===obj&&null===other:"string"==typeof obj?obj===other:"object"!=typeof obj?obj===other:obj.equals instanceof Function?obj.equals(other):obj===other}},{}],8:[function(require,module){module.exports=function(obj,undef){if("string"==typeof obj){for(var hash=0,i=0;i<obj.length;++i)hash=31*hash+obj.charCodeAt(i)&4294967295;return hash}return"object"!=typeof obj?4294967295&obj:obj.hashCode instanceof Function?obj.hashCode():(obj.$id===undef&&(obj.$id=Math.floor(65536*Math.random())-32768<<16|Math.floor(65536*Math.random())),obj.$id)}},{}],9:[function(require,module){module.exports=function(options){function Iterator(array){var index=-1;this.hasNext=function(){return index+1<array.length},this.next=function(){return array[++index]},this.remove=function(){array.splice(index--,1)}}function ArrayList(a){var array=[];a&&a.toArray&&(array=a.toArray()),this.get=function(i){return array[i]},this.contains=function(item){return this.indexOf(item)>-1},this.indexOf=function(item){for(var i=0,len=array.length;len>i;++i)if(virtEquals(item,array[i]))return i;return-1},this.lastIndexOf=function(item){for(var i=array.length-1;i>=0;--i)if(virtEquals(item,array[i]))return i;return-1},this.add=function(){if(1===arguments.length)array.push(arguments[0]);else{if(2!==arguments.length)throw"Please use the proper number of parameters.";var arg0=arguments[0];if("number"!=typeof arg0)throw typeof arg0+" is not a number";if(!(arg0>=0&&arg0<=array.length))throw arg0+" is not a valid index";array.splice(arg0,0,arguments[1])}},this.addAll=function(arg1,arg2){var it;if("number"==typeof arg1){if(0>arg1||arg1>array.length)throw"Index out of bounds for addAll: "+arg1+" greater or equal than "+array.length;for(it=new ObjectIterator(arg2);it.hasNext();)array.splice(arg1++,0,it.next())}else for(it=new ObjectIterator(arg1);it.hasNext();)array.push(it.next())},this.set=function(){if(2!==arguments.length)throw"Please use the proper number of parameters.";var arg0=arguments[0];if("number"!=typeof arg0)throw typeof arg0+" is not a number";if(!(arg0>=0&&arg0<array.length))throw arg0+" is not a valid index.";array.splice(arg0,1,arguments[1])},this.size=function(){return array.length},this.clear=function(){array.length=0},this.remove=function(item){return"number"==typeof item?array.splice(item,1)[0]:(item=this.indexOf(item),item>-1?(array.splice(item,1),!0):!1)},this.removeAll=function(c){var i,x,item,newList=new ArrayList;for(newList.addAll(this),this.clear(),i=0,x=0;i<newList.size();i++)item=newList.get(i),c.contains(item)||this.add(x++,item);return this.size()<newList.size()?!0:!1},this.isEmpty=function(){return!array.length},this.clone=function(){return new ArrayList(this)},this.toArray=function(){return array.slice(0)},this.iterator=function(){return new Iterator(array)}}var virtEquals=(options.virtHashCode,options.virtEquals);return ArrayList}},{}],10:[function(require,module){module.exports=function(charMap,undef){var Char=function(chr){return this.code="string"==typeof chr&&1===chr.length?chr.charCodeAt(0):"number"==typeof chr?chr:chr instanceof Char?chr:0/0,charMap[this.code]===undef?charMap[this.code]=this:charMap[this.code]};return Char.prototype.toString=function(){return String.fromCharCode(this.code)},Char.prototype.valueOf=function(){return this.code},Char}({})},{}],11:[function(require,module){module.exports=function(options){function HashMap(){function getBucketIndex(key){var index=virtHashCode(key)%buckets.length;return 0>index?buckets.length+index:index}function ensureLoad(){if(!(count<=loadFactor*buckets.length)){for(var allEntries=[],i=0;i<buckets.length;++i)void 0!==buckets[i]&&(allEntries=allEntries.concat(buckets[i]));var newBucketsLength=2*buckets.length;buckets=[],buckets.length=newBucketsLength;for(var j=0;j<allEntries.length;++j){var index=getBucketIndex(allEntries[j].key),bucket=buckets[index];void 0===bucket&&(buckets[index]=bucket=[]),bucket.push(allEntries[j])}}}function Iterator(conversion,removeItem){function findNext(){for(;!endOfBuckets;)if(++itemIndex,bucketIndex>=buckets.length)endOfBuckets=!0;else{if(!(void 0===buckets[bucketIndex]||itemIndex>=buckets[bucketIndex].length))return;itemIndex=-1,++bucketIndex}}var currentItem,bucketIndex=0,itemIndex=-1,endOfBuckets=!1;this.hasNext=function(){return!endOfBuckets},this.next=function(){return currentItem=conversion(buckets[bucketIndex][itemIndex]),findNext(),currentItem},this.remove=function(){void 0!==currentItem&&(removeItem(currentItem),--itemIndex,findNext())},findNext()}function Set(conversion,isIn,removeItem){this.clear=function(){hashMap.clear()},this.contains=function(o){return isIn(o)},this.containsAll=function(o){for(var it=o.iterator();it.hasNext();)if(!this.contains(it.next()))return!1;return!0},this.isEmpty=function(){return hashMap.isEmpty()},this.iterator=function(){return new Iterator(conversion,removeItem)},this.remove=function(o){return this.contains(o)?(removeItem(o),!0):!1},this.removeAll=function(c){for(var it=c.iterator(),changed=!1;it.hasNext();){var item=it.next();this.contains(item)&&(removeItem(item),changed=!0)}return!0},this.retainAll=function(c){for(var it=this.iterator(),toRemove=[];it.hasNext();){var entry=it.next();c.contains(entry)||toRemove.push(entry)}for(var i=0;i<toRemove.length;++i)removeItem(toRemove[i]);return toRemove.length>0},this.size=function(){return hashMap.size()},this.toArray=function(){for(var result=[],it=this.iterator();it.hasNext();)result.push(it.next());return result}}function Entry(pair){this._isIn=function(map){return map===hashMap&&void 0===pair.removed},this.equals=function(o){return virtEquals(pair.key,o.getKey())},this.getKey=function(){return pair.key},this.getValue=function(){return pair.value},this.hashCode=function(){return virtHashCode(pair.key)},this.setValue=function(value){var old=pair.value;return pair.value=value,old}}if(1===arguments.length&&arguments[0]instanceof HashMap)return arguments[0].clone();var initialCapacity=arguments.length>0?arguments[0]:16,loadFactor=arguments.length>1?arguments[1]:.75,buckets=[];buckets.length=initialCapacity;var count=0,hashMap=this;this.clear=function(){count=0,buckets=[],buckets.length=initialCapacity},this.clone=function(){var map=new HashMap;return map.putAll(this),map},this.containsKey=function(key){var index=getBucketIndex(key),bucket=buckets[index];if(void 0===bucket)return!1;for(var i=0;i<bucket.length;++i)if(virtEquals(bucket[i].key,key))return!0;return!1},this.containsValue=function(value){for(var i=0;i<buckets.length;++i){var bucket=buckets[i];if(void 0!==bucket)for(var j=0;j<bucket.length;++j)if(virtEquals(bucket[j].value,value))return!0}return!1},this.entrySet=function(){return new Set(function(pair){return new Entry(pair)},function(pair){return pair instanceof Entry&&pair._isIn(hashMap)},function(pair){return hashMap.remove(pair.getKey())})},this.get=function(key){var index=getBucketIndex(key),bucket=buckets[index];if(void 0===bucket)return null;for(var i=0;i<bucket.length;++i)if(virtEquals(bucket[i].key,key))return bucket[i].value;return null},this.isEmpty=function(){return 0===count},this.keySet=function(){return new Set(function(pair){return pair.key},function(key){return hashMap.containsKey(key)},function(key){return hashMap.remove(key)})},this.values=function(){return new Set(function(pair){return pair.value},function(value){return hashMap.containsValue(value)},function(value){return hashMap.removeByValue(value)})},this.put=function(key,value){var index=getBucketIndex(key),bucket=buckets[index];if(void 0===bucket)return++count,buckets[index]=[{key:key,value:value}],ensureLoad(),null;for(var i=0;i<bucket.length;++i)if(virtEquals(bucket[i].key,key)){var previous=bucket[i].value;return bucket[i].value=value,previous}return++count,bucket.push({key:key,value:value}),ensureLoad(),null},this.putAll=function(m){for(var it=m.entrySet().iterator();it.hasNext();){var entry=it.next();this.put(entry.getKey(),entry.getValue())}},this.remove=function(key){var index=getBucketIndex(key),bucket=buckets[index];if(void 0===bucket)return null;for(var i=0;i<bucket.length;++i)if(virtEquals(bucket[i].key,key)){--count;var previous=bucket[i].value;return bucket[i].removed=!0,bucket.length>1?bucket.splice(i,1):buckets[index]=void 0,previous}return null},this.removeByValue=function(value){var bucket,i,ilen,pair;for(bucket in buckets)if(buckets.hasOwnProperty(bucket))for(i=0,ilen=buckets[bucket].length;ilen>i;i++)if(pair=buckets[bucket][i],pair.value===value)return buckets[bucket].splice(i,1),!0;return!1},this.size=function(){return count}}var virtHashCode=options.virtHashCode,virtEquals=options.virtEquals;return HashMap}},{}],12:[function(require,module){module.exports=function(options,undef){function computeFontMetrics(pfont){var emQuad=250,correctionFactor=pfont.size/emQuad,canvas=document.createElement("canvas");canvas.width=2*emQuad,canvas.height=2*emQuad,canvas.style.opacity=0;var cfmFont=pfont.getCSSDefinition(emQuad+"px","normal"),ctx=canvas.getContext("2d");ctx.font=cfmFont;var protrusions="dbflkhyjqpg";canvas.width=ctx.measureText(protrusions).width,ctx.font=cfmFont;var leadDiv=document.createElement("div");leadDiv.style.position="absolute",leadDiv.style.opacity=0,leadDiv.style.fontFamily='"'+pfont.name+'"',leadDiv.style.fontSize=emQuad+"px",leadDiv.innerHTML=protrusions+"<br/>"+protrusions,document.body.appendChild(leadDiv);var w=canvas.width,h=canvas.height,baseline=h/2;ctx.fillStyle="white",ctx.fillRect(0,0,w,h),ctx.fillStyle="black",ctx.fillText(protrusions,0,baseline);for(var pixelData=ctx.getImageData(0,0,w,h).data,i=0,w4=4*w,len=pixelData.length;++i<len&&255===pixelData[i];)noop();var ascent=Math.round(i/w4);for(i=len-1;--i>0&&255===pixelData[i];)noop();var descent=Math.round(i/w4);if(pfont.ascent=correctionFactor*(baseline-ascent),pfont.descent=correctionFactor*(descent-baseline),document.defaultView.getComputedStyle){var leadDivHeight=document.defaultView.getComputedStyle(leadDiv,null).getPropertyValue("height");leadDivHeight=correctionFactor*leadDivHeight.replace("px",""),leadDivHeight>=2*pfont.size&&(pfont.leading=Math.round(leadDivHeight/2))}return document.body.removeChild(leadDiv),pfont.caching?ctx:void 0}function PFont(name,size){name===undef&&(name=""),this.name=name,size===undef&&(size=0),this.size=size,this.glyph=!1,this.ascent=0,this.descent=0,this.leading=1.2*size;var illegalIndicator=name.indexOf(" Italic Bold");-1!==illegalIndicator&&(name=name.substring(0,illegalIndicator)),this.style="normal";var italicsIndicator=name.indexOf(" Italic");-1!==italicsIndicator&&(name=name.substring(0,italicsIndicator),this.style="italic"),this.weight="normal";var boldIndicator=name.indexOf(" Bold");if(-1!==boldIndicator&&(name=name.substring(0,boldIndicator),this.weight="bold"),this.family="sans-serif",name!==undef)switch(name){case"sans-serif":case"serif":case"monospace":case"fantasy":case"cursive":this.family=name;break;default:this.family='"'+name+'", sans-serif'}this.context2d=computeFontMetrics(this),this.css=this.getCSSDefinition(),this.context2d&&(this.context2d.font=this.css)}var document=(options.Browser.window,options.Browser.document),noop=options.noop;return PFont.prototype.caching=!0,PFont.prototype.getCSSDefinition=function(fontSize,lineHeight){fontSize===undef&&(fontSize=this.size+"px"),lineHeight===undef&&(lineHeight=this.leading+"px");var components=[this.style,"normal",this.weight,fontSize+"/"+lineHeight,this.family];return components.join(" ")},PFont.prototype.measureTextWidth=function(string){return this.context2d.measureText(string).width},PFont.prototype.measureTextWidthFallback=function(string){var canvas=document.createElement("canvas"),ctx=canvas.getContext("2d");return ctx.font=this.css,ctx.measureText(string).width},PFont.PFontCache={length:0},PFont.get=function(fontName,fontSize){fontSize=(10*fontSize+.5|0)/10;var cache=PFont.PFontCache,idx=fontName+"/"+fontSize;if(!cache[idx]){if(cache[idx]=new PFont(fontName,fontSize),cache.length++,50===cache.length){PFont.prototype.measureTextWidth=PFont.prototype.measureTextWidthFallback,PFont.prototype.caching=!1;var entry;for(entry in cache)"length"!==entry&&(cache[entry].context2d=null);return new PFont(fontName,fontSize)}if(400===cache.length)return PFont.PFontCache={},PFont.get=PFont.getFallback,new PFont(fontName,fontSize)}return cache[idx]},PFont.getFallback=function(fontName,fontSize){return new PFont(fontName,fontSize)},PFont.list=function(){return["sans-serif","serif","monospace","fantasy","cursive"]},PFont.preloading={template:{},initialized:!1,initialize:function(){var generateTinyFont=function(){var encoded="#E3KAI2wAgT1MvMg7Eo3VmNtYX7ABi3CxnbHlm7Abw3kaGVhZ7ACs3OGhoZWE7A53CRobXR47AY3AGbG9jYQ7G03Bm1heH7ABC3CBuYW1l7Ae3AgcG9zd7AI3AE#B3AQ2kgTY18PPPUACwAg3ALSRoo3#yld0xg32QAB77#E777773B#E3C#I#Q77773E#Q7777777772CMAIw7AB77732B#M#Q3wAB#g3B#E#E2BB//82BB////w#B7#gAEg3E77x2B32B#E#Q#MTcBAQ32gAe#M#QQJ#E32M#QQJ#I#g32Q77#",expand=function(input){return"AAAAAAAA".substr(~~input?7-input:6)};return encoded.replace(/[#237]/g,expand)},fontface=document.createElement("style");fontface.setAttribute("type","text/css"),fontface.innerHTML='@font-face {\n  font-family: "PjsEmptyFont";\n  src: url(\'data:application/x-font-ttf;base64,'+generateTinyFont()+"')\n       format('truetype');\n}",document.head.appendChild(fontface);var element=document.createElement("span");element.style.cssText='position: absolute; top: 0; left: 0; opacity: 0; font-family: "PjsEmptyFont", fantasy;',element.innerHTML="AAAAAAAA",document.body.appendChild(element),this.template=element,this.initialized=!0},getElementWidth:function(element){return document.defaultView.getComputedStyle(element,"").getPropertyValue("width")},timeAttempted:0,pending:function(intervallength){this.initialized||this.initialize();for(var element,computedWidthFont,computedWidthRef=this.getElementWidth(this.template),i=0;i<this.fontList.length;i++){if(element=this.fontList[i],computedWidthFont=this.getElementWidth(element),this.timeAttempted<4e3&&computedWidthFont===computedWidthRef)return this.timeAttempted+=intervallength,!0;document.body.removeChild(element),this.fontList.splice(i--,1),this.timeAttempted=0}return 0===this.fontList.length?!1:!0},fontList:[],addedList:{},add:function(fontSrc){this.initialized||this.initialize();var fontName="object"==typeof fontSrc?fontSrc.fontFace:fontSrc,fontUrl="object"==typeof fontSrc?fontSrc.url:fontSrc;if(!this.addedList[fontName]){var style=document.createElement("style");style.setAttribute("type","text/css"),style.innerHTML="@font-face{\n  font-family: '"+fontName+"';\n  src:  url('"+fontUrl+"');\n}\n",document.head.appendChild(style),this.addedList[fontName]=!0;var element=document.createElement("span");element.style.cssText="position: absolute; top: 0; left: 0; opacity: 0;",element.style.fontFamily='"'+fontName+'", "PjsEmptyFont", fantasy',element.innerHTML="AAAAAAAA",document.body.appendChild(element),this.fontList.push(element)}}},PFont}},{}],13:[function(require,module){module.exports=function(options){var p=options.p,PMatrix2D=function(){0===arguments.length?this.reset():1===arguments.length&&arguments[0]instanceof PMatrix2D?this.set(arguments[0].array()):6===arguments.length&&this.set(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5])};return PMatrix2D.prototype={set:function(){if(6===arguments.length){var a=arguments;this.set([a[0],a[1],a[2],a[3],a[4],a[5]])}else 1===arguments.length&&arguments[0]instanceof PMatrix2D?this.elements=arguments[0].array():1===arguments.length&&arguments[0]instanceof Array&&(this.elements=arguments[0].slice())},get:function(){var outgoing=new PMatrix2D;return outgoing.set(this.elements),outgoing},reset:function(){this.set([1,0,0,0,1,0])},array:function(){return this.elements.slice()},translate:function(tx,ty){this.elements[2]=tx*this.elements[0]+ty*this.elements[1]+this.elements[2],this.elements[5]=tx*this.elements[3]+ty*this.elements[4]+this.elements[5]},invTranslate:function(tx,ty){this.translate(-tx,-ty)},transpose:function(){},mult:function(source,target){var x,y;return source instanceof PVector?(x=source.x,y=source.y,target||(target=new PVector)):source instanceof Array&&(x=source[0],y=source[1],target||(target=[])),target instanceof Array?(target[0]=this.elements[0]*x+this.elements[1]*y+this.elements[2],target[1]=this.elements[3]*x+this.elements[4]*y+this.elements[5]):target instanceof PVector&&(target.x=this.elements[0]*x+this.elements[1]*y+this.elements[2],target.y=this.elements[3]*x+this.elements[4]*y+this.elements[5],target.z=0),target},multX:function(x,y){return x*this.elements[0]+y*this.elements[1]+this.elements[2]},multY:function(x,y){return x*this.elements[3]+y*this.elements[4]+this.elements[5]},skewX:function(angle){this.apply(1,0,1,angle,0,0)},skewY:function(angle){this.apply(1,0,1,0,angle,0)},shearX:function(angle){this.apply(1,0,1,Math.tan(angle),0,0)},shearY:function(angle){this.apply(1,0,1,0,Math.tan(angle),0)},determinant:function(){return this.elements[0]*this.elements[4]-this.elements[1]*this.elements[3]},invert:function(){var d=this.determinant();if(Math.abs(d)>PConstants.MIN_INT){var old00=this.elements[0],old01=this.elements[1],old02=this.elements[2],old10=this.elements[3],old11=this.elements[4],old12=this.elements[5];return this.elements[0]=old11/d,this.elements[3]=-old10/d,this.elements[1]=-old01/d,this.elements[4]=old00/d,this.elements[2]=(old01*old12-old11*old02)/d,this.elements[5]=(old10*old02-old00*old12)/d,!0}return!1},scale:function(sx,sy){sx&&!sy&&(sy=sx),sx&&sy&&(this.elements[0]*=sx,this.elements[1]*=sy,this.elements[3]*=sx,this.elements[4]*=sy)},invScale:function(sx,sy){sx&&!sy&&(sy=sx),this.scale(1/sx,1/sy)},apply:function(){var source;1===arguments.length&&arguments[0]instanceof PMatrix2D?source=arguments[0].array():6===arguments.length?source=Array.prototype.slice.call(arguments):1===arguments.length&&arguments[0]instanceof Array&&(source=arguments[0]);for(var result=[0,0,this.elements[2],0,0,this.elements[5]],e=0,row=0;2>row;row++)for(var col=0;3>col;col++,e++)result[e]+=this.elements[3*row+0]*source[col+0]+this.elements[3*row+1]*source[col+3];this.elements=result.slice()},preApply:function(){var source;1===arguments.length&&arguments[0]instanceof PMatrix2D?source=arguments[0].array():6===arguments.length?source=Array.prototype.slice.call(arguments):1===arguments.length&&arguments[0]instanceof Array&&(source=arguments[0]);var result=[0,0,source[2],0,0,source[5]];result[2]=source[2]+this.elements[2]*source[0]+this.elements[5]*source[1],result[5]=source[5]+this.elements[2]*source[3]+this.elements[5]*source[4],result[0]=this.elements[0]*source[0]+this.elements[3]*source[1],result[3]=this.elements[0]*source[3]+this.elements[3]*source[4],result[1]=this.elements[1]*source[0]+this.elements[4]*source[1],result[4]=this.elements[1]*source[3]+this.elements[4]*source[4],this.elements=result.slice()},rotate:function(angle){var c=Math.cos(angle),s=Math.sin(angle),temp1=this.elements[0],temp2=this.elements[1];this.elements[0]=c*temp1+s*temp2,this.elements[1]=-s*temp1+c*temp2,temp1=this.elements[3],temp2=this.elements[4],this.elements[3]=c*temp1+s*temp2,this.elements[4]=-s*temp1+c*temp2},rotateZ:function(angle){this.rotate(angle)},invRotateZ:function(angle){this.rotateZ(angle-Math.PI)},print:function(){var digits=printMatrixHelper(this.elements),output=""+p.nfs(this.elements[0],digits,4)+" "+p.nfs(this.elements[1],digits,4)+" "+p.nfs(this.elements[2],digits,4)+"\n"+p.nfs(this.elements[3],digits,4)+" "+p.nfs(this.elements[4],digits,4)+" "+p.nfs(this.elements[5],digits,4)+"\n\n";
p.println(output)}},PMatrix2D}},{}],14:[function(require,module){module.exports=function(options,undef){var p=options.p,PMatrix3D=function(){this.reset()};return PMatrix3D.prototype={set:function(){16===arguments.length?this.elements=Array.prototype.slice.call(arguments):1===arguments.length&&arguments[0]instanceof PMatrix3D?this.elements=arguments[0].array():1===arguments.length&&arguments[0]instanceof Array&&(this.elements=arguments[0].slice())},get:function(){var outgoing=new PMatrix3D;return outgoing.set(this.elements),outgoing},reset:function(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},array:function(){return this.elements.slice()},translate:function(tx,ty,tz){tz===undef&&(tz=0),this.elements[3]+=tx*this.elements[0]+ty*this.elements[1]+tz*this.elements[2],this.elements[7]+=tx*this.elements[4]+ty*this.elements[5]+tz*this.elements[6],this.elements[11]+=tx*this.elements[8]+ty*this.elements[9]+tz*this.elements[10],this.elements[15]+=tx*this.elements[12]+ty*this.elements[13]+tz*this.elements[14]},transpose:function(){var temp=this.elements[4];this.elements[4]=this.elements[1],this.elements[1]=temp,temp=this.elements[8],this.elements[8]=this.elements[2],this.elements[2]=temp,temp=this.elements[6],this.elements[6]=this.elements[9],this.elements[9]=temp,temp=this.elements[3],this.elements[3]=this.elements[12],this.elements[12]=temp,temp=this.elements[7],this.elements[7]=this.elements[13],this.elements[13]=temp,temp=this.elements[11],this.elements[11]=this.elements[14],this.elements[14]=temp},mult:function(source,target){var x,y,z,w;return source instanceof PVector?(x=source.x,y=source.y,z=source.z,w=1,target||(target=new PVector)):source instanceof Array&&(x=source[0],y=source[1],z=source[2],w=source[3]||1,(!target||3!==target.length&&4!==target.length)&&(target=[0,0,0])),target instanceof Array&&(3===target.length?(target[0]=this.elements[0]*x+this.elements[1]*y+this.elements[2]*z+this.elements[3],target[1]=this.elements[4]*x+this.elements[5]*y+this.elements[6]*z+this.elements[7],target[2]=this.elements[8]*x+this.elements[9]*y+this.elements[10]*z+this.elements[11]):4===target.length&&(target[0]=this.elements[0]*x+this.elements[1]*y+this.elements[2]*z+this.elements[3]*w,target[1]=this.elements[4]*x+this.elements[5]*y+this.elements[6]*z+this.elements[7]*w,target[2]=this.elements[8]*x+this.elements[9]*y+this.elements[10]*z+this.elements[11]*w,target[3]=this.elements[12]*x+this.elements[13]*y+this.elements[14]*z+this.elements[15]*w)),target instanceof PVector&&(target.x=this.elements[0]*x+this.elements[1]*y+this.elements[2]*z+this.elements[3],target.y=this.elements[4]*x+this.elements[5]*y+this.elements[6]*z+this.elements[7],target.z=this.elements[8]*x+this.elements[9]*y+this.elements[10]*z+this.elements[11]),target},preApply:function(){var source;1===arguments.length&&arguments[0]instanceof PMatrix3D?source=arguments[0].array():16===arguments.length?source=Array.prototype.slice.call(arguments):1===arguments.length&&arguments[0]instanceof Array&&(source=arguments[0]);for(var result=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e=0,row=0;4>row;row++)for(var col=0;4>col;col++,e++)result[e]+=this.elements[col+0]*source[4*row+0]+this.elements[col+4]*source[4*row+1]+this.elements[col+8]*source[4*row+2]+this.elements[col+12]*source[4*row+3];this.elements=result.slice()},apply:function(){var source;1===arguments.length&&arguments[0]instanceof PMatrix3D?source=arguments[0].array():16===arguments.length?source=Array.prototype.slice.call(arguments):1===arguments.length&&arguments[0]instanceof Array&&(source=arguments[0]);for(var result=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e=0,row=0;4>row;row++)for(var col=0;4>col;col++,e++)result[e]+=this.elements[4*row+0]*source[col+0]+this.elements[4*row+1]*source[col+4]+this.elements[4*row+2]*source[col+8]+this.elements[4*row+3]*source[col+12];this.elements=result.slice()},rotate:function(angle,v0,v1,v2){if(v1){var c=Math.cos(angle),s=Math.sin(angle),t=1-c;this.apply(t*v0*v0+c,t*v0*v1-s*v2,t*v0*v2+s*v1,0,t*v0*v1+s*v2,t*v1*v1+c,t*v1*v2-s*v0,0,t*v0*v2-s*v1,t*v1*v2+s*v0,t*v2*v2+c,0,0,0,0,1)}else this.rotateZ(angle)},invApply:function(){inverseCopy===undef&&(inverseCopy=new PMatrix3D);var a=arguments;return inverseCopy.set(a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8],a[9],a[10],a[11],a[12],a[13],a[14],a[15]),inverseCopy.invert()?(this.preApply(inverseCopy),!0):!1},rotateX:function(angle){var c=Math.cos(angle),s=Math.sin(angle);this.apply([1,0,0,0,0,c,-s,0,0,s,c,0,0,0,0,1])},rotateY:function(angle){var c=Math.cos(angle),s=Math.sin(angle);this.apply([c,0,s,0,0,1,0,0,-s,0,c,0,0,0,0,1])},rotateZ:function(angle){var c=Math.cos(angle),s=Math.sin(angle);this.apply([c,-s,0,0,s,c,0,0,0,0,1,0,0,0,0,1])},scale:function(sx,sy,sz){!sx||sy||sz?sx&&sy&&!sz&&(sz=1):sy=sz=sx,sx&&sy&&sz&&(this.elements[0]*=sx,this.elements[1]*=sy,this.elements[2]*=sz,this.elements[4]*=sx,this.elements[5]*=sy,this.elements[6]*=sz,this.elements[8]*=sx,this.elements[9]*=sy,this.elements[10]*=sz,this.elements[12]*=sx,this.elements[13]*=sy,this.elements[14]*=sz)},skewX:function(angle){var t=Math.tan(angle);this.apply(1,t,0,0,0,1,0,0,0,0,1,0,0,0,0,1)},skewY:function(angle){var t=Math.tan(angle);this.apply(1,0,0,0,t,1,0,0,0,0,1,0,0,0,0,1)},shearX:function(angle){var t=Math.tan(angle);this.apply(1,t,0,0,0,1,0,0,0,0,1,0,0,0,0,1)},shearY:function(angle){var t=Math.tan(angle);this.apply(1,0,0,0,t,1,0,0,0,0,1,0,0,0,0,1)},multX:function(x,y,z,w){return z?w?this.elements[0]*x+this.elements[1]*y+this.elements[2]*z+this.elements[3]*w:this.elements[0]*x+this.elements[1]*y+this.elements[2]*z+this.elements[3]:this.elements[0]*x+this.elements[1]*y+this.elements[3]},multY:function(x,y,z,w){return z?w?this.elements[4]*x+this.elements[5]*y+this.elements[6]*z+this.elements[7]*w:this.elements[4]*x+this.elements[5]*y+this.elements[6]*z+this.elements[7]:this.elements[4]*x+this.elements[5]*y+this.elements[7]},multZ:function(x,y,z,w){return w?this.elements[8]*x+this.elements[9]*y+this.elements[10]*z+this.elements[11]*w:this.elements[8]*x+this.elements[9]*y+this.elements[10]*z+this.elements[11]},multW:function(x,y,z,w){return w?this.elements[12]*x+this.elements[13]*y+this.elements[14]*z+this.elements[15]*w:this.elements[12]*x+this.elements[13]*y+this.elements[14]*z+this.elements[15]},invert:function(){var fA0=this.elements[0]*this.elements[5]-this.elements[1]*this.elements[4],fA1=this.elements[0]*this.elements[6]-this.elements[2]*this.elements[4],fA2=this.elements[0]*this.elements[7]-this.elements[3]*this.elements[4],fA3=this.elements[1]*this.elements[6]-this.elements[2]*this.elements[5],fA4=this.elements[1]*this.elements[7]-this.elements[3]*this.elements[5],fA5=this.elements[2]*this.elements[7]-this.elements[3]*this.elements[6],fB0=this.elements[8]*this.elements[13]-this.elements[9]*this.elements[12],fB1=this.elements[8]*this.elements[14]-this.elements[10]*this.elements[12],fB2=this.elements[8]*this.elements[15]-this.elements[11]*this.elements[12],fB3=this.elements[9]*this.elements[14]-this.elements[10]*this.elements[13],fB4=this.elements[9]*this.elements[15]-this.elements[11]*this.elements[13],fB5=this.elements[10]*this.elements[15]-this.elements[11]*this.elements[14],fDet=fA0*fB5-fA1*fB4+fA2*fB3+fA3*fB2-fA4*fB1+fA5*fB0;if(Math.abs(fDet)<=1e-9)return!1;var kInv=[];kInv[0]=+this.elements[5]*fB5-this.elements[6]*fB4+this.elements[7]*fB3,kInv[4]=-this.elements[4]*fB5+this.elements[6]*fB2-this.elements[7]*fB1,kInv[8]=+this.elements[4]*fB4-this.elements[5]*fB2+this.elements[7]*fB0,kInv[12]=-this.elements[4]*fB3+this.elements[5]*fB1-this.elements[6]*fB0,kInv[1]=-this.elements[1]*fB5+this.elements[2]*fB4-this.elements[3]*fB3,kInv[5]=+this.elements[0]*fB5-this.elements[2]*fB2+this.elements[3]*fB1,kInv[9]=-this.elements[0]*fB4+this.elements[1]*fB2-this.elements[3]*fB0,kInv[13]=+this.elements[0]*fB3-this.elements[1]*fB1+this.elements[2]*fB0,kInv[2]=+this.elements[13]*fA5-this.elements[14]*fA4+this.elements[15]*fA3,kInv[6]=-this.elements[12]*fA5+this.elements[14]*fA2-this.elements[15]*fA1,kInv[10]=+this.elements[12]*fA4-this.elements[13]*fA2+this.elements[15]*fA0,kInv[14]=-this.elements[12]*fA3+this.elements[13]*fA1-this.elements[14]*fA0,kInv[3]=-this.elements[9]*fA5+this.elements[10]*fA4-this.elements[11]*fA3,kInv[7]=+this.elements[8]*fA5-this.elements[10]*fA2+this.elements[11]*fA1,kInv[11]=-this.elements[8]*fA4+this.elements[9]*fA2-this.elements[11]*fA0,kInv[15]=+this.elements[8]*fA3-this.elements[9]*fA1+this.elements[10]*fA0;var fInvDet=1/fDet;return kInv[0]*=fInvDet,kInv[1]*=fInvDet,kInv[2]*=fInvDet,kInv[3]*=fInvDet,kInv[4]*=fInvDet,kInv[5]*=fInvDet,kInv[6]*=fInvDet,kInv[7]*=fInvDet,kInv[8]*=fInvDet,kInv[9]*=fInvDet,kInv[10]*=fInvDet,kInv[11]*=fInvDet,kInv[12]*=fInvDet,kInv[13]*=fInvDet,kInv[14]*=fInvDet,kInv[15]*=fInvDet,this.elements=kInv.slice(),!0},toString:function(){for(var str="",i=0;15>i;i++)str+=this.elements[i]+", ";return str+=this.elements[15]},print:function(){var digits=printMatrixHelper(this.elements),output=""+p.nfs(this.elements[0],digits,4)+" "+p.nfs(this.elements[1],digits,4)+" "+p.nfs(this.elements[2],digits,4)+" "+p.nfs(this.elements[3],digits,4)+"\n"+p.nfs(this.elements[4],digits,4)+" "+p.nfs(this.elements[5],digits,4)+" "+p.nfs(this.elements[6],digits,4)+" "+p.nfs(this.elements[7],digits,4)+"\n"+p.nfs(this.elements[8],digits,4)+" "+p.nfs(this.elements[9],digits,4)+" "+p.nfs(this.elements[10],digits,4)+" "+p.nfs(this.elements[11],digits,4)+"\n"+p.nfs(this.elements[12],digits,4)+" "+p.nfs(this.elements[13],digits,4)+" "+p.nfs(this.elements[14],digits,4)+" "+p.nfs(this.elements[15],digits,4)+"\n\n";p.println(output)},invTranslate:function(tx,ty,tz){this.preApply(1,0,0,-tx,0,1,0,-ty,0,0,1,-tz,0,0,0,1)},invRotateX:function(angle){var c=Math.cos(-angle),s=Math.sin(-angle);this.preApply([1,0,0,0,0,c,-s,0,0,s,c,0,0,0,0,1])},invRotateY:function(angle){var c=Math.cos(-angle),s=Math.sin(-angle);this.preApply([c,0,s,0,0,1,0,0,-s,0,c,0,0,0,0,1])},invRotateZ:function(angle){var c=Math.cos(-angle),s=Math.sin(-angle);this.preApply([c,-s,0,0,s,c,0,0,0,0,1,0,0,0,0,1])},invScale:function(x,y,z){this.preApply([1/x,0,0,0,0,1/y,0,0,0,0,1/z,0,0,0,0,1])}},PMatrix3D}},{}],15:[function(require,module){module.exports=function(options){var PConstants=options.PConstants,PMatrix2D=options.PMatrix2D,PMatrix3D=options.PMatrix3D,PShape=function(family){this.family=family||PConstants.GROUP,this.visible=!0,this.style=!0,this.children=[],this.nameTable=[],this.params=[],this.name="",this.image=null,this.matrix=null,this.kind=null,this.close=null,this.width=null,this.height=null,this.parent=null};return PShape.prototype={isVisible:function(){return this.visible},setVisible:function(visible){this.visible=visible},disableStyle:function(){this.style=!1;for(var i=0,j=this.children.length;j>i;i++)this.children[i].disableStyle()},enableStyle:function(){this.style=!0;for(var i=0,j=this.children.length;j>i;i++)this.children[i].enableStyle()},getFamily:function(){return this.family},getWidth:function(){return this.width},getHeight:function(){return this.height},setName:function(name){this.name=name},getName:function(){return this.name},draw:function(renderContext){if(!renderContext)throw"render context missing for draw() in PShape";this.visible&&(this.pre(renderContext),this.drawImpl(renderContext),this.post(renderContext))},drawImpl:function(renderContext){this.family===PConstants.GROUP?this.drawGroup(renderContext):this.family===PConstants.PRIMITIVE?this.drawPrimitive(renderContext):this.family===PConstants.GEOMETRY?this.drawGeometry(renderContext):this.family===PConstants.PATH&&this.drawPath(renderContext)},drawPath:function(renderContext){var i,j;if(0!==this.vertices.length){if(renderContext.beginShape(),0===this.vertexCodes.length)if(2===this.vertices[0].length)for(i=0,j=this.vertices.length;j>i;i++)renderContext.vertex(this.vertices[i][0],this.vertices[i][1]);else for(i=0,j=this.vertices.length;j>i;i++)renderContext.vertex(this.vertices[i][0],this.vertices[i][1],this.vertices[i][2]);else{var index=0;if(2===this.vertices[0].length)for(i=0,j=this.vertexCodes.length;j>i;i++)this.vertexCodes[i]===PConstants.VERTEX?(renderContext.vertex(this.vertices[index][0],this.vertices[index][1],this.vertices[index].moveTo),renderContext.breakShape=!1,index++):this.vertexCodes[i]===PConstants.BEZIER_VERTEX?(renderContext.bezierVertex(this.vertices[index+0][0],this.vertices[index+0][1],this.vertices[index+1][0],this.vertices[index+1][1],this.vertices[index+2][0],this.vertices[index+2][1]),index+=3):this.vertexCodes[i]===PConstants.CURVE_VERTEX?(renderContext.curveVertex(this.vertices[index][0],this.vertices[index][1]),index++):this.vertexCodes[i]===PConstants.BREAK&&(renderContext.breakShape=!0);else for(i=0,j=this.vertexCodes.length;j>i;i++)this.vertexCodes[i]===PConstants.VERTEX?(renderContext.vertex(this.vertices[index][0],this.vertices[index][1],this.vertices[index][2]),this.vertices[index].moveTo===!0?vertArray[vertArray.length-1].moveTo=!0:this.vertices[index].moveTo===!1&&(vertArray[vertArray.length-1].moveTo=!1),renderContext.breakShape=!1):this.vertexCodes[i]===PConstants.BEZIER_VERTEX?(renderContext.bezierVertex(this.vertices[index+0][0],this.vertices[index+0][1],this.vertices[index+0][2],this.vertices[index+1][0],this.vertices[index+1][1],this.vertices[index+1][2],this.vertices[index+2][0],this.vertices[index+2][1],this.vertices[index+2][2]),index+=3):this.vertexCodes[i]===PConstants.CURVE_VERTEX?(renderContext.curveVertex(this.vertices[index][0],this.vertices[index][1],this.vertices[index][2]),index++):this.vertexCodes[i]===PConstants.BREAK&&(renderContext.breakShape=!0)}renderContext.endShape(this.close?PConstants.CLOSE:PConstants.OPEN)}},drawGeometry:function(renderContext){var i,j;if(renderContext.beginShape(this.kind),this.style)for(i=0,j=this.vertices.length;j>i;i++)renderContext.vertex(this.vertices[i]);else for(i=0,j=this.vertices.length;j>i;i++){var vert=this.vertices[i];0===vert[2]?renderContext.vertex(vert[0],vert[1]):renderContext.vertex(vert[0],vert[1],vert[2])}renderContext.endShape()},drawGroup:function(renderContext){for(var i=0,j=this.children.length;j>i;i++)this.children[i].draw(renderContext)},drawPrimitive:function(renderContext){if(this.kind===PConstants.POINT)renderContext.point(this.params[0],this.params[1]);else if(this.kind===PConstants.LINE)4===this.params.length?renderContext.line(this.params[0],this.params[1],this.params[2],this.params[3]):renderContext.line(this.params[0],this.params[1],this.params[2],this.params[3],this.params[4],this.params[5]);else if(this.kind===PConstants.TRIANGLE)renderContext.triangle(this.params[0],this.params[1],this.params[2],this.params[3],this.params[4],this.params[5]);else if(this.kind===PConstants.QUAD)renderContext.quad(this.params[0],this.params[1],this.params[2],this.params[3],this.params[4],this.params[5],this.params[6],this.params[7]);else if(this.kind===PConstants.RECT)if(null!==this.image){var imMode=imageModeConvert;renderContext.imageMode(PConstants.CORNER),renderContext.image(this.image,this.params[0],this.params[1],this.params[2],this.params[3]),imageModeConvert=imMode}else{var rcMode=renderContext.curRectMode;renderContext.rectMode(PConstants.CORNER),renderContext.rect(this.params[0],this.params[1],this.params[2],this.params[3]),renderContext.curRectMode=rcMode}else if(this.kind===PConstants.ELLIPSE){var elMode=renderContext.curEllipseMode;renderContext.ellipseMode(PConstants.CORNER),renderContext.ellipse(this.params[0],this.params[1],this.params[2],this.params[3]),renderContext.curEllipseMode=elMode}else if(this.kind===PConstants.ARC){var eMode=curEllipseMode;renderContext.ellipseMode(PConstants.CORNER),renderContext.arc(this.params[0],this.params[1],this.params[2],this.params[3],this.params[4],this.params[5]),curEllipseMode=eMode}else this.kind===PConstants.BOX?1===this.params.length?renderContext.box(this.params[0]):renderContext.box(this.params[0],this.params[1],this.params[2]):this.kind===PConstants.SPHERE&&renderContext.sphere(this.params[0])},pre:function(renderContext){this.matrix&&(renderContext.pushMatrix(),renderContext.transform(this.matrix)),this.style&&(renderContext.pushStyle(),this.styles(renderContext))},post:function(renderContext){this.matrix&&renderContext.popMatrix(),this.style&&renderContext.popStyle()},styles:function(renderContext){this.stroke?(renderContext.stroke(this.strokeColor),renderContext.strokeWeight(this.strokeWeight),renderContext.strokeCap(this.strokeCap),renderContext.strokeJoin(this.strokeJoin)):renderContext.noStroke(),this.fill?renderContext.fill(this.fillColor):renderContext.noFill()},getChild:function(child){var i,j;if("number"==typeof child)return this.children[child];var found;if(""===child||this.name===child)return this;if(this.nameTable.length>0){for(i=0,j=this.nameTable.length;j>i||found;i++)if(this.nameTable[i].getName===child){found=this.nameTable[i];break}if(found)return found}for(i=0,j=this.children.length;j>i;i++)if(found=this.children[i].getChild(child))return found;return null},getChildCount:function(){return this.children.length},addChild:function(child){this.children.push(child),child.parent=this,null!==child.getName()&&this.addName(child.getName(),child)},addName:function(name,shape){null!==this.parent?this.parent.addName(name,shape):this.nameTable.push([name,shape])},translate:function(){2===arguments.length?(this.checkMatrix(2),this.matrix.translate(arguments[0],arguments[1])):(this.checkMatrix(3),this.matrix.translate(arguments[0],arguments[1],0))},checkMatrix:function(dimensions){null===this.matrix?this.matrix=2===dimensions?new PMatrix2D:new PMatrix3D:3===dimensions&&this.matrix instanceof PMatrix2D&&(this.matrix=new PMatrix3D)},rotateX:function(angle){this.rotate(angle,1,0,0)},rotateY:function(angle){this.rotate(angle,0,1,0)},rotateZ:function(angle){this.rotate(angle,0,0,1)},rotate:function(){1===arguments.length?(this.checkMatrix(2),this.matrix.rotate(arguments[0])):(this.checkMatrix(3),this.matrix.rotate(arguments[0],arguments[1],arguments[2],arguments[3]))},scale:function(){2===arguments.length?(this.checkMatrix(2),this.matrix.scale(arguments[0],arguments[1])):3===arguments.length?(this.checkMatrix(2),this.matrix.scale(arguments[0],arguments[1],arguments[2])):(this.checkMatrix(2),this.matrix.scale(arguments[0]))},resetMatrix:function(){this.checkMatrix(2),this.matrix.reset()},applyMatrix:function(matrix){1===arguments.length?this.applyMatrix(matrix.elements[0],matrix.elements[1],0,matrix.elements[2],matrix.elements[3],matrix.elements[4],0,matrix.elements[5],0,0,1,0,0,0,0,1):6===arguments.length?(this.checkMatrix(2),this.matrix.apply(arguments[0],arguments[1],arguments[2],0,arguments[3],arguments[4],arguments[5],0,0,0,1,0,0,0,0,1)):16===arguments.length&&(this.checkMatrix(3),this.matrix.apply(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8],arguments[9],arguments[10],arguments[11],arguments[12],arguments[13],arguments[14],arguments[15]))}},PShape}},{}],16:[function(require,module){module.exports=function(options){var CommonFunctions=options.CommonFunctions,PConstants=options.PConstants,PShape=options.PShape,XMLElement=options.XMLElement,colors=options.colors,PShapeSVG=function(){if(PShape.call(this),1===arguments.length){if(this.element=arguments[0],this.vertexCodes=[],this.vertices=[],this.opacity=1,this.stroke=!1,this.strokeColor=PConstants.ALPHA_MASK,this.strokeWeight=1,this.strokeCap=PConstants.SQUARE,this.strokeJoin=PConstants.MITER,this.strokeGradient=null,this.strokeGradientPaint=null,this.strokeName=null,this.strokeOpacity=1,this.fill=!0,this.fillColor=PConstants.ALPHA_MASK,this.fillGradient=null,this.fillGradientPaint=null,this.fillName=null,this.fillOpacity=1,"svg"!==this.element.getName())throw"root is not <svg>, it's <"+this.element.getName()+">"}else 2===arguments.length&&("string"==typeof arguments[1]?arguments[1].indexOf(".svg")>-1&&(this.element=new XMLElement(!0,arguments[1]),this.vertexCodes=[],this.vertices=[],this.opacity=1,this.stroke=!1,this.strokeColor=PConstants.ALPHA_MASK,this.strokeWeight=1,this.strokeCap=PConstants.SQUARE,this.strokeJoin=PConstants.MITER,this.strokeGradient="",this.strokeGradientPaint="",this.strokeName="",this.strokeOpacity=1,this.fill=!0,this.fillColor=PConstants.ALPHA_MASK,this.fillGradient=null,this.fillGradientPaint=null,this.fillOpacity=1):arguments[0]&&(this.element=arguments[1],this.vertexCodes=arguments[0].vertexCodes.slice(),this.vertices=arguments[0].vertices.slice(),this.stroke=arguments[0].stroke,this.strokeColor=arguments[0].strokeColor,this.strokeWeight=arguments[0].strokeWeight,this.strokeCap=arguments[0].strokeCap,this.strokeJoin=arguments[0].strokeJoin,this.strokeGradient=arguments[0].strokeGradient,this.strokeGradientPaint=arguments[0].strokeGradientPaint,this.strokeName=arguments[0].strokeName,this.fill=arguments[0].fill,this.fillColor=arguments[0].fillColor,this.fillGradient=arguments[0].fillGradient,this.fillGradientPaint=arguments[0].fillGradientPaint,this.fillName=arguments[0].fillName,this.strokeOpacity=arguments[0].strokeOpacity,this.fillOpacity=arguments[0].fillOpacity,this.opacity=arguments[0].opacity));this.name=this.element.getStringAttribute("id");var displayStr=this.element.getStringAttribute("display","inline");this.visible="none"!==displayStr;var str=this.element.getAttribute("transform");str&&(this.matrix=this.parseMatrix(str));var viewBoxStr=this.element.getStringAttribute("viewBox");if(null!==viewBoxStr){var viewBox=viewBoxStr.split(" ");this.width=viewBox[2],this.height=viewBox[3]}var unitWidth=this.element.getStringAttribute("width"),unitHeight=this.element.getStringAttribute("height");if(null!==unitWidth)this.width=this.parseUnitSize(unitWidth),this.height=this.parseUnitSize(unitHeight);else if(0===this.width||0===this.height)throw this.width=1,this.height=1,"The width and/or height is not readable in the <svg> tag of this file.";this.parseColors(this.element),this.parseChildren(this.element)};return PShapeSVG.prototype=new PShape,PShapeSVG.prototype.parseMatrix=function(){function getCoords(s){var m=[];return s.replace(/\((.*?)\)/,function(){return function(all,params){m=params.replace(/,+/g," ").split(/\s+/)}}()),m}return function(str){this.checkMatrix(2);var pieces=[];if(str.replace(/\s*(\w+)\((.*?)\)/g,function(all){pieces.push(CommonFunctions.trim(all))}),0===pieces.length)return null;for(var i=0,j=pieces.length;j>i;i++){var m=getCoords(pieces[i]);if(-1!==pieces[i].indexOf("matrix"))this.matrix.set(m[0],m[2],m[4],m[1],m[3],m[5]);else if(-1!==pieces[i].indexOf("translate")){var tx=m[0],ty=2===m.length?m[1]:0;this.matrix.translate(tx,ty)}else if(-1!==pieces[i].indexOf("scale")){var sx=m[0],sy=2===m.length?m[1]:m[0];this.matrix.scale(sx,sy)}else if(-1!==pieces[i].indexOf("rotate")){var angle=m[0];1===m.length?this.matrix.rotate(CommonFunctions.radians(angle)):3===m.length&&(this.matrix.translate(m[1],m[2]),this.matrix.rotate(CommonFunctions.radians(m[0])),this.matrix.translate(-m[1],-m[2]))}else-1!==pieces[i].indexOf("skewX")?this.matrix.skewX(parseFloat(m[0])):-1!==pieces[i].indexOf("skewY")?this.matrix.skewY(m[0]):-1!==pieces[i].indexOf("shearX")?this.matrix.shearX(m[0]):-1!==pieces[i].indexOf("shearY")&&this.matrix.shearY(m[0])}return this.matrix}}(),PShapeSVG.prototype.parseChildren=function(element){var i,j,newelement=element.getChildren(),base=new PShape;for(i=0,j=newelement.length;j>i;i++){var kid=this.parseChild(newelement[i]);kid&&base.addChild(kid)}for(i=0,j=base.children.length;j>i;i++)this.children.push(base.children[i])},PShapeSVG.prototype.getName=function(){return this.name},PShapeSVG.prototype.parseChild=function(elem){var shape,name=elem.getName();return"g"===name?shape=new PShapeSVG(this,elem):"defs"===name?shape=new PShapeSVG(this,elem):"line"===name?(shape=new PShapeSVG(this,elem),shape.parseLine()):"circle"===name?(shape=new PShapeSVG(this,elem),shape.parseEllipse(!0)):"ellipse"===name?(shape=new PShapeSVG(this,elem),shape.parseEllipse(!1)):"rect"===name?(shape=new PShapeSVG(this,elem),shape.parseRect()):"polygon"===name?(shape=new PShapeSVG(this,elem),shape.parsePoly(!0)):"polyline"===name?(shape=new PShapeSVG(this,elem),shape.parsePoly(!1)):"path"===name?(shape=new PShapeSVG(this,elem),shape.parsePath()):"radialGradient"===name?unimplemented("PShapeSVG.prototype.parseChild, name = radialGradient"):"linearGradient"===name?unimplemented("PShapeSVG.prototype.parseChild, name = linearGradient"):"text"===name?unimplemented("PShapeSVG.prototype.parseChild, name = text"):"filter"===name?unimplemented("PShapeSVG.prototype.parseChild, name = filter"):"mask"===name&&unimplemented("PShapeSVG.prototype.parseChild, name = mask"),shape},PShapeSVG.prototype.parsePath=function(){this.family=PConstants.PATH,this.kind=0;var pathData=CommonFunctions.trim(this.element.getStringAttribute("d").replace(/[\s,]+/g," "));if(null!==pathData){pathData=pathData.split("");for(var lastInstruction,command,j,k,cx=0,cy=0,ctrlX=0,ctrlY=0,ctrlX1=0,ctrlX2=0,ctrlY1=0,ctrlY2=0,endX=0,endY=0,ppx=0,ppy=0,px=0,py=0,i=0,valOf=0,str="",tmpArray=[],flag=!1;i<pathData.length;)if(valOf=pathData[i].charCodeAt(0),valOf>=65&&90>=valOf||valOf>=97&&122>=valOf){if(j=i,i++,i<pathData.length)for(tmpArray=[],valOf=pathData[i].charCodeAt(0);!(valOf>=65&&90>=valOf||valOf>=97&&100>=valOf||valOf>=102&&122>=valOf)&&flag===!1;)32===valOf?(""!==str&&(tmpArray.push(parseFloat(str)),str=""),i++):45===valOf?101===pathData[i-1].charCodeAt(0)?(str+=pathData[i].toString(),i++):(""!==str&&tmpArray.push(parseFloat(str)),str=pathData[i].toString(),i++):(str+=pathData[i].toString(),i++),i===pathData.length?flag=!0:valOf=pathData[i].charCodeAt(0);if(""!==str&&(tmpArray.push(parseFloat(str)),str=""),command=pathData[j],valOf=command.charCodeAt(0),77===valOf){if(tmpArray.length>=2&&tmpArray.length%2===0&&(cx=tmpArray[0],cy=tmpArray[1],this.parsePathMoveto(cx,cy),tmpArray.length>2))for(j=2,k=tmpArray.length;k>j;j+=2)cx=tmpArray[j],cy=tmpArray[j+1],this.parsePathLineto(cx,cy)}else if(109===valOf){if(tmpArray.length>=2&&tmpArray.length%2===0&&(cx+=tmpArray[0],cy+=tmpArray[1],this.parsePathMoveto(cx,cy),tmpArray.length>2))for(j=2,k=tmpArray.length;k>j;j+=2)cx+=tmpArray[j],cy+=tmpArray[j+1],this.parsePathLineto(cx,cy)}else if(76===valOf){if(tmpArray.length>=2&&tmpArray.length%2===0)for(j=0,k=tmpArray.length;k>j;j+=2)cx=tmpArray[j],cy=tmpArray[j+1],this.parsePathLineto(cx,cy)}else if(108===valOf){if(tmpArray.length>=2&&tmpArray.length%2===0)for(j=0,k=tmpArray.length;k>j;j+=2)cx+=tmpArray[j],cy+=tmpArray[j+1],this.parsePathLineto(cx,cy)}else if(72===valOf)for(j=0,k=tmpArray.length;k>j;j++)cx=tmpArray[j],this.parsePathLineto(cx,cy);else if(104===valOf)for(j=0,k=tmpArray.length;k>j;j++)cx+=tmpArray[j],this.parsePathLineto(cx,cy);else if(86===valOf)for(j=0,k=tmpArray.length;k>j;j++)cy=tmpArray[j],this.parsePathLineto(cx,cy);else if(118===valOf)for(j=0,k=tmpArray.length;k>j;j++)cy+=tmpArray[j],this.parsePathLineto(cx,cy);else if(67===valOf){if(tmpArray.length>=6&&tmpArray.length%6===0)for(j=0,k=tmpArray.length;k>j;j+=6)ctrlX1=tmpArray[j],ctrlY1=tmpArray[j+1],ctrlX2=tmpArray[j+2],ctrlY2=tmpArray[j+3],endX=tmpArray[j+4],endY=tmpArray[j+5],this.parsePathCurveto(ctrlX1,ctrlY1,ctrlX2,ctrlY2,endX,endY),cx=endX,cy=endY}else if(99===valOf){if(tmpArray.length>=6&&tmpArray.length%6===0)for(j=0,k=tmpArray.length;k>j;j+=6)ctrlX1=cx+tmpArray[j],ctrlY1=cy+tmpArray[j+1],ctrlX2=cx+tmpArray[j+2],ctrlY2=cy+tmpArray[j+3],endX=cx+tmpArray[j+4],endY=cy+tmpArray[j+5],this.parsePathCurveto(ctrlX1,ctrlY1,ctrlX2,ctrlY2,endX,endY),cx=endX,cy=endY}else if(83===valOf){if(tmpArray.length>=4&&tmpArray.length%4===0)for(j=0,k=tmpArray.length;k>j;j+=4)"c"===lastInstruction.toLowerCase()||"s"===lastInstruction.toLowerCase()?(ppx=this.vertices[this.vertices.length-2][0],ppy=this.vertices[this.vertices.length-2][1],px=this.vertices[this.vertices.length-1][0],py=this.vertices[this.vertices.length-1][1],ctrlX1=px+(px-ppx),ctrlY1=py+(py-ppy)):(ctrlX1=this.vertices[this.vertices.length-1][0],ctrlY1=this.vertices[this.vertices.length-1][1]),ctrlX2=tmpArray[j],ctrlY2=tmpArray[j+1],endX=tmpArray[j+2],endY=tmpArray[j+3],this.parsePathCurveto(ctrlX1,ctrlY1,ctrlX2,ctrlY2,endX,endY),cx=endX,cy=endY}else if(115===valOf){if(tmpArray.length>=4&&tmpArray.length%4===0)for(j=0,k=tmpArray.length;k>j;j+=4)"c"===lastInstruction.toLowerCase()||"s"===lastInstruction.toLowerCase()?(ppx=this.vertices[this.vertices.length-2][0],ppy=this.vertices[this.vertices.length-2][1],px=this.vertices[this.vertices.length-1][0],py=this.vertices[this.vertices.length-1][1],ctrlX1=px+(px-ppx),ctrlY1=py+(py-ppy)):(ctrlX1=this.vertices[this.vertices.length-1][0],ctrlY1=this.vertices[this.vertices.length-1][1]),ctrlX2=cx+tmpArray[j],ctrlY2=cy+tmpArray[j+1],endX=cx+tmpArray[j+2],endY=cy+tmpArray[j+3],this.parsePathCurveto(ctrlX1,ctrlY1,ctrlX2,ctrlY2,endX,endY),cx=endX,cy=endY}else if(81===valOf){if(tmpArray.length>=4&&tmpArray.length%4===0)for(j=0,k=tmpArray.length;k>j;j+=4)ctrlX=tmpArray[j],ctrlY=tmpArray[j+1],endX=tmpArray[j+2],endY=tmpArray[j+3],this.parsePathQuadto(cx,cy,ctrlX,ctrlY,endX,endY),cx=endX,cy=endY}else if(113===valOf){if(tmpArray.length>=4&&tmpArray.length%4===0)for(j=0,k=tmpArray.length;k>j;j+=4)ctrlX=cx+tmpArray[j],ctrlY=cy+tmpArray[j+1],endX=cx+tmpArray[j+2],endY=cy+tmpArray[j+3],this.parsePathQuadto(cx,cy,ctrlX,ctrlY,endX,endY),cx=endX,cy=endY}else if(84===valOf){if(tmpArray.length>=2&&tmpArray.length%2===0)for(j=0,k=tmpArray.length;k>j;j+=2)"q"===lastInstruction.toLowerCase()||"t"===lastInstruction.toLowerCase()?(ppx=this.vertices[this.vertices.length-2][0],ppy=this.vertices[this.vertices.length-2][1],px=this.vertices[this.vertices.length-1][0],py=this.vertices[this.vertices.length-1][1],ctrlX=px+(px-ppx),ctrlY=py+(py-ppy)):(ctrlX=cx,ctrlY=cy),endX=tmpArray[j],endY=tmpArray[j+1],this.parsePathQuadto(cx,cy,ctrlX,ctrlY,endX,endY),cx=endX,cy=endY}else if(116===valOf){if(tmpArray.length>=2&&tmpArray.length%2===0)for(j=0,k=tmpArray.length;k>j;j+=2)"q"===lastInstruction.toLowerCase()||"t"===lastInstruction.toLowerCase()?(ppx=this.vertices[this.vertices.length-2][0],ppy=this.vertices[this.vertices.length-2][1],px=this.vertices[this.vertices.length-1][0],py=this.vertices[this.vertices.length-1][1],ctrlX=px+(px-ppx),ctrlY=py+(py-ppy)):(ctrlX=cx,ctrlY=cy),endX=cx+tmpArray[j],endY=cy+tmpArray[j+1],this.parsePathQuadto(cx,cy,ctrlX,ctrlY,endX,endY),cx=endX,cy=endY}else(90===valOf||122===valOf)&&(this.close=!0);lastInstruction=command.toString()}else i++}},PShapeSVG.prototype.parsePathQuadto=function(x1,y1,cx,cy,x2,y2){if(!(this.vertices.length>0))throw"Path must start with M/m";this.parsePathCode(PConstants.BEZIER_VERTEX),this.parsePathVertex(x1+2*(cx-x1)/3,y1+2*(cy-y1)/3),this.parsePathVertex(x2+2*(cx-x2)/3,y2+2*(cy-y2)/3),this.parsePathVertex(x2,y2)},PShapeSVG.prototype.parsePathCurveto=function(x1,y1,x2,y2,x3,y3){if(!(this.vertices.length>0))throw"Path must start with M/m";this.parsePathCode(PConstants.BEZIER_VERTEX),this.parsePathVertex(x1,y1),this.parsePathVertex(x2,y2),this.parsePathVertex(x3,y3)},PShapeSVG.prototype.parsePathLineto=function(px,py){if(!(this.vertices.length>0))throw"Path must start with M/m";this.parsePathCode(PConstants.VERTEX),this.parsePathVertex(px,py),this.vertices[this.vertices.length-1].moveTo=!1},PShapeSVG.prototype.parsePathMoveto=function(px,py){this.vertices.length>0&&this.parsePathCode(PConstants.BREAK),this.parsePathCode(PConstants.VERTEX),this.parsePathVertex(px,py),this.vertices[this.vertices.length-1].moveTo=!0},PShapeSVG.prototype.parsePathVertex=function(x,y){var verts=[];verts[0]=x,verts[1]=y,this.vertices.push(verts)},PShapeSVG.prototype.parsePathCode=function(what){this.vertexCodes.push(what)},PShapeSVG.prototype.parsePoly=function(val){this.family=PConstants.PATH,this.close=val;var pointsAttr=CommonFunctions.trim(this.element.getStringAttribute("points").replace(/[,\s]+/g," "));if(null!==pointsAttr){var pointsBuffer=pointsAttr.split(" ");if(pointsBuffer.length%2!==0)throw"Error parsing polygon points: odd number of coordinates provided";for(var i=0,j=pointsBuffer.length;j>i;i++){var verts=[];
verts[0]=pointsBuffer[i],verts[1]=pointsBuffer[++i],this.vertices.push(verts)}}},PShapeSVG.prototype.parseRect=function(){if(this.kind=PConstants.RECT,this.family=PConstants.PRIMITIVE,this.params=[],this.params[0]=this.element.getFloatAttribute("x"),this.params[1]=this.element.getFloatAttribute("y"),this.params[2]=this.element.getFloatAttribute("width"),this.params[3]=this.element.getFloatAttribute("height"),this.params[2]<0||this.params[3]<0)throw"svg error: negative width or height found while parsing <rect>"},PShapeSVG.prototype.parseEllipse=function(val){this.kind=PConstants.ELLIPSE,this.family=PConstants.PRIMITIVE,this.params=[],this.params[0]=0|this.element.getFloatAttribute("cx"),this.params[1]=0|this.element.getFloatAttribute("cy");var rx,ry;if(val){if(rx=ry=this.element.getFloatAttribute("r"),0>rx)throw"svg error: negative radius found while parsing <circle>"}else if(rx=this.element.getFloatAttribute("rx"),ry=this.element.getFloatAttribute("ry"),0>rx||0>ry)throw"svg error: negative x-axis radius or y-axis radius found while parsing <ellipse>";this.params[0]-=rx,this.params[1]-=ry,this.params[2]=2*rx,this.params[3]=2*ry},PShapeSVG.prototype.parseLine=function(){this.kind=PConstants.LINE,this.family=PConstants.PRIMITIVE,this.params=[],this.params[0]=this.element.getFloatAttribute("x1"),this.params[1]=this.element.getFloatAttribute("y1"),this.params[2]=this.element.getFloatAttribute("x2"),this.params[3]=this.element.getFloatAttribute("y2")},PShapeSVG.prototype.parseColors=function(element){if(element.hasAttribute("opacity")&&this.setOpacity(element.getAttribute("opacity")),element.hasAttribute("stroke")&&this.setStroke(element.getAttribute("stroke")),element.hasAttribute("stroke-width")&&this.setStrokeWeight(element.getAttribute("stroke-width")),element.hasAttribute("stroke-linejoin")&&this.setStrokeJoin(element.getAttribute("stroke-linejoin")),element.hasAttribute("stroke-linecap")&&this.setStrokeCap(element.getStringAttribute("stroke-linecap")),element.hasAttribute("fill")&&this.setFill(element.getStringAttribute("fill")),element.hasAttribute("style"))for(var styleText=element.getStringAttribute("style"),styleTokens=styleText.toString().split(";"),i=0,j=styleTokens.length;j>i;i++){var tokens=CommonFunctions.trim(styleTokens[i].split(":"));"fill"===tokens[0]?this.setFill(tokens[1]):"fill-opacity"===tokens[0]?this.setFillOpacity(tokens[1]):"stroke"===tokens[0]?this.setStroke(tokens[1]):"stroke-width"===tokens[0]?this.setStrokeWeight(tokens[1]):"stroke-linecap"===tokens[0]?this.setStrokeCap(tokens[1]):"stroke-linejoin"===tokens[0]?this.setStrokeJoin(tokens[1]):"stroke-opacity"===tokens[0]?this.setStrokeOpacity(tokens[1]):"opacity"===tokens[0]&&this.setOpacity(tokens[1])}},PShapeSVG.prototype.setFillOpacity=function(opacityText){this.fillOpacity=parseFloat(opacityText),this.fillColor=255*this.fillOpacity<<24|16777215&this.fillColor},PShapeSVG.prototype.setFill=function(fillText){var opacityMask=4278190080&this.fillColor;"none"===fillText?this.fill=!1:0===fillText.indexOf("#")?(this.fill=!0,4===fillText.length&&(fillText=fillText.replace(/#(.)(.)(.)/,"#$1$1$2$2$3$3")),this.fillColor=opacityMask|16777215&parseInt(fillText.substring(1),16)):0===fillText.indexOf("rgb")?(this.fill=!0,this.fillColor=opacityMask|this.parseRGB(fillText)):0===fillText.indexOf("url(#")?this.fillName=fillText.substring(5,fillText.length-1):colors[fillText]&&(this.fill=!0,this.fillColor=opacityMask|16777215&parseInt(colors[fillText].substring(1),16))},PShapeSVG.prototype.setOpacity=function(opacity){this.strokeColor=255*parseFloat(opacity)<<24|16777215&this.strokeColor,this.fillColor=255*parseFloat(opacity)<<24|16777215&this.fillColor},PShapeSVG.prototype.setStroke=function(strokeText){var opacityMask=4278190080&this.strokeColor;"none"===strokeText?this.stroke=!1:"#"===strokeText.charAt(0)?(this.stroke=!0,4===strokeText.length&&(strokeText=strokeText.replace(/#(.)(.)(.)/,"#$1$1$2$2$3$3")),this.strokeColor=opacityMask|16777215&parseInt(strokeText.substring(1),16)):0===strokeText.indexOf("rgb")?(this.stroke=!0,this.strokeColor=opacityMask|this.parseRGB(strokeText)):0===strokeText.indexOf("url(#")?this.strokeName=strokeText.substring(5,strokeText.length-1):colors[strokeText]&&(this.stroke=!0,this.strokeColor=opacityMask|16777215&parseInt(colors[strokeText].substring(1),16))},PShapeSVG.prototype.setStrokeWeight=function(weight){this.strokeWeight=this.parseUnitSize(weight)},PShapeSVG.prototype.setStrokeJoin=function(linejoin){"miter"===linejoin?this.strokeJoin=PConstants.MITER:"round"===linejoin?this.strokeJoin=PConstants.ROUND:"bevel"===linejoin&&(this.strokeJoin=PConstants.BEVEL)},PShapeSVG.prototype.setStrokeCap=function(linecap){"butt"===linecap?this.strokeCap=PConstants.SQUARE:"round"===linecap?this.strokeCap=PConstants.ROUND:"square"===linecap&&(this.strokeCap=PConstants.PROJECT)},PShapeSVG.prototype.setStrokeOpacity=function(opacityText){this.strokeOpacity=parseFloat(opacityText),this.strokeColor=255*this.strokeOpacity<<24|16777215&this.strokeColor},PShapeSVG.prototype.parseRGB=function(color){var sub=color.substring(color.indexOf("(")+1,color.indexOf(")")),values=sub.split(", ");return values[0]<<16|values[1]<<8|values[2]},PShapeSVG.prototype.parseUnitSize=function(text){var len=text.length-2;return 0>len?text:text.indexOf("pt")===len?1.25*parseFloat(text.substring(0,len)):text.indexOf("pc")===len?15*parseFloat(text.substring(0,len)):text.indexOf("mm")===len?3.543307*parseFloat(text.substring(0,len)):text.indexOf("cm")===len?35.43307*parseFloat(text.substring(0,len)):text.indexOf("in")===len?90*parseFloat(text.substring(0,len)):parseFloat(text.indexOf("px")===len?text.substring(0,len):text)},PShapeSVG}},{}],17:[function(require,module){module.exports=function(options,undef){function PVector(x,y,z){this.x=x||0,this.y=y||0,this.z=z||0}function createPVectorMethod(method){return function(v1,v2){var v=v1.get();return v[method](v2),v}}var PConstants=options.PConstants;PVector.fromAngle=function(angle,v){return(v===undef||null===v)&&(v=new PVector),v.x=Math.cos(angle),v.y=Math.sin(angle),v},PVector.random2D=function(v){return PVector.fromAngle(Math.random()*PConstants.TWO_PI,v)},PVector.random3D=function(v){var angle=Math.random()*PConstants.TWO_PI,vz=2*Math.random()-1,mult=Math.sqrt(1-vz*vz),vx=mult*Math.cos(angle),vy=mult*Math.sin(angle);return v===undef||null===v?v=new PVector(vx,vy,vz):v.set(vx,vy,vz),v},PVector.dist=function(v1,v2){return v1.dist(v2)},PVector.dot=function(v1,v2){return v1.dot(v2)},PVector.cross=function(v1,v2){return v1.cross(v2)},PVector.sub=function(v1,v2){return new PVector(v1.x-v2.x,v1.y-v2.y,v1.z-v2.z)},PVector.angleBetween=function(v1,v2){return Math.acos(v1.dot(v2)/(v1.mag()*v2.mag()))},PVector.lerp=function(v1,v2,amt){var retval=new PVector(v1.x,v1.y,v1.z);return retval.lerp(v2,amt),retval},PVector.prototype={set:function(v,y,z){1===arguments.length?this.set(v.x||v[0]||0,v.y||v[1]||0,v.z||v[2]||0):(this.x=v,this.y=y,this.z=z)},get:function(){return new PVector(this.x,this.y,this.z)},mag:function(){var x=this.x,y=this.y,z=this.z;return Math.sqrt(x*x+y*y+z*z)},magSq:function(){var x=this.x,y=this.y,z=this.z;return x*x+y*y+z*z},setMag:function(v_or_len,len){if(len!==undef){var v=v_or_len;return v.normalize(),v.mult(len),v}len=v_or_len,this.normalize(),this.mult(len)},add:function(v,y,z){1===arguments.length?(this.x+=v.x,this.y+=v.y,this.z+=v.z):(this.x+=v,this.y+=y,this.z+=z)},sub:function(v,y,z){1===arguments.length?(this.x-=v.x,this.y-=v.y,this.z-=v.z):(this.x-=v,this.y-=y,this.z-=z)},mult:function(v){"number"==typeof v?(this.x*=v,this.y*=v,this.z*=v):(this.x*=v.x,this.y*=v.y,this.z*=v.z)},div:function(v){"number"==typeof v?(this.x/=v,this.y/=v,this.z/=v):(this.x/=v.x,this.y/=v.y,this.z/=v.z)},rotate:function(angle){var prev_x=this.x,c=Math.cos(angle),s=Math.sin(angle);this.x=c*this.x-s*this.y,this.y=s*prev_x+c*this.y},dist:function(v){var dx=this.x-v.x,dy=this.y-v.y,dz=this.z-v.z;return Math.sqrt(dx*dx+dy*dy+dz*dz)},dot:function(v,y,z){return 1===arguments.length?this.x*v.x+this.y*v.y+this.z*v.z:this.x*v+this.y*y+this.z*z},cross:function(v){var x=this.x,y=this.y,z=this.z;return new PVector(y*v.z-v.y*z,z*v.x-v.z*x,x*v.y-v.x*y)},lerp:function(v_or_x,amt_or_y,z,amt){var x,y,lerp_val=function(start,stop,amt){return start+(stop-start)*amt};2===arguments.length?(amt=amt_or_y,x=v_or_x.x,y=v_or_x.y,z=v_or_x.z):(x=v_or_x,y=amt_or_y),this.x=lerp_val(this.x,x,amt),this.y=lerp_val(this.y,y,amt),this.z=lerp_val(this.z,z,amt)},normalize:function(){var m=this.mag();m>0&&this.div(m)},limit:function(high){this.mag()>high&&(this.normalize(),this.mult(high))},heading:function(){return-Math.atan2(-this.y,this.x)},heading2D:function(){return this.heading()},toString:function(){return"["+this.x+", "+this.y+", "+this.z+"]"},array:function(){return[this.x,this.y,this.z]}};for(var method in PVector.prototype)PVector.prototype.hasOwnProperty(method)&&!PVector.hasOwnProperty(method)&&(PVector[method]=createPVectorMethod(method));return PVector}},{}],18:[function(require,module){module.exports=function(){var XMLAttribute=function(fname,n,nameSpace,v,t){this.fullName=fname||"",this.name=n||"",this.namespace=nameSpace||"",this.value=v,this.type=t};return XMLAttribute.prototype={getName:function(){return this.name},getFullName:function(){return this.fullName},getNamespace:function(){return this.namespace},getValue:function(){return this.value},getType:function(){return this.type},setValue:function(newval){this.value=newval}},XMLAttribute}},{}],19:[function(require,module){module.exports=function(options,undef){var Browser=options.Browser,ajax=Browser.ajax,window=Browser.window,DOMParser=(window.XMLHttpRequest,window.DOMParser),XMLAttribute=options.XMLAttribute,XMLElement=function(selector,uri,sysid,line){this.attributes=[],this.children=[],this.fullName=null,this.name=null,this.namespace="",this.content=null,this.parent=null,this.lineNr="",this.systemID="",this.type="ELEMENT",selector&&("string"==typeof selector?uri===undef&&selector.indexOf("<")>-1?this.parse(selector):(this.fullName=selector,this.namespace=uri,this.systemId=sysid,this.lineNr=line):this.parse(uri))};return XMLElement.prototype={parse:function(textstring){var xmlDoc;try{var extension=textstring.substring(textstring.length-4);(".xml"===extension||".svg"===extension)&&(textstring=ajax(textstring)),xmlDoc=(new DOMParser).parseFromString(textstring,"text/xml");var elements=xmlDoc.documentElement;if(!elements)throw"Error loading document";return this.parseChildrenRecursive(null,elements),this}catch(e){throw e}},parseChildrenRecursive:function(parent,elementpath){var xmlelement,xmlattribute,tmpattrib,l,m,child;if(parent?(xmlelement=new XMLElement(elementpath.nodeName),xmlelement.parent=parent):(this.fullName=elementpath.localName,this.name=elementpath.nodeName,xmlelement=this),3===elementpath.nodeType&&""!==elementpath.textContent)return this.createPCDataElement(elementpath.textContent);if(4===elementpath.nodeType)return this.createCDataElement(elementpath.textContent);if(elementpath.attributes)for(l=0,m=elementpath.attributes.length;m>l;l++)tmpattrib=elementpath.attributes[l],xmlattribute=new XMLAttribute(tmpattrib.getname,tmpattrib.nodeName,tmpattrib.namespaceURI,tmpattrib.nodeValue,tmpattrib.nodeType),xmlelement.attributes.push(xmlattribute);if(elementpath.childNodes)for(l=0,m=elementpath.childNodes.length;m>l;l++){var node=elementpath.childNodes[l];child=xmlelement.parseChildrenRecursive(xmlelement,node),null!==child&&xmlelement.children.push(child)}return xmlelement},createElement:function(fullname,namespaceuri,sysid,line){return sysid===undef?new XMLElement(fullname,namespaceuri):new XMLElement(fullname,namespaceuri,sysid,line)},createPCDataElement:function(content){if(""===content.replace(/^\s+$/g,""))return null;var pcdata=new XMLElement;return pcdata.type="TEXT",pcdata.content=content,pcdata},createCDataElement:function(content){var cdata=this.createPCDataElement(content);if(null===cdata)return null;cdata.type="CDATA";var entity,htmlentities={"<":"&lt;",">":"&gt;","'":"&apos;",'"':"&quot;"};for(entity in htmlentities)Object.hasOwnProperty(htmlentities,entity)||(content=content.replace(new RegExp(entity,"g"),htmlentities[entity]));return cdata.cdata=content,cdata},hasAttribute:function(){return 1===arguments.length?null!==this.getAttribute(arguments[0]):2===arguments.length?null!==this.getAttribute(arguments[0],arguments[1]):void 0},equals:function(other){if(!(other instanceof XMLElement))return!1;var i,j;if(this.fullName!==other.fullName)return!1;if(this.attributes.length!==other.getAttributeCount())return!1;if(this.attributes.length!==other.attributes.length)return!1;var attr_name,attr_ns,attr_other;for(i=0,j=this.attributes.length;j>i;i++){if(attr_name=this.attributes[i].getName(),attr_ns=this.attributes[i].getNamespace(),attr_other=other.findAttribute(attr_name,attr_ns),null===attr_other)return!1;if(this.attributes[i].getValue()!==attr_other.getValue())return!1;if(this.attributes[i].getType()!==attr_other.getType())return!1}if(this.children.length!==other.getChildCount())return!1;if(this.children.length>0){var child1,child2;for(i=0,j=this.children.length;j>i;i++)if(child1=this.getChild(i),child2=other.getChild(i),!child1.equals(child2))return!1;return!0}return this.content===other.content},getContent:function(){if("TEXT"===this.type||"CDATA"===this.type)return this.content;var children=this.children;return 1!==children.length||"TEXT"!==children[0].type&&"CDATA"!==children[0].type?null:children[0].content},getAttribute:function(){var attribute;return 2===arguments.length?(attribute=this.findAttribute(arguments[0]),attribute?attribute.getValue():arguments[1]):1===arguments.length?(attribute=this.findAttribute(arguments[0]),attribute?attribute.getValue():null):3===arguments.length?(attribute=this.findAttribute(arguments[0],arguments[1]),attribute?attribute.getValue():arguments[2]):void 0},getStringAttribute:function(){return 1===arguments.length?this.getAttribute(arguments[0]):2===arguments.length?this.getAttribute(arguments[0],arguments[1]):this.getAttribute(arguments[0],arguments[1],arguments[2])},getString:function(attributeName){return this.getStringAttribute(attributeName)},getFloatAttribute:function(){return 1===arguments.length?parseFloat(this.getAttribute(arguments[0],0)):2===arguments.length?this.getAttribute(arguments[0],arguments[1]):this.getAttribute(arguments[0],arguments[1],arguments[2])},getFloat:function(attributeName){return this.getFloatAttribute(attributeName)},getIntAttribute:function(){return 1===arguments.length?this.getAttribute(arguments[0],0):2===arguments.length?this.getAttribute(arguments[0],arguments[1]):this.getAttribute(arguments[0],arguments[1],arguments[2])},getInt:function(attributeName){return this.getIntAttribute(attributeName)},hasChildren:function(){return this.children.length>0},addChild:function(child){null!==child&&(child.parent=this,this.children.push(child))},insertChild:function(child,index){if(child){if(null===child.getLocalName()&&!this.hasChildren()){var lastChild=this.children[this.children.length-1];if(null===lastChild.getLocalName())return void lastChild.setContent(lastChild.getContent()+child.getContent())}child.parent=this,this.children.splice(index,0,child)}},getChild:function(selector){if("number"==typeof selector)return this.children[selector];if(-1!==selector.indexOf("/"))return this.getChildRecursive(selector.split("/"),0);for(var kid,kidName,i=0,j=this.getChildCount();j>i;i++)if(kid=this.getChild(i),kidName=kid.getName(),null!==kidName&&kidName===selector)return kid;return null},getChildren:function(){if(1===arguments.length){if("number"==typeof arguments[0])return this.getChild(arguments[0]);if(-1!==arguments[0].indexOf("/"))return this.getChildrenRecursive(arguments[0].split("/"),0);for(var kid,kidName,matches=[],i=0,j=this.getChildCount();j>i;i++)kid=this.getChild(i),kidName=kid.getName(),null!==kidName&&kidName===arguments[0]&&matches.push(kid);return matches}return this.children},getChildCount:function(){return this.children.length},getChildRecursive:function(items,offset){if(offset===items.length)return this;for(var kid,kidName,matchName=items[offset],i=0,j=this.getChildCount();j>i;i++)if(kid=this.getChild(i),kidName=kid.getName(),null!==kidName&&kidName===matchName)return kid.getChildRecursive(items,offset+1);return null},getChildrenRecursive:function(items,offset){if(offset===items.length-1)return this.getChildren(items[offset]);for(var matches=this.getChildren(items[offset]),kidMatches=[],i=0;i<matches.length;i++)kidMatches=kidMatches.concat(matches[i].getChildrenRecursive(items,offset+1));return kidMatches},isLeaf:function(){return!this.hasChildren()},listChildren:function(){for(var arr=[],i=0,j=this.children.length;j>i;i++)arr.push(this.getChild(i).getName());return arr},removeAttribute:function(name,namespace){this.namespace=namespace||"";for(var i=0,j=this.attributes.length;j>i;i++)if(this.attributes[i].getName()===name&&this.attributes[i].getNamespace()===this.namespace){this.attributes.splice(i,1);break}},removeChild:function(child){if(child)for(var i=0,j=this.children.length;j>i;i++)if(this.children[i].equals(child)){this.children.splice(i,1);break}},removeChildAtIndex:function(index){this.children.length>index&&this.children.splice(index,1)},findAttribute:function(name,namespace){this.namespace=namespace||"";for(var i=0,j=this.attributes.length;j>i;i++)if(this.attributes[i].getName()===name&&this.attributes[i].getNamespace()===this.namespace)return this.attributes[i];return null},setAttribute:function(){var attr;if(3===arguments.length){var index=arguments[0].indexOf(":"),name=arguments[0].substring(index+1);attr=this.findAttribute(name,arguments[1]),attr?attr.setValue(arguments[2]):(attr=new XMLAttribute(arguments[0],name,arguments[1],arguments[2],"CDATA"),this.attributes.push(attr))}else attr=this.findAttribute(arguments[0]),attr?attr.setValue(arguments[1]):(attr=new XMLAttribute(arguments[0],arguments[0],null,arguments[1],"CDATA"),this.attributes.push(attr))},setString:function(attribute,value){this.setAttribute(attribute,value)},setInt:function(attribute,value){this.setAttribute(attribute,value)},setFloat:function(attribute,value){this.setAttribute(attribute,value)},setContent:function(content){this.children.length>0&&Processing.debug("Tried to set content for XMLElement with children"),this.content=content},setName:function(){if(1===arguments.length)this.name=arguments[0],this.fullName=arguments[0],this.namespace=null;else{var index=arguments[0].indexOf(":");this.name=null===arguments[1]||0>index?arguments[0]:arguments[0].substring(index+1),this.fullName=arguments[0],this.namespace=arguments[1]}},getName:function(){return this.fullName},getLocalName:function(){return this.name},getAttributeCount:function(){return this.attributes.length},toString:function(){if("TEXT"===this.type)return this.content;if("CDATA"===this.type)return this.cdata;var a,c,tagstring=this.fullName,xmlstring="<"+tagstring;for(a=0;a<this.attributes.length;a++){var attr=this.attributes[a];xmlstring+=" "+attr.getName()+'="'+attr.getValue()+'"'}if(0===this.children.length)xmlstring+=""===this.content?"/>":">"+this.content+"</"+tagstring+">";else{for(xmlstring+=">",c=0;c<this.children.length;c++)xmlstring+=this.children[c].toString();xmlstring+="</"+tagstring+">"}return xmlstring}},XMLElement.parse=function(xmlstring){var element=new XMLElement;return element.parse(xmlstring),element},XMLElement}},{}],20:[function(require,module){module.exports={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"}},{}],21:[function(require,module){module.exports=function(virtHashCode,virtEquals,undef){return function(p,removeFirstArgument){p.__contains=function(subject,subStr){return"string"!=typeof subject?subject.contains.apply(subject,removeFirstArgument(arguments)):null!==subject&&null!==subStr&&"string"==typeof subStr&&subject.indexOf(subStr)>-1},p.__replaceAll=function(subject,regex,replacement){return"string"!=typeof subject?subject.replaceAll.apply(subject,removeFirstArgument(arguments)):subject.replace(new RegExp(regex,"g"),replacement)},p.__replaceFirst=function(subject,regex,replacement){return"string"!=typeof subject?subject.replaceFirst.apply(subject,removeFirstArgument(arguments)):subject.replace(new RegExp(regex,""),replacement)},p.__replace=function(subject,what,replacement){if("string"!=typeof subject)return subject.replace.apply(subject,removeFirstArgument(arguments));if(what instanceof RegExp)return subject.replace(what,replacement);if("string"!=typeof what&&(what=what.toString()),""===what)return subject;var i=subject.indexOf(what);if(0>i)return subject;var j=0,result="";do result+=subject.substring(j,i)+replacement,j=i+what.length;while((i=subject.indexOf(what,j))>=0);return result+subject.substring(j)},p.__equals=function(subject,other){return subject.equals instanceof Function?subject.equals.apply(subject,removeFirstArgument(arguments)):virtEquals(subject,other)},p.__equalsIgnoreCase=function(subject,other){return"string"!=typeof subject?subject.equalsIgnoreCase.apply(subject,removeFirstArgument(arguments)):subject.toLowerCase()===other.toLowerCase()},p.__toCharArray=function(subject){if("string"!=typeof subject)return subject.toCharArray.apply(subject,removeFirstArgument(arguments));for(var chars=[],i=0,len=subject.length;len>i;++i)chars[i]=new Char(subject.charAt(i));return chars},p.__split=function(subject,regex,limit){if("string"!=typeof subject)return subject.split.apply(subject,removeFirstArgument(arguments));var pattern=new RegExp(regex);if(limit===undef||1>limit)return subject.split(pattern);for(var pos,result=[],currSubject=subject;-1!==(pos=currSubject.search(pattern))&&result.length<limit-1;){var match=pattern.exec(currSubject).toString();result.push(currSubject.substring(0,pos)),currSubject=currSubject.substring(pos+match.length)}return(-1!==pos||""!==currSubject)&&result.push(currSubject),result},p.__codePointAt=function(subject,idx){var hi,low,code=subject.charCodeAt(idx);return code>=55296&&56319>=code?(hi=code,low=subject.charCodeAt(idx+1),1024*(hi-55296)+(low-56320)+65536):code},p.__matches=function(str,regexp){return new RegExp(regexp).test(str)},p.__startsWith=function(subject,prefix,toffset){return"string"!=typeof subject?subject.startsWith.apply(subject,removeFirstArgument(arguments)):(toffset=toffset||0,0>toffset||toffset>subject.length?!1:""===prefix||prefix===subject?!0:subject.indexOf(prefix)===toffset)},p.__endsWith=function(subject,suffix){if("string"!=typeof subject)return subject.endsWith.apply(subject,removeFirstArgument(arguments));var suffixLen=suffix?suffix.length:0;return""===suffix||suffix===subject?!0:subject.indexOf(suffix)===subject.length-suffixLen},p.__hashCode=function(subject){return subject.hashCode instanceof Function?subject.hashCode.apply(subject,removeFirstArgument(arguments)):virtHashCode(subject)},p.__printStackTrace=function(subject){p.println("Exception: "+subject.toString())}}}},{}],22:[function(require,module){module.exports=function(p,undef){function Marsaglia(i1,i2){var z=i1||362436069,w=i2||521288629,intGenerator=function(){return z=36969*(65535&z)+(z>>>16)&4294967295,w=18e3*(65535&w)+(w>>>16)&4294967295,4294967295&((65535&z)<<16|65535&w)};this.doubleGenerator=function(){var i=intGenerator()/4294967296;return 0>i?1+i:i},this.intGenerator=intGenerator}function PerlinNoise(seed){function grad3d(i,x,y,z){var h=15&i,u=8>h?x:y,v=4>h?y:12===h||14===h?x:z;return(0===(1&h)?u:-u)+(0===(2&h)?v:-v)}function grad2d(i,x,y){var v=0===(1&i)?x:y;return 0===(2&i)?-v:v}function grad1d(i,x){return 0===(1&i)?-x:x}function lerp(t,a,b){return a+t*(b-a)}var i,j,rnd=seed!==undef?new Marsaglia(seed):Marsaglia.createRandomized(),perm=new Uint8Array(512);for(i=0;256>i;++i)perm[i]=i;for(i=0;256>i;++i){var t=perm[j=255&rnd.intGenerator()];perm[j]=perm[i],perm[i]=t}for(i=0;256>i;++i)perm[i+256]=perm[i];this.noise3d=function(x,y,z){var X=255&Math.floor(x),Y=255&Math.floor(y),Z=255&Math.floor(z);x-=Math.floor(x),y-=Math.floor(y),z-=Math.floor(z);var fx=(3-2*x)*x*x,fy=(3-2*y)*y*y,fz=(3-2*z)*z*z,p0=perm[X]+Y,p00=perm[p0]+Z,p01=perm[p0+1]+Z,p1=perm[X+1]+Y,p10=perm[p1]+Z,p11=perm[p1+1]+Z;return lerp(fz,lerp(fy,lerp(fx,grad3d(perm[p00],x,y,z),grad3d(perm[p10],x-1,y,z)),lerp(fx,grad3d(perm[p01],x,y-1,z),grad3d(perm[p11],x-1,y-1,z))),lerp(fy,lerp(fx,grad3d(perm[p00+1],x,y,z-1),grad3d(perm[p10+1],x-1,y,z-1)),lerp(fx,grad3d(perm[p01+1],x,y-1,z-1),grad3d(perm[p11+1],x-1,y-1,z-1))))},this.noise2d=function(x,y){var X=255&Math.floor(x),Y=255&Math.floor(y);x-=Math.floor(x),y-=Math.floor(y);var fx=(3-2*x)*x*x,fy=(3-2*y)*y*y,p0=perm[X]+Y,p1=perm[X+1]+Y;return lerp(fy,lerp(fx,grad2d(perm[p0],x,y),grad2d(perm[p1],x-1,y)),lerp(fx,grad2d(perm[p0+1],x,y-1),grad2d(perm[p1+1],x-1,y-1)))},this.noise1d=function(x){var X=255&Math.floor(x);x-=Math.floor(x);var fx=(3-2*x)*x*x;return lerp(fx,grad1d(perm[X],x),grad1d(perm[X+1],x-1))}}var internalRandomGenerator=function(){return Math.random()};p.abs=Math.abs,p.ceil=Math.ceil,p.exp=Math.exp,p.floor=Math.floor,p.log=Math.log,p.pow=Math.pow,p.round=Math.round,p.sqrt=Math.sqrt,p.acos=Math.acos,p.asin=Math.asin,p.atan=Math.atan,p.atan2=Math.atan2,p.cos=Math.cos,p.sin=Math.sin,p.tan=Math.tan,p.constrain=function(aNumber,aMin,aMax){return aNumber>aMax?aMax:aMin>aNumber?aMin:aNumber},p.dist=function(){var dx,dy,dz;return 4===arguments.length?(dx=arguments[0]-arguments[2],dy=arguments[1]-arguments[3],Math.sqrt(dx*dx+dy*dy)):6===arguments.length?(dx=arguments[0]-arguments[3],dy=arguments[1]-arguments[4],dz=arguments[2]-arguments[5],Math.sqrt(dx*dx+dy*dy+dz*dz)):void 0},p.lerp=function(value1,value2,amt){return(value2-value1)*amt+value1},p.mag=function(a,b,c){return Math.sqrt(c?a*a+b*b+c*c:a*a+b*b)},p.map=function(value,istart,istop,ostart,ostop){return ostart+(ostop-ostart)*((value-istart)/(istop-istart))},p.max=function(){if(2===arguments.length)return arguments[0]<arguments[1]?arguments[1]:arguments[0];var numbers=1===arguments.length?arguments[0]:arguments;if(!("length"in numbers&&numbers.length>0))throw"Non-empty array is expected";for(var max=numbers[0],count=numbers.length,i=1;count>i;++i)max<numbers[i]&&(max=numbers[i]);return max},p.min=function(){if(2===arguments.length)return arguments[0]<arguments[1]?arguments[0]:arguments[1];var numbers=1===arguments.length?arguments[0]:arguments;if(!("length"in numbers&&numbers.length>0))throw"Non-empty array is expected";for(var min=numbers[0],count=numbers.length,i=1;count>i;++i)min>numbers[i]&&(min=numbers[i]);return min},p.norm=function(aNumber,low,high){return(aNumber-low)/(high-low)},p.sq=function(aNumber){return aNumber*aNumber},p.degrees=function(aAngle){return 180*aAngle/Math.PI},p.random=function(){if(0===arguments.length)return internalRandomGenerator();if(1===arguments.length)return internalRandomGenerator()*arguments[0];var aMin=arguments[0],aMax=arguments[1];return internalRandomGenerator()*(aMax-aMin)+aMin},Marsaglia.createRandomized=function(){var now=new Date;return new Marsaglia(now/6e4&4294967295,4294967295&now)},p.randomSeed=function(seed){internalRandomGenerator=new Marsaglia(seed).doubleGenerator,this.haveNextNextGaussian=!1},p.randomGaussian=function(){if(this.haveNextNextGaussian)return this.haveNextNextGaussian=!1,this.nextNextGaussian;var v1,v2,s;do v1=2*internalRandomGenerator()-1,v2=2*internalRandomGenerator()-1,s=v1*v1+v2*v2;while(s>=1||0===s);var multiplier=Math.sqrt(-2*Math.log(s)/s);return this.nextNextGaussian=v2*multiplier,this.haveNextNextGaussian=!0,v1*multiplier};var noiseProfile={generator:undef,octaves:4,fallout:.5,seed:undef};p.noise=function(x,y,z){noiseProfile.generator===undef&&(noiseProfile.generator=new PerlinNoise(noiseProfile.seed));for(var generator=noiseProfile.generator,effect=1,k=1,sum=0,i=0;i<noiseProfile.octaves;++i){switch(effect*=noiseProfile.fallout,arguments.length){case 1:sum+=effect*(1+generator.noise1d(k*x))/2;break;case 2:sum+=effect*(1+generator.noise2d(k*x,k*y))/2;break;case 3:sum+=effect*(1+generator.noise3d(k*x,k*y,k*z))/2}k*=2}return sum},p.noiseDetail=function(octaves,fallout){noiseProfile.octaves=octaves,fallout!==undef&&(noiseProfile.fallout=fallout)},p.noiseSeed=function(seed){noiseProfile.seed=seed,noiseProfile.generator=undef}}},{}],23:[function(require,module){module.exports=function(undef){var CommonFunctions={trim:function(str){if(str instanceof Array){for(var arr=[],i=0;i<str.length;i++)arr.push(str[i].replace(/^\s*/,"").replace(/\s*$/,"").replace(/\r*$/,""));return arr}return str.replace(/^\s*/,"").replace(/\s*$/,"").replace(/\r*$/,"")},radians:function(aAngle){return aAngle/180*Math.PI},nfCoreScalar:function(value,plus,minus,leftDigits,rightDigits,group){var sign=0>value?minus:plus,autoDetectDecimals=0===rightDigits,rightDigitsOfDefault=rightDigits===undef||0>rightDigits?0:rightDigits,absValue=Math.abs(value);if(autoDetectDecimals)for(rightDigitsOfDefault=1,absValue*=10;Math.abs(Math.round(absValue)-absValue)>1e-6&&7>rightDigitsOfDefault;)++rightDigitsOfDefault,absValue*=10;else 0!==rightDigitsOfDefault&&(absValue*=Math.pow(10,rightDigitsOfDefault));var number,doubled=2*absValue;if(Math.floor(absValue)===absValue)number=absValue;else if(Math.floor(doubled)===doubled){var floored=Math.floor(absValue);number=floored+floored%2}else number=Math.round(absValue);
for(var buffer="",totalDigits=leftDigits+rightDigitsOfDefault;totalDigits>0||number>0;)totalDigits--,buffer=""+number%10+buffer,number=Math.floor(number/10);if(group!==undef)for(var i=buffer.length-3-rightDigitsOfDefault;i>0;)buffer=buffer.substring(0,i)+group+buffer.substring(i),i-=3;return rightDigitsOfDefault>0?sign+buffer.substring(0,buffer.length-rightDigitsOfDefault)+"."+buffer.substring(buffer.length-rightDigitsOfDefault,buffer.length):sign+buffer},nfCore:function(value,plus,minus,leftDigits,rightDigits,group){if(value instanceof Array){for(var arr=[],i=0,len=value.length;len>i;i++)arr.push(CommonFunctions.nfCoreScalar(value[i],plus,minus,leftDigits,rightDigits,group));return arr}return CommonFunctions.nfCoreScalar(value,plus,minus,leftDigits,rightDigits,group)},nf:function(value,leftDigits,rightDigits){return CommonFunctions.nfCore(value,"","-",leftDigits,rightDigits)},nfs:function(value,leftDigits,rightDigits){return CommonFunctions.nfCore(value," ","-",leftDigits,rightDigits)},nfp:function(value,leftDigits,rightDigits){return CommonFunctions.nfCore(value,"+","-",leftDigits,rightDigits)},nfc:function(value,rightDigits){return CommonFunctions.nfCore(value,"","-",0,rightDigits,",")},withCommonFunctions:function(p){["trim","radians","nf","nfs","nfp","nfc"].forEach(function(f){p[f]=CommonFunctions[f]})}};return CommonFunctions}()},{}],24:[function(require,module){module.exports=function(p,curElement,attachEventHandler,document,PConstants,undef){function calculateOffset(curElement){var element=curElement,offsetX=0,offsetY=0;if(p.pmouseX=p.mouseX,p.pmouseY=p.mouseY,element.offsetParent)do offsetX+=element.offsetLeft,offsetY+=element.offsetTop;while(element=element.offsetParent);element=curElement;do offsetX-=element.scrollLeft||0,offsetY-=element.scrollTop||0;while(element=element.parentNode);var stylePaddingLeft,stylePaddingTop,styleBorderLeft,styleBorderTop;return document.defaultView&&document.defaultView.getComputedStyle&&(stylePaddingLeft=parseInt(document.defaultView.getComputedStyle(curElement,null).paddingLeft,10)||0,stylePaddingTop=parseInt(document.defaultView.getComputedStyle(curElement,null).paddingTop,10)||0,styleBorderLeft=parseInt(document.defaultView.getComputedStyle(curElement,null).borderLeftWidth,10)||0,styleBorderTop=parseInt(document.defaultView.getComputedStyle(curElement,null).borderTopWidth,10)||0),offsetX+=stylePaddingLeft,offsetY+=stylePaddingTop,offsetX+=styleBorderLeft,offsetY+=styleBorderTop,offsetX+=window.pageXOffset,offsetY+=window.pageYOffset,{X:offsetX,Y:offsetY}}function updateMousePosition(curElement,event){var offset=calculateOffset(curElement,event);p.mouseX=event.pageX-offset.X,p.mouseY=event.pageY-offset.Y}function addTouchEventOffset(t){var i,offset=calculateOffset(t.changedTouches[0].target,t.changedTouches[0]);for(i=0;i<t.touches.length;i++){var touch=t.touches[i];touch.offsetX=touch.pageX-offset.X,touch.offsetY=touch.pageY-offset.Y}for(i=0;i<t.targetTouches.length;i++){var targetTouch=t.targetTouches[i];targetTouch.offsetX=targetTouch.pageX-offset.X,targetTouch.offsetY=targetTouch.pageY-offset.Y}for(i=0;i<t.changedTouches.length;i++){var changedTouch=t.changedTouches[i];changedTouch.offsetX=changedTouch.pageX-offset.X,changedTouch.offsetY=changedTouch.pageY-offset.Y}return t}attachEventHandler(curElement,"touchstart",function(t){curElement.setAttribute("style","-webkit-user-select: none"),curElement.setAttribute("onclick","void(0)"),curElement.setAttribute("style","-webkit-tap-highlight-color:rgba(0,0,0,0)");for(var i=0,ehl=eventHandlers.length;ehl>i;i++){var type=eventHandlers[i].type;("mouseout"===type||"mousemove"===type||"mousedown"===type||"mouseup"===type||"DOMMouseScroll"===type||"mousewheel"===type||"touchstart"===type)&&detachEventHandler(eventHandlers[i])}p.touchStart!==undef||p.touchMove!==undef||p.touchEnd!==undef||p.touchCancel!==undef?(attachEventHandler(curElement,"touchstart",function(t){p.touchStart!==undef&&(t=addTouchEventOffset(t),p.touchStart(t))}),attachEventHandler(curElement,"touchmove",function(t){p.touchMove!==undef&&(t.preventDefault(),t=addTouchEventOffset(t),p.touchMove(t))}),attachEventHandler(curElement,"touchend",function(t){p.touchEnd!==undef&&(t=addTouchEventOffset(t),p.touchEnd(t))}),attachEventHandler(curElement,"touchcancel",function(t){p.touchCancel!==undef&&(t=addTouchEventOffset(t),p.touchCancel(t))})):(attachEventHandler(curElement,"touchstart",function(e){updateMousePosition(curElement,e.touches[0]),p.__mousePressed=!0,p.mouseDragging=!1,p.mouseButton=PConstants.LEFT,"function"==typeof p.mousePressed&&p.mousePressed()}),attachEventHandler(curElement,"touchmove",function(e){e.preventDefault(),updateMousePosition(curElement,e.touches[0]),"function"!=typeof p.mouseMoved||p.__mousePressed||p.mouseMoved(),"function"==typeof p.mouseDragged&&p.__mousePressed&&(p.mouseDragged(),p.mouseDragging=!0)}),attachEventHandler(curElement,"touchend",function(){p.__mousePressed=!1,"function"!=typeof p.mouseClicked||p.mouseDragging||p.mouseClicked(),"function"==typeof p.mouseReleased&&p.mouseReleased()})),curElement.dispatchEvent(t)}),function(){var enabled=!0,contextMenu=function(e){e.preventDefault(),e.stopPropagation()};p.disableContextMenu=function(){enabled&&(attachEventHandler(curElement,"contextmenu",contextMenu),enabled=!1)},p.enableContextMenu=function(){enabled||(detachEventHandler({elem:curElement,type:"contextmenu",fn:contextMenu}),enabled=!0)}}(),attachEventHandler(curElement,"mousemove",function(e){updateMousePosition(curElement,e),"function"!=typeof p.mouseMoved||p.__mousePressed||p.mouseMoved(),"function"==typeof p.mouseDragged&&p.__mousePressed&&(p.mouseDragged(),p.mouseDragging=!0)}),attachEventHandler(curElement,"mouseout",function(){"function"==typeof p.mouseOut&&p.mouseOut()}),attachEventHandler(curElement,"mouseover",function(e){updateMousePosition(curElement,e),"function"==typeof p.mouseOver&&p.mouseOver()}),curElement.onmousedown=function(){return curElement.focus(),!1},attachEventHandler(curElement,"mousedown",function(e){switch(p.__mousePressed=!0,p.mouseDragging=!1,e.which){case 1:p.mouseButton=PConstants.LEFT;break;case 2:p.mouseButton=PConstants.CENTER;break;case 3:p.mouseButton=PConstants.RIGHT}"function"==typeof p.mousePressed&&p.mousePressed()}),attachEventHandler(curElement,"mouseup",function(){p.__mousePressed=!1,"function"!=typeof p.mouseClicked||p.mouseDragging||p.mouseClicked(),"function"==typeof p.mouseReleased&&p.mouseReleased()});var mouseWheelHandler=function(e){var delta=0;e.wheelDelta?(delta=e.wheelDelta/120,window.opera&&(delta=-delta)):e.detail&&(delta=-e.detail/3),p.mouseScroll=delta,delta&&"function"==typeof p.mouseScrolled&&p.mouseScrolled()};attachEventHandler(document,"DOMMouseScroll",mouseWheelHandler),attachEventHandler(document,"mousewheel",mouseWheelHandler)}},{}],25:[function(require,module){module.exports=function(Processing,options){function getGlobalMembers(){var names=["abs","acos","alpha","ambient","ambientLight","append","applyMatrix","arc","arrayCopy","asin","atan","atan2","background","beginCamera","beginDraw","beginShape","bezier","bezierDetail","bezierPoint","bezierTangent","bezierVertex","binary","blend","blendColor","blit_resize","blue","box","breakShape","brightness","camera","ceil","Character","color","colorMode","concat","constrain","copy","cos","createFont","createGraphics","createImage","cursor","curve","curveDetail","curvePoint","curveTangent","curveTightness","curveVertex","day","degrees","directionalLight","disableContextMenu","dist","draw","ellipse","ellipseMode","emissive","enableContextMenu","endCamera","endDraw","endShape","exit","exp","expand","externals","fill","filter","floor","focused","frameCount","frameRate","frustum","get","glyphLook","glyphTable","green","height","hex","hint","hour","hue","image","imageMode","intersect","join","key","keyCode","keyPressed","keyReleased","keyTyped","lerp","lerpColor","lightFalloff","lights","lightSpecular","line","link","loadBytes","loadFont","loadGlyphs","loadImage","loadPixels","loadShape","loadXML","loadStrings","log","loop","mag","map","match","matchAll","max","millis","min","minute","mix","modelX","modelY","modelZ","modes","month","mouseButton","mouseClicked","mouseDragged","mouseMoved","mouseOut","mouseOver","mousePressed","mouseReleased","mouseScroll","mouseScrolled","mouseX","mouseY","name","nf","nfc","nfp","nfs","noCursor","noFill","noise","noiseDetail","noiseSeed","noLights","noLoop","norm","normal","noSmooth","noStroke","noTint","ortho","param","parseBoolean","parseByte","parseChar","parseFloat","parseInt","peg","perspective","PImage","pixels","PMatrix2D","PMatrix3D","PMatrixStack","pmouseX","pmouseY","point","pointLight","popMatrix","popStyle","pow","print","printCamera","println","printMatrix","printProjection","PShape","PShapeSVG","pushMatrix","pushStyle","quad","radians","random","randomGaussian","randomSeed","rect","rectMode","red","redraw","requestImage","resetMatrix","reverse","rotate","rotateX","rotateY","rotateZ","round","saturation","save","saveFrame","saveStrings","scale","screenX","screenY","screenZ","second","set","setup","shape","shapeMode","shared","shearX","shearY","shininess","shorten","sin","size","smooth","sort","specular","sphere","sphereDetail","splice","split","splitTokens","spotLight","sq","sqrt","status","str","stroke","strokeCap","strokeJoin","strokeWeight","subset","tan","text","textAlign","textAscent","textDescent","textFont","textLeading","textMode","textSize","texture","textureMode","textWidth","tint","toImageData","touchCancel","touchEnd","touchMove","touchStart","translate","transform","triangle","trim","unbinary","unhex","updatePixels","use3DContext","vertex","width","XMLElement","XML","year","__contains","__equals","__equalsIgnoreCase","__frameRate","__hashCode","__int_cast","__instanceof","__keyPressed","__mousePressed","__printStackTrace","__replace","__replaceAll","__replaceFirst","__toCharArray","__split","__codePointAt","__startsWith","__endsWith","__matches"];aFunctions&&Object.keys(aFunctions).forEach(function(name){names.push(name)});var i,l,members={};for(i=0,l=names.length;l>i;++i)members[names[i]]=null;for(var lib in Processing.lib)if(Processing.lib.hasOwnProperty(lib)&&Processing.lib[lib].exports){var exportedNames=Processing.lib[lib].exports;for(i=0,l=exportedNames.length;l>i;++i)members[exportedNames[i]]=null}return members}function parseProcessing(code){function splitToAtoms(code){for(var atoms=[],items=code.split(/([\{\[\(\)\]\}])/),result=items[0],stack=[],i=1;i<items.length;i+=2){var item=items[i];if("["===item||"{"===item||"("===item)stack.push(result),result=item;else if("]"===item||"}"===item||")"===item){var kind="}"===item?"A":")"===item?"B":"C",index=atoms.length;atoms.push(result+item),result=stack.pop()+'"'+kind+(index+1)+'"'}result+=items[i+1]}return atoms.unshift(result),atoms}function injectStrings(code,strings){return code.replace(/'(\d+)'/g,function(all,index){var val=strings[index];return"/"===val.charAt(0)?val:/^'((?:[^'\\\n])|(?:\\.[0-9A-Fa-f]*))'$/.test(val)?"(new $p.Character("+val+"))":val})}function trimSpaces(string){var result,m1=/^\s*/.exec(string);if(m1[0].length===string.length)result={left:m1[0],middle:"",right:""};else{var m2=/\s*$/.exec(string);result={left:m1[0],middle:string.substring(m1[0].length,m2.index),right:m2[0]}}return result.untrim=function(t){return this.left+t+this.right},result}function trim(string){return string.replace(/^\s+/,"").replace(/\s+$/,"")}function appendToLookupTable(table,array){for(var i=0,l=array.length;l>i;++i)table[array[i]]=null;return table}function isLookupTableEmpty(table){for(var i in table)if(table.hasOwnProperty(i))return!1;return!0}function getAtomIndex(templ){return templ.substring(2,templ.length-1)}function addAtom(text,type){var lastIndex=atoms.length;return atoms.push(text),'"'+type+lastIndex+'"'}function generateClassId(){return"class"+ ++classIdSeed}function appendClass(class_,classId,scopeId){class_.classId=classId,class_.scopeId=scopeId,declaredClasses[classId]=class_}function extractClassesAndMethods(code){var s=code;return s=s.replace(classesRegex,function(all){return addAtom(all,"E")}),s=s.replace(methodsRegex,function(all){return addAtom(all,"D")}),s=s.replace(functionsRegex,function(all){return addAtom(all,"H")})}function extractConstructors(code,className){var result=code.replace(cstrsRegex,function(all,attr,name){return name!==className?all:addAtom(all,"G")});return result}function AstParam(name){this.name=name}function AstParams(params,methodArgsParam){this.params=params,this.methodArgsParam=methodArgsParam}function transformParams(params){var paramsWoPars=trim(params.substring(1,params.length-1)),result=[],methodArgsParam=null;if(""!==paramsWoPars)for(var paramList=paramsWoPars.split(","),i=0;i<paramList.length;++i){var param=/\b([A-Za-z_$][\w$]*\b)(\s*"[ABC][\d]*")*\s*$/.exec(paramList[i]);if(i===paramList.length-1&&paramList[i].indexOf("...")>=0){methodArgsParam=new AstParam(param[1]);break}result.push(new AstParam(param[1]))}return new AstParams(result,methodArgsParam)}function preExpressionTransform(expr){function replacePrototypeMethods(all,subject,method,atomIndex){var atom=atoms[atomIndex];repeatJavaReplacement=!0;var trimmed=trimSpaces(atom.substring(1,atom.length-1));return"__"+method+(""===trimmed.middle?addAtom("("+subject.replace(/\.\s*$/,"")+")","B"):addAtom("("+subject.replace(/\.\s*$/,"")+","+trimmed.middle+")","B"))}function replaceInstanceof(all,subject,type){return repeatJavaReplacement=!0,"__instanceof"+addAtom("("+subject+", "+type+")","B")}var s=expr;s=s.replace(/\bnew\s+([A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*)(?:\s*"C\d+")+\s*("A\d+")/g,function(all,type,init){return init}),s=s.replace(/\bnew\s+([A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*)(?:\s*"B\d+")\s*("A\d+")/g,function(all){return addAtom(all,"F")}),s=s.replace(functionsRegex,function(all){return addAtom(all,"H")}),s=s.replace(/\bnew\s+([A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*)\s*("C\d+"(?:\s*"C\d+")*)/g,function(all,type,index){var args=index.replace(/"C(\d+)"/g,function(all,j){return atoms[j]}).replace(/\[\s*\]/g,"[null]").replace(/\s*\]\s*\[\s*/g,", "),arrayInitializer="{"+args.substring(1,args.length-1)+"}",createArrayArgs="('"+type+"', "+addAtom(arrayInitializer,"A")+")";return"$p.createJavaArray"+addAtom(createArrayArgs,"B")}),s=s.replace(/(\.\s*length)\s*"B\d+"/g,"$1"),s=s.replace(/#([0-9A-Fa-f]{6})\b/g,function(all,digits){return"0xFF"+digits}),s=s.replace(/"B(\d+)"(\s*(?:[\w$']|"B))/g,function(all,index,next){var atom=atoms[index];if(!/^\(\s*[A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*\s*(?:"C\d+"\s*)*\)$/.test(atom))return all;if(/^\(\s*int\s*\)$/.test(atom))return"(int)"+next;var indexParts=atom.split(/"C(\d+)"/g);return indexParts.length>1&&!/^\[\s*\]$/.test(atoms[indexParts[1]])?all:""+next}),s=s.replace(/\(int\)([^,\]\)\}\?\:\*\+\-\/\^\|\%\&\~<\>\=]+)/g,function(all,arg){var trimmed=trimSpaces(arg);return trimmed.untrim("__int_cast("+trimmed.middle+")")}),s=s.replace(/\bsuper(\s*"B\d+")/g,"$$superCstr$1").replace(/\bsuper(\s*\.)/g,"$$super$1"),s=s.replace(/\b0+((\d*)(?:\.[\d*])?(?:[eE][\-\+]?\d+)?[fF]?)\b/,function(all,numberWo0,intPart){return numberWo0===intPart?all:""===intPart?"0"+numberWo0:numberWo0}),s=s.replace(/\b(\.?\d+\.?)[fF]\b/g,"$1"),s=s.replace(/([^\s])%([^=\s])/g,"$1 % $2"),s=s.replace(/\b(frameRate|keyPressed|mousePressed)\b(?!\s*"B)/g,"__$1"),s=s.replace(/\b(boolean|byte|char|float|int)\s*"B/g,function(all,name){return"parse"+name.substring(0,1).toUpperCase()+name.substring(1)+'"B'}),s=s.replace(/\bpixels\b\s*(("C(\d+)")|\.length)?(\s*=(?!=)([^,\]\)\}]+))?/g,function(all,indexOrLength,index,atomIndex,equalsPart,rightSide){if(index){var atom=atoms[atomIndex];return equalsPart?"pixels.setPixel"+addAtom("("+atom.substring(1,atom.length-1)+","+rightSide+")","B"):"pixels.getPixel"+addAtom("("+atom.substring(1,atom.length-1)+")","B")}return indexOrLength?"pixels.getLength"+addAtom("()","B"):equalsPart?"pixels.set"+addAtom("("+rightSide+")","B"):"pixels.toArray"+addAtom("()","B")});var repeatJavaReplacement;do repeatJavaReplacement=!1,s=s.replace(/((?:'\d+'|\b[A-Za-z_$][\w$]*\s*(?:"[BC]\d+")*)\s*\.\s*(?:[A-Za-z_$][\w$]*\s*(?:"[BC]\d+"\s*)*\.\s*)*)(replace|replaceAll|replaceFirst|contains|equals|equalsIgnoreCase|hashCode|toCharArray|printStackTrace|split|startsWith|endsWith|codePointAt|matches)\s*"B(\d+)"/g,replacePrototypeMethods);while(repeatJavaReplacement);do repeatJavaReplacement=!1,s=s.replace(/((?:'\d+'|\b[A-Za-z_$][\w$]*\s*(?:"[BC]\d+")*)\s*(?:\.\s*[A-Za-z_$][\w$]*\s*(?:"[BC]\d+"\s*)*)*)instanceof\s+([A-Za-z_$][\w$]*\s*(?:\.\s*[A-Za-z_$][\w$]*)*)/g,replaceInstanceof);while(repeatJavaReplacement);return s=s.replace(/\bthis(\s*"B\d+")/g,"$$constr$1")}function AstInlineClass(baseInterfaceName,body){this.baseInterfaceName=baseInterfaceName,this.body=body,body.owner=this}function transformInlineClass(class_){var m=new RegExp(/\bnew\s*([A-Za-z_$][\w$]*\s*(?:\.\s*[A-Za-z_$][\w$]*)*)\s*"B\d+"\s*"A(\d+)"/).exec(class_),oldClassId=currentClassId,newClassId=generateClassId();currentClassId=newClassId;var uniqueClassName=m[1]+"$"+newClassId,inlineClass=new AstInlineClass(uniqueClassName,transformClassBody(atoms[m[2]],uniqueClassName,"","implements "+m[1]));return appendClass(inlineClass,newClassId,oldClassId),currentClassId=oldClassId,inlineClass}function AstFunction(name,params,body){this.name=name,this.params=params,this.body=body}function transformFunction(class_){var m=new RegExp(/\b([A-Za-z_$][\w$]*)\s*"B(\d+)"\s*"A(\d+)"/).exec(class_);return new AstFunction("function"!==m[1]?m[1]:null,transformParams(atoms[m[2]]),transformStatementsBlock(atoms[m[3]]))}function AstInlineObject(members){this.members=members}function transformInlineObject(obj){for(var members=obj.split(","),i=0;i<members.length;++i){var label=members[i].indexOf(":");members[i]=0>label?{value:transformExpression(members[i])}:{label:trim(members[i].substring(0,label)),value:transformExpression(trim(members[i].substring(label+1)))}}return new AstInlineObject(members)}function expandExpression(expr){if("("===expr.charAt(0)||"["===expr.charAt(0))return expr.charAt(0)+expandExpression(expr.substring(1,expr.length-1))+expr.charAt(expr.length-1);if("{"===expr.charAt(0))return/^\{\s*(?:[A-Za-z_$][\w$]*|'\d+')\s*:/.test(expr)?"{"+addAtom(expr.substring(1,expr.length-1),"I")+"}":"["+expandExpression(expr.substring(1,expr.length-1))+"]";var trimmed=trimSpaces(expr),result=preExpressionTransform(trimmed.middle);return result=result.replace(/"[ABC](\d+)"/g,function(all,index){return expandExpression(atoms[index])}),trimmed.untrim(result)}function replaceContextInVars(expr){return expr.replace(/(\.\s*)?((?:\b[A-Za-z_]|\$)[\w$]*)(\s*\.\s*([A-Za-z_$][\w$]*)(\s*\()?)?/g,function(all,memberAccessSign,identifier,suffix,subMember,callSign){if(memberAccessSign)return all;var subject={name:identifier,member:subMember,callSign:!!callSign};return replaceContext(subject)+(suffix===undef?"":suffix)})}function AstExpression(expr,transforms){this.expr=expr,this.transforms=transforms}function AstVarDefinition(name,value,isDefault){this.name=name,this.value=value,this.isDefault=isDefault}function transformVarDefinition(def,defaultTypeValue){var name,value,isDefault,eqIndex=def.indexOf("=");return 0>eqIndex?(name=def,value=defaultTypeValue,isDefault=!0):(name=def.substring(0,eqIndex),value=transformExpression(def.substring(eqIndex+1)),isDefault=!1),new AstVarDefinition(trim(name.replace(/(\s*"C\d+")+/g,"")),value,isDefault)}function getDefaultValueForType(type){return"int"===type||"float"===type?"0":"boolean"===type?"false":"color"===type?"0x00000000":"null"}function AstVar(definitions,varType){this.definitions=definitions,this.varType=varType}function AstStatement(expression){this.expression=expression}function transformStatement(statement){if(fieldTest.test(statement)){for(var attrAndType=attrAndTypeRegex.exec(statement),definitions=statement.substring(attrAndType[0].length).split(","),defaultTypeValue=getDefaultValueForType(attrAndType[2]),i=0;i<definitions.length;++i)definitions[i]=transformVarDefinition(definitions[i],defaultTypeValue);return new AstVar(definitions,attrAndType[2])}return new AstStatement(transformExpression(statement))}function AstForExpression(initStatement,condition,step){this.initStatement=initStatement,this.condition=condition,this.step=step}function AstForInExpression(initStatement,container){this.initStatement=initStatement,this.container=container}function AstForEachExpression(initStatement,container){this.initStatement=initStatement,this.container=container}function transformForExpression(expr){var content;return/\bin\b/.test(expr)?(content=expr.substring(1,expr.length-1).split(/\bin\b/g),new AstForInExpression(transformStatement(trim(content[0])),transformExpression(content[1]))):expr.indexOf(":")>=0&&expr.indexOf(";")<0?(content=expr.substring(1,expr.length-1).split(":"),new AstForEachExpression(transformStatement(trim(content[0])),transformExpression(content[1]))):(content=expr.substring(1,expr.length-1).split(";"),new AstForExpression(transformStatement(trim(content[0])),transformExpression(content[1]),transformExpression(content[2])))}function sortByWeight(array){array.sort(function(a,b){return b.weight-a.weight})}function AstInnerInterface(name,body,isStatic){this.name=name,this.body=body,this.isStatic=isStatic,body.owner=this}function AstInnerClass(name,body,isStatic){this.name=name,this.body=body,this.isStatic=isStatic,body.owner=this}function transformInnerClass(class_){var m=classesRegex.exec(class_);classesRegex.lastIndex=0;var innerClass,isStatic=m[1].indexOf("static")>=0,body=atoms[getAtomIndex(m[6])],oldClassId=currentClassId,newClassId=generateClassId();return currentClassId=newClassId,innerClass="interface"===m[2]?new AstInnerInterface(m[3],transformInterfaceBody(body,m[3],m[4]),isStatic):new AstInnerClass(m[3],transformClassBody(body,m[3],m[4],m[5]),isStatic),appendClass(innerClass,newClassId,oldClassId),currentClassId=oldClassId,innerClass}function AstClassMethod(name,params,body,isStatic){this.name=name,this.params=params,this.body=body,this.isStatic=isStatic}function transformClassMethod(method){var m=methodsRegex.exec(method);methodsRegex.lastIndex=0;var isStatic=m[1].indexOf("static")>=0,body=";"!==m[6]?atoms[getAtomIndex(m[6])]:"{}";return new AstClassMethod(m[3],transformParams(atoms[getAtomIndex(m[4])]),transformStatementsBlock(body),isStatic)}function AstClassField(definitions,fieldType,isStatic){this.definitions=definitions,this.fieldType=fieldType,this.isStatic=isStatic}function transformClassField(statement){for(var attrAndType=attrAndTypeRegex.exec(statement),isStatic=attrAndType[1].indexOf("static")>=0,definitions=statement.substring(attrAndType[0].length).split(/,\s*/g),defaultTypeValue=getDefaultValueForType(attrAndType[2]),i=0;i<definitions.length;++i)definitions[i]=transformVarDefinition(definitions[i],defaultTypeValue);return new AstClassField(definitions,attrAndType[2],isStatic)}function AstConstructor(params,body){this.params=params,this.body=body}function transformConstructor(cstr){var m=new RegExp(/"B(\d+)"\s*"A(\d+)"/).exec(cstr),params=transformParams(atoms[m[1]]);return new AstConstructor(params,transformStatementsBlock(atoms[m[2]]))}function AstInterfaceBody(name,interfacesNames,methodsNames,fields,innerClasses,misc){var i,l;for(this.name=name,this.interfacesNames=interfacesNames,this.methodsNames=methodsNames,this.fields=fields,this.innerClasses=innerClasses,this.misc=misc,i=0,l=fields.length;l>i;++i)fields[i].owner=this}function AstClassBody(name,baseClassName,interfacesNames,functions,methods,fields,cstrs,innerClasses,misc){var i,l;for(this.name=name,this.baseClassName=baseClassName,this.interfacesNames=interfacesNames,this.functions=functions,this.methods=methods,this.fields=fields,this.cstrs=cstrs,this.innerClasses=innerClasses,this.misc=misc,i=0,l=fields.length;l>i;++i)fields[i].owner=this}function AstInterface(name,body){this.name=name,this.body=body,body.owner=this}function AstClass(name,body){this.name=name,this.body=body,body.owner=this}function transformGlobalClass(class_){var m=classesRegex.exec(class_);classesRegex.lastIndex=0;var body=atoms[getAtomIndex(m[6])],oldClassId=currentClassId,newClassId=generateClassId();currentClassId=newClassId;var globalClass;return globalClass="interface"===m[2]?new AstInterface(m[3],transformInterfaceBody(body,m[3],m[4])):new AstClass(m[3],transformClassBody(body,m[3],m[4],m[5])),appendClass(globalClass,newClassId,oldClassId),currentClassId=oldClassId,globalClass}function AstMethod(name,params,body){this.name=name,this.params=params,this.body=body}function transformGlobalMethod(method){{var m=methodsRegex.exec(method);methodsRegex.lastIndex=0}return new AstMethod(m[3],transformParams(atoms[getAtomIndex(m[4])]),transformStatementsBlock(atoms[getAtomIndex(m[6])]))}function preStatementsTransform(statements){var s=statements;return s=s.replace(/\b(catch\s*"B\d+"\s*"A\d+")(\s*catch\s*"B\d+"\s*"A\d+")+/g,"$1")}function AstForStatement(argument,misc){this.argument=argument,this.misc=misc}function AstCatchStatement(argument,misc){this.argument=argument,this.misc=misc}function AstPrefixStatement(name,argument,misc){this.name=name,this.argument=argument,this.misc=misc}function AstSwitchCase(expr){this.expr=expr}function AstLabel(label){this.label=label}function getLocalNames(statements){for(var localNames=[],i=0,l=statements.length;l>i;++i){var statement=statements[i];statement instanceof AstVar?localNames=localNames.concat(statement.getNames()):statement instanceof AstForStatement&&statement.argument.initStatement instanceof AstVar?localNames=localNames.concat(statement.argument.initStatement.getNames()):(statement instanceof AstInnerInterface||statement instanceof AstInnerClass||statement instanceof AstInterface||statement instanceof AstClass||statement instanceof AstMethod||statement instanceof AstFunction)&&localNames.push(statement.name)}return appendToLookupTable({},localNames)}function AstStatementsBlock(statements){this.statements=statements}function AstRoot(statements){this.statements=statements}function generateMetadata(){function findInScopes(class_,name){for(var found,parts=name.split("."),currentScope=class_.scope;currentScope;){if(currentScope.hasOwnProperty(parts[0])){found=currentScope[parts[0]];break}currentScope=currentScope.scope}found===undef&&(found=globalScope[parts[0]]);for(var i=1,l=parts.length;l>i&&found;++i)found=found.inScope[parts[i]];return found}var id,class_,globalScope={};for(id in declaredClasses)if(declaredClasses.hasOwnProperty(id)){class_=declaredClasses[id];var scopeId=class_.scopeId,name=class_.name;if(scopeId){var scope=declaredClasses[scopeId];class_.scope=scope,scope.inScope===undef&&(scope.inScope={}),scope.inScope[name]=class_}else globalScope[name]=class_}for(id in declaredClasses)if(declaredClasses.hasOwnProperty(id)){class_=declaredClasses[id];var baseClassName=class_.body.baseClassName;if(baseClassName){var parent=findInScopes(class_,baseClassName);parent&&(class_.base=parent,parent.derived||(parent.derived=[]),parent.derived.push(class_))}var i,l,interfacesNames=class_.body.interfacesNames,interfaces=[];if(interfacesNames&&interfacesNames.length>0){for(i=0,l=interfacesNames.length;l>i;++i){var interface_=findInScopes(class_,interfacesNames[i]);interfaces.push(interface_),interface_&&(interface_.derived||(interface_.derived=[]),interface_.derived.push(class_))}interfaces.length>0&&(class_.interfaces=interfaces)}}}function setWeight(){function removeDependentAndCheck(targetId,from){var dependsOn=tocheck[targetId];if(!dependsOn)return!1;var i=dependsOn.indexOf(from);return 0>i?!1:(dependsOn.splice(i,1),dependsOn.length>0?!1:(delete tocheck[targetId],!0))}var id,scopeId,class_,queue=[],tocheck={};for(id in declaredClasses)if(declaredClasses.hasOwnProperty(id))if(class_=declaredClasses[id],class_.inScope||class_.derived){var dependsOn=[];if(class_.inScope)for(scopeId in class_.inScope)class_.inScope.hasOwnProperty(scopeId)&&dependsOn.push(class_.inScope[scopeId]);class_.derived&&(dependsOn=dependsOn.concat(class_.derived)),tocheck[id]=dependsOn}else queue.push(id),class_.weight=0;for(;queue.length>0;)if(id=queue.shift(),class_=declaredClasses[id],class_.scopeId&&removeDependentAndCheck(class_.scopeId,class_)&&(queue.push(class_.scopeId),declaredClasses[class_.scopeId].weight=class_.weight+1),class_.base&&removeDependentAndCheck(class_.base.classId,class_)&&(queue.push(class_.base.classId),class_.base.weight=class_.weight+1),class_.interfaces){var i,l;for(i=0,l=class_.interfaces.length;l>i;++i)class_.interfaces[i]&&removeDependentAndCheck(class_.interfaces[i].classId,class_)&&(queue.push(class_.interfaces[i].classId),class_.interfaces[i].weight=class_.weight+1)}}var globalMembers=getGlobalMembers(),codeWoExtraCr=code.replace(/\r\n?|\n\r/g,"\n"),strings=[],codeWoStrings=codeWoExtraCr.replace(/("(?:[^"\\\n]|\\.)*")|('(?:[^'\\\n]|\\.)*')|(([\[\(=|&!\^:?]\s*)(\/(?![*\/])(?:[^\/\\\n]|\\.)*\/[gim]*)\b)|(\/\/[^\n]*\n)|(\/\*(?:(?!\*\/)(?:.|\n))*\*\/)/g,function(all,quoted,aposed,regexCtx,prefix,regex,singleComment,comment){var index;return quoted||aposed?(index=strings.length,strings.push(all),"'"+index+"'"):regexCtx?(index=strings.length,strings.push(regex),prefix+"'"+index+"'"):""!==comment?" ":"\n"});codeWoStrings=codeWoStrings.replace(/__x([0-9A-F]{4})/g,function(all,hexCode){return"__x005F_x"+hexCode}),codeWoStrings=codeWoStrings.replace(/\$/g,"__x0024"),codeWoStrings=codeWoStrings.replace(/return\s*[\n\r]+/g,"return ");var genericsWereRemoved,codeWoGenerics=codeWoStrings,replaceFunc=function(all,before,types,after){return before||after?all:(genericsWereRemoved=!0,"")};do genericsWereRemoved=!1,codeWoGenerics=codeWoGenerics.replace(/([<]?)<\s*((?:\?|[A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*)(?:\[\])*(?:\s+(?:extends|super)\s+[A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*)?(?:\s*,\s*(?:\?|[A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*)(?:\[\])*(?:\s+(?:extends|super)\s+[A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*)?)*)\s*>([=]?)/g,replaceFunc);while(genericsWereRemoved);var replaceContext,currentClassId,transformClassBody,transformInterfaceBody,transformStatementsBlock,transformStatements,transformMain,transformExpression,atoms=splitToAtoms(codeWoGenerics),declaredClasses={},classIdSeed=0,classesRegex=/\b((?:(?:public|private|final|protected|static|abstract)\s+)*)(class|interface)\s+([A-Za-z_$][\w$]*\b)(\s+extends\s+[A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*(?:\s*,\s*[A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*\b)*)?(\s+implements\s+[A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*(?:\s*,\s*[A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*\b)*)?\s*("A\d+")/g,methodsRegex=/\b((?:(?:public|private|final|protected|static|abstract|synchronized)\s+)*)((?!(?:else|new|return|throw|function|public|private|protected)\b)[A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*(?:\s*"C\d+")*)\s*([A-Za-z_$][\w$]*\b)\s*("B\d+")(\s*throws\s+[A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*(?:\s*,\s*[A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*)*)?\s*("A\d+"|;)/g,fieldTest=/^((?:(?:public|private|final|protected|static)\s+)*)((?!(?:else|new|return|throw)\b)[A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*(?:\s*"C\d+")*)\s*([A-Za-z_$][\w$]*\b)\s*(?:"C\d+"\s*)*([=,]|$)/,cstrsRegex=/\b((?:(?:public|private|final|protected|static|abstract)\s+)*)((?!(?:new|return|throw)\b)[A-Za-z_$][\w$]*\b)\s*("B\d+")(\s*throws\s+[A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*(?:\s*,\s*[A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*)*)?\s*("A\d+")/g,attrAndTypeRegex=/^((?:(?:public|private|final|protected|static)\s+)*)((?!(?:new|return|throw)\b)[A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*(?:\s*"C\d+")*)\s*/,functionsRegex=/\bfunction(?:\s+([A-Za-z_$][\w$]*))?\s*("B\d+")\s*("A\d+")/g;AstParam.prototype.toString=function(){return this.name},AstParams.prototype.getNames=function(){for(var names=[],i=0,l=this.params.length;l>i;++i)names.push(this.params[i].name);
return names},AstParams.prototype.prependMethodArgs=function(body){return this.methodArgsParam?"{\nvar "+this.methodArgsParam.name+" = Array.prototype.slice.call(arguments, "+this.params.length+");\n"+body.substring(1):body},AstParams.prototype.toString=function(){if(0===this.params.length)return"()";for(var result="(",i=0,l=this.params.length;l>i;++i)result+=this.params[i]+", ";return result.substring(0,result.length-2)+")"},AstInlineClass.prototype.toString=function(){return"new ("+this.body+")"},AstFunction.prototype.toString=function(){var oldContext=replaceContext,names=appendToLookupTable({"this":null},this.params.getNames());replaceContext=function(subject){return names.hasOwnProperty(subject.name)?subject.name:oldContext(subject)};var result="function";this.name&&(result+=" "+this.name);var body=this.params.prependMethodArgs(this.body.toString());return result+=this.params+" "+body,replaceContext=oldContext,result},AstInlineObject.prototype.toString=function(){var oldContext=replaceContext;replaceContext=function(subject){return"this"===subject.name?"this":oldContext(subject)};for(var result="",i=0,l=this.members.length;l>i;++i)this.members[i].label&&(result+=this.members[i].label+": "),result+=this.members[i].value.toString()+", ";return replaceContext=oldContext,result.substring(0,result.length-2)},AstExpression.prototype.toString=function(){var transforms=this.transforms,expr=replaceContextInVars(this.expr);return expr.replace(/"!(\d+)"/g,function(all,index){return transforms[index].toString()})},transformExpression=function(expr){var transforms=[],s=expandExpression(expr);return s=s.replace(/"H(\d+)"/g,function(all,index){return transforms.push(transformFunction(atoms[index])),'"!'+(transforms.length-1)+'"'}),s=s.replace(/"F(\d+)"/g,function(all,index){return transforms.push(transformInlineClass(atoms[index])),'"!'+(transforms.length-1)+'"'}),s=s.replace(/"I(\d+)"/g,function(all,index){return transforms.push(transformInlineObject(atoms[index])),'"!'+(transforms.length-1)+'"'}),new AstExpression(s,transforms)},AstVarDefinition.prototype.toString=function(){return this.name+" = "+this.value},AstVar.prototype.getNames=function(){for(var names=[],i=0,l=this.definitions.length;l>i;++i)names.push(this.definitions[i].name);return names},AstVar.prototype.toString=function(){return"var "+this.definitions.join(",")},AstStatement.prototype.toString=function(){return this.expression.toString()},AstForExpression.prototype.toString=function(){return"("+this.initStatement+"; "+this.condition+"; "+this.step+")"},AstForInExpression.prototype.toString=function(){var init=this.initStatement.toString();return init.indexOf("=")>=0&&(init=init.substring(0,init.indexOf("="))),"("+init+" in "+this.container+")"},AstForEachExpression.iteratorId=0,AstForEachExpression.prototype.toString=function(){var init=this.initStatement.toString(),iterator="$it"+AstForEachExpression.iteratorId++,variableName=init.replace(/^\s*var\s*/,"").split("=")[0],initIteratorAndVariable="var "+iterator+" = new $p.ObjectIterator("+this.container+"), "+variableName+" = void(0)",nextIterationCondition=iterator+".hasNext() && (("+variableName+" = "+iterator+".next()) || true)";return"("+initIteratorAndVariable+"; "+nextIterationCondition+";)"},AstInnerInterface.prototype.toString=function(){return""+this.body},AstInnerClass.prototype.toString=function(){return""+this.body},AstClassMethod.prototype.toString=function(){var paramNames=appendToLookupTable({},this.params.getNames()),oldContext=replaceContext;replaceContext=function(subject){return paramNames.hasOwnProperty(subject.name)?subject.name:oldContext(subject)};var body=this.params.prependMethodArgs(this.body.toString()),result="function "+this.methodId+this.params+" "+body+"\n";return replaceContext=oldContext,result},AstClassField.prototype.getNames=function(){for(var names=[],i=0,l=this.definitions.length;l>i;++i)names.push(this.definitions[i].name);return names},AstClassField.prototype.toString=function(){var thisPrefix=replaceContext({name:"[this]"});if(this.isStatic){for(var className=this.owner.name,staticDeclarations=[],i=0,l=this.definitions.length;l>i;++i){var definition=this.definitions[i],name=definition.name,staticName=className+"."+name,declaration="if("+staticName+" === void(0)) {\n "+staticName+" = "+definition.value+"; }\n$p.defineProperty("+thisPrefix+", '"+name+"', { get: function(){return "+staticName+";}, set: function(val){"+staticName+" = val;} });\n";staticDeclarations.push(declaration)}return staticDeclarations.join("")}return thisPrefix+"."+this.definitions.join("; "+thisPrefix+".")},AstConstructor.prototype.toString=function(){var paramNames=appendToLookupTable({},this.params.getNames()),oldContext=replaceContext;replaceContext=function(subject){return paramNames.hasOwnProperty(subject.name)?subject.name:oldContext(subject)};var prefix="function $constr_"+this.params.params.length+this.params.toString(),body=this.params.prependMethodArgs(this.body.toString());return/\$(superCstr|constr)\b/.test(body)||(body="{\n$superCstr();\n"+body.substring(1)),replaceContext=oldContext,prefix+body+"\n"},AstInterfaceBody.prototype.getMembers=function(classFields,classMethods,classInners){this.owner.base&&this.owner.base.body.getMembers(classFields,classMethods,classInners);var i,j,l,m;for(i=0,l=this.fields.length;l>i;++i){var fieldNames=this.fields[i].getNames();for(j=0,m=fieldNames.length;m>j;++j)classFields[fieldNames[j]]=this.fields[i]}for(i=0,l=this.methodsNames.length;l>i;++i){var methodName=this.methodsNames[i];classMethods[methodName]=!0}for(i=0,l=this.innerClasses.length;l>i;++i){var innerClass=this.innerClasses[i];classInners[innerClass.name]=innerClass}},AstInterfaceBody.prototype.toString=function(){function getScopeLevel(p){for(var i=0;p;)++i,p=p.scope;return i}var className=(getScopeLevel(this.owner),this.name),staticDefinitions="",metadata="",thisClassFields={},thisClassMethods={},thisClassInners={};this.getMembers(thisClassFields,thisClassMethods,thisClassInners);var i,l;if(this.owner.interfaces){var resolvedInterface,resolvedInterfaces=[];for(i=0,l=this.interfacesNames.length;l>i;++i)this.owner.interfaces[i]&&(resolvedInterface=replaceContext({name:this.interfacesNames[i]}),resolvedInterfaces.push(resolvedInterface),staticDefinitions+="$p.extendInterfaceMembers("+className+", "+resolvedInterface+");\n");metadata+=className+".$interfaces = ["+resolvedInterfaces.join(", ")+"];\n"}for(metadata+=className+".$isInterface = true;\n",metadata+=className+".$methods = ['"+this.methodsNames.join("', '")+"'];\n",sortByWeight(this.innerClasses),i=0,l=this.innerClasses.length;l>i;++i){var innerClass=this.innerClasses[i];innerClass.isStatic&&(staticDefinitions+=className+"."+innerClass.name+" = "+innerClass+";\n")}for(i=0,l=this.fields.length;l>i;++i){var field=this.fields[i];field.isStatic&&(staticDefinitions+=className+"."+field.definitions.join(";\n"+className+".")+";\n")}return"(function() {\nfunction "+className+"() { throw 'Unable to create the interface'; }\n"+staticDefinitions+metadata+"return "+className+";\n})()"},transformInterfaceBody=function(body,name,baseInterfaces){var declarations=body.substring(1,body.length-1);declarations=extractClassesAndMethods(declarations),declarations=extractConstructors(declarations,name);var methodsNames=[],classes=[];declarations=declarations.replace(/"([DE])(\d+)"/g,function(all,type,index){return"D"===type?methodsNames.push(index):"E"===type&&classes.push(index),""});var baseInterfaceNames,i,l,fields=declarations.split(/;(?:\s*;)*/g);for(baseInterfaces!==undef&&(baseInterfaceNames=baseInterfaces.replace(/^\s*extends\s+(.+?)\s*$/g,"$1").split(/\s*,\s*/g)),i=0,l=methodsNames.length;l>i;++i){var method=transformClassMethod(atoms[methodsNames[i]]);methodsNames[i]=method.name}for(i=0,l=fields.length-1;l>i;++i){var field=trimSpaces(fields[i]);fields[i]=transformClassField(field.middle)}var tail=fields.pop();for(i=0,l=classes.length;l>i;++i)classes[i]=transformInnerClass(atoms[classes[i]]);return new AstInterfaceBody(name,baseInterfaceNames,methodsNames,fields,classes,{tail:tail})},AstClassBody.prototype.getMembers=function(classFields,classMethods,classInners){this.owner.base&&this.owner.base.body.getMembers(classFields,classMethods,classInners);var i,j,l,m;for(i=0,l=this.fields.length;l>i;++i){var fieldNames=this.fields[i].getNames();for(j=0,m=fieldNames.length;m>j;++j)classFields[fieldNames[j]]=this.fields[i]}for(i=0,l=this.methods.length;l>i;++i){var method=this.methods[i];classMethods[method.name]=method}for(i=0,l=this.innerClasses.length;l>i;++i){var innerClass=this.innerClasses[i];classInners[innerClass.name]=innerClass}},AstClassBody.prototype.toString=function(){function getScopeLevel(p){for(var i=0;p;)++i,p=p.scope;return i}var scopeLevel=getScopeLevel(this.owner),selfId="$this_"+scopeLevel,className=this.name,result="var "+selfId+" = this;\n",staticDefinitions="",metadata="",thisClassFields={},thisClassMethods={},thisClassInners={};this.getMembers(thisClassFields,thisClassMethods,thisClassInners);var oldContext=replaceContext;replaceContext=function(subject){var name=subject.name;return"this"===name?subject.callSign||!subject.member?selfId+".$self":selfId:thisClassFields.hasOwnProperty(name)?thisClassFields[name].isStatic?className+"."+name:selfId+"."+name:thisClassInners.hasOwnProperty(name)?selfId+"."+name:thisClassMethods.hasOwnProperty(name)?thisClassMethods[name].isStatic?className+"."+name:selfId+".$self."+name:oldContext(subject)};var resolvedBaseClassName;this.baseClassName?(resolvedBaseClassName=oldContext({name:this.baseClassName}),result+="var $super = { $upcast: "+selfId+" };\n",result+="function $superCstr(){"+resolvedBaseClassName+".apply($super,arguments);if(!('$self' in $super)) $p.extendClassChain($super)}\n",metadata+=className+".$base = "+resolvedBaseClassName+";\n"):result+="function $superCstr(){$p.extendClassChain("+selfId+")}\n",this.owner.base&&(staticDefinitions+="$p.extendStaticMembers("+className+", "+resolvedBaseClassName+");\n");var i,l,j,m;if(this.owner.interfaces){var resolvedInterface,resolvedInterfaces=[];for(i=0,l=this.interfacesNames.length;l>i;++i)this.owner.interfaces[i]&&(resolvedInterface=oldContext({name:this.interfacesNames[i]}),resolvedInterfaces.push(resolvedInterface),staticDefinitions+="$p.extendInterfaceMembers("+className+", "+resolvedInterface+");\n");metadata+=className+".$interfaces = ["+resolvedInterfaces.join(", ")+"];\n"}for(this.functions.length>0&&(result+=this.functions.join("\n")+"\n"),sortByWeight(this.innerClasses),i=0,l=this.innerClasses.length;l>i;++i){var innerClass=this.innerClasses[i];innerClass.isStatic?(staticDefinitions+=className+"."+innerClass.name+" = "+innerClass+";\n",result+=selfId+"."+innerClass.name+" = "+className+"."+innerClass.name+";\n"):result+=selfId+"."+innerClass.name+" = "+innerClass+";\n"}for(i=0,l=this.fields.length;l>i;++i){var field=this.fields[i];if(field.isStatic)for(staticDefinitions+=className+"."+field.definitions.join(";\n"+className+".")+";\n",j=0,m=field.definitions.length;m>j;++j){var fieldName=field.definitions[j].name,staticName=className+"."+fieldName;result+="$p.defineProperty("+selfId+", '"+fieldName+"', {get: function(){return "+staticName+"}, set: function(val){"+staticName+" = val}});\n"}else result+=selfId+"."+field.definitions.join(";\n"+selfId+".")+";\n"}var methodOverloads={};for(i=0,l=this.methods.length;l>i;++i){var method=this.methods[i],overload=methodOverloads[method.name],methodId=method.name+"$"+method.params.params.length,hasMethodArgs=!!method.params.methodArgsParam;overload?(++overload,methodId+="_"+overload):overload=1,method.methodId=methodId,methodOverloads[method.name]=overload,method.isStatic?(staticDefinitions+=method,staticDefinitions+="$p.addMethod("+className+", '"+method.name+"', "+methodId+", "+hasMethodArgs+");\n",result+="$p.addMethod("+selfId+", '"+method.name+"', "+methodId+", "+hasMethodArgs+");\n"):(result+=method,result+="$p.addMethod("+selfId+", '"+method.name+"', "+methodId+", "+hasMethodArgs+");\n")}result+=trim(this.misc.tail),this.cstrs.length>0&&(result+=this.cstrs.join("\n")+"\n"),result+="function $constr() {\n";var cstrsIfs=[];for(i=0,l=this.cstrs.length;l>i;++i){var paramsLength=this.cstrs[i].params.params.length,methodArgsPresent=!!this.cstrs[i].params.methodArgsParam;cstrsIfs.push("if(arguments.length "+(methodArgsPresent?">=":"===")+" "+paramsLength+") { $constr_"+paramsLength+".apply("+selfId+", arguments); }")}return cstrsIfs.length>0&&(result+=cstrsIfs.join(" else ")+" else "),result+="$superCstr();\n}\n",result+="$constr.apply(null, arguments);\n",replaceContext=oldContext,"(function() {\nfunction "+className+"() {\n"+result+"}\n"+staticDefinitions+metadata+"return "+className+";\n})()"},transformClassBody=function(body,name,baseName,interfaces){var declarations=body.substring(1,body.length-1);declarations=extractClassesAndMethods(declarations),declarations=extractConstructors(declarations,name);var methods=[],classes=[],cstrs=[],functions=[];declarations=declarations.replace(/"([DEGH])(\d+)"/g,function(all,type,index){return"D"===type?methods.push(index):"E"===type?classes.push(index):"H"===type?functions.push(index):cstrs.push(index),""});var baseClassName,interfacesNames,i,fields=declarations.replace(/^(?:\s*;)+/,"").split(/;(?:\s*;)*/g);for(baseName!==undef&&(baseClassName=baseName.replace(/^\s*extends\s+([A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*)\s*$/g,"$1")),interfaces!==undef&&(interfacesNames=interfaces.replace(/^\s*implements\s+(.+?)\s*$/g,"$1").split(/\s*,\s*/g)),i=0;i<functions.length;++i)functions[i]=transformFunction(atoms[functions[i]]);for(i=0;i<methods.length;++i)methods[i]=transformClassMethod(atoms[methods[i]]);for(i=0;i<fields.length-1;++i){var field=trimSpaces(fields[i]);fields[i]=transformClassField(field.middle)}var tail=fields.pop();for(i=0;i<cstrs.length;++i)cstrs[i]=transformConstructor(atoms[cstrs[i]]);for(i=0;i<classes.length;++i)classes[i]=transformInnerClass(atoms[classes[i]]);return new AstClassBody(name,baseClassName,interfacesNames,functions,methods,fields,cstrs,classes,{tail:tail})},AstInterface.prototype.toString=function(){return"var "+this.name+" = "+this.body+";\n$p."+this.name+" = "+this.name+";\n"},AstClass.prototype.toString=function(){return"var "+this.name+" = "+this.body+";\n$p."+this.name+" = "+this.name+";\n"},AstMethod.prototype.toString=function(){var paramNames=appendToLookupTable({},this.params.getNames()),oldContext=replaceContext;replaceContext=function(subject){return paramNames.hasOwnProperty(subject.name)?subject.name:oldContext(subject)};var body=this.params.prependMethodArgs(this.body.toString()),result="function "+this.name+this.params+" "+body+"\n$p."+this.name+" = "+this.name+";\n"+this.name+" = "+this.name+".bind($p);";return replaceContext=oldContext,result},AstForStatement.prototype.toString=function(){return this.misc.prefix+this.argument.toString()},AstCatchStatement.prototype.toString=function(){return this.misc.prefix+this.argument.toString()},AstPrefixStatement.prototype.toString=function(){var result=this.misc.prefix;return this.argument!==undef&&(result+=this.argument.toString()),result},AstSwitchCase.prototype.toString=function(){return"case "+this.expr+":"},AstLabel.prototype.toString=function(){return this.label},transformStatements=function(statements,transformMethod,transformClass){var nextStatement=new RegExp(/\b(catch|for|if|switch|while|with)\s*"B(\d+)"|\b(do|else|finally|return|throw|try|break|continue)\b|("[ADEH](\d+)")|\b(case)\s+([^:]+):|\b([A-Za-z_$][\w$]*\s*:)|(;)/g),res=[];statements=preStatementsTransform(statements);for(var m,space,lastIndex=0;null!==(m=nextStatement.exec(statements));){if(m[1]!==undef){var i=statements.lastIndexOf('"B',nextStatement.lastIndex),statementsPrefix=statements.substring(lastIndex,i);res.push("for"===m[1]?new AstForStatement(transformForExpression(atoms[m[2]]),{prefix:statementsPrefix}):"catch"===m[1]?new AstCatchStatement(transformParams(atoms[m[2]]),{prefix:statementsPrefix}):new AstPrefixStatement(m[1],transformExpression(atoms[m[2]]),{prefix:statementsPrefix}))}else if(m[3]!==undef)res.push(new AstPrefixStatement(m[3],undef,{prefix:statements.substring(lastIndex,nextStatement.lastIndex)}));else if(m[4]!==undef){if(space=statements.substring(lastIndex,nextStatement.lastIndex-m[4].length),0!==trim(space).length)continue;res.push(space);var kind=m[4].charAt(1),atomIndex=m[5];res.push("D"===kind?transformMethod(atoms[atomIndex]):"E"===kind?transformClass(atoms[atomIndex]):"H"===kind?transformFunction(atoms[atomIndex]):transformStatementsBlock(atoms[atomIndex]))}else if(m[6]!==undef)res.push(new AstSwitchCase(transformExpression(trim(m[7]))));else if(m[8]!==undef){if(space=statements.substring(lastIndex,nextStatement.lastIndex-m[8].length),0!==trim(space).length)continue;res.push(new AstLabel(statements.substring(lastIndex,nextStatement.lastIndex)))}else{var statement=trimSpaces(statements.substring(lastIndex,nextStatement.lastIndex-1));res.push(statement.left),res.push(transformStatement(statement.middle)),res.push(statement.right+";")}lastIndex=nextStatement.lastIndex}var statementsTail=trimSpaces(statements.substring(lastIndex));return res.push(statementsTail.left),""!==statementsTail.middle&&(res.push(transformStatement(statementsTail.middle)),res.push(";"+statementsTail.right)),res},AstStatementsBlock.prototype.toString=function(){var localNames=getLocalNames(this.statements),oldContext=replaceContext;isLookupTableEmpty(localNames)||(replaceContext=function(subject){return localNames.hasOwnProperty(subject.name)?subject.name:oldContext(subject)});var result="{\n"+this.statements.join("")+"\n}";return replaceContext=oldContext,result},transformStatementsBlock=function(block){var content=trimSpaces(block.substring(1,block.length-1));return new AstStatementsBlock(transformStatements(content.middle))},AstRoot.prototype.toString=function(){for(var statement,classes=[],otherStatements=[],i=0,len=this.statements.length;len>i;++i)statement=this.statements[i],statement instanceof AstClass||statement instanceof AstInterface?classes.push(statement):otherStatements.push(statement);sortByWeight(classes);var localNames=getLocalNames(this.statements);replaceContext=function(subject){var name=subject.name;return localNames.hasOwnProperty(name)?name:globalMembers.hasOwnProperty(name)||PConstants.hasOwnProperty(name)||defaultScope.hasOwnProperty(name)?"$p."+name:name};var result="// this code was autogenerated from PJS\n(function($p) {\n"+classes.join("")+"\n"+otherStatements.join("")+"\n})";return replaceContext=null,result},transformMain=function(){var statements=extractClassesAndMethods(atoms[0]);return statements=statements.replace(/\bimport\s+[^;]+;/g,""),new AstRoot(transformStatements(statements,transformGlobalMethod,transformGlobalClass))};var transformed=transformMain();generateMetadata(transformed),setWeight(transformed);var redendered=transformed.toString();return redendered=redendered.replace(/\s*\n(?:[\t ]*\n)+/g,"\n\n"),redendered=redendered.replace(/__x([0-9A-F]{4})/g,function(all,hexCode){return String.fromCharCode(parseInt(hexCode,16))}),injectStrings(redendered,strings)}function preprocessCode(aCode,sketch){var dm=new RegExp(/\/\*\s*@pjs\s+((?:[^\*]|\*+[^\*\/])*)\*\//g).exec(aCode);if(dm&&2===dm.length)for(var jsonItems=[],directives=dm.splice(1,2)[0].replace(/\{([\s\S]*?)\}/g,function(){return function(all,item){return jsonItems.push(item),"{"+(jsonItems.length-1)+"}"}}()).replace("\n","").replace("\r","").split(";"),clean=function(s){return s.replace(/^\s*["']?/,"").replace(/["']?\s*$/,"")},i=0,dl=directives.length;dl>i;i++){var pair=directives[i].split("=");if(pair&&2===pair.length){var key=clean(pair[0]),value=clean(pair[1]),list=[];if("preload"===key){list=value.split(",");for(var j=0,jl=list.length;jl>j;j++){var imageName=clean(list[j]);sketch.imageCache.add(imageName)}}else if("font"===key){list=value.split(",");for(var x=0,xl=list.length;xl>x;x++){var fontName=clean(list[x]),index=/^\{(\d*?)\}$/.exec(fontName);PFont.preloading.add(index?JSON.parse("{"+jsonItems[index[1]]+"}"):fontName)}}else"pauseOnBlur"===key?sketch.options.pauseOnBlur="true"===value:"globalKeyEvents"===key?sketch.options.globalKeyEvents="true"===value:"param-"===key.substring(0,6)?sketch.params[key.substring(6)]=value:sketch.options[key]=value}}return aCode}var undef,defaultScope=options.defaultScope,PConstants=defaultScope.PConstants,aFunctions=options.aFunctions,Browser=options.Browser,document=Browser.document;Processing.compile=function(pdeCode){var sketch=new Processing.Sketch,code=preprocessCode(pdeCode,sketch),compiledPde=parseProcessing(code);return sketch.sourceCode=compiledPde,sketch};var PjsConsole=function(document){var e={},added=!1;return e.BufferMax=200,e.wrapper=document.createElement("div"),e.wrapper.setAttribute("style","opacity:.75;display:block;position:fixed;bottom:0px;left:0px;right:0px;height:50px;background-color:#aaa"),e.dragger=document.createElement("div"),e.dragger.setAttribute("style","display:block;border:3px black raised;cursor:n-resize;position:absolute;top:0px;left:0px;right:0px;height:5px;background-color:#333"),e.closer=document.createElement("div"),e.closer.onmouseover=function(){e.closer.style.setProperty("background-color","#ccc")},e.closer.onmouseout=function(){e.closer.style.setProperty("background-color","#ddd")},e.closer.innerHTML="&#10006;",e.closer.setAttribute("style","opacity:.5;display:block;border:3px black raised;position:absolute;top:10px;right:30px;height:20px;width:20px;background-color:#ddd;color:#000;line-height:20px;text-align:center;cursor:pointer;"),e.javaconsole=document.createElement("div"),e.javaconsole.setAttribute("style","overflow-x: auto;display:block;position:absolute;left:10px;right:0px;bottom:5px;top:10px;overflow-y:scroll;height:40px;"),e.wrapper.appendChild(e.dragger),e.wrapper.appendChild(e.javaconsole),e.wrapper.appendChild(e.closer),e.dragger.onmousedown=function(t){e.divheight=e.wrapper.style.height,document.selection?document.selection.empty():window.getSelection().removeAllRanges();var n=t.screenY;window.onmousemove=function(t){e.wrapper.style.height=parseFloat(e.divheight)+(n-t.screenY)+"px",e.javaconsole.style.height=parseFloat(e.divheight)+(n-t.screenY)-10+"px"},window.onmouseup=function(t){document.selection?document.selection.empty():window.getSelection().removeAllRanges(),e.wrapper.style.height=parseFloat(e.divheight)+(n-t.screenY)+"px",e.javaconsole.style.height=parseFloat(e.divheight)+(n-t.screenY)-10+"px",window.onmousemove=null,window.onmouseup=null}},e.BufferArray=[],e.print=e.log=function(t){e.BufferArray[e.BufferArray.length-1]?e.BufferArray[e.BufferArray.length-1]+=t+"":e.BufferArray.push(t),e.javaconsole.innerHTML=e.BufferArray.join(""),"hidden"===e.wrapper.style.visibility&&(e.wrapper.style.visibility="visible"),"hidden"===e.wrapper.style.visibility&&(e.wrapper.style.visibility="visible")},e.println=function(t){added||document.body.appendChild(e.wrapper),e.print(t),e.BufferArray.push("<br/>"),e.javaconsole.innerHTML=e.BufferArray.join(""),"hidden"===e.wrapper.style.visibility&&(e.wrapper.style.visibility="visible"),e.BufferArray.length>e.BufferMax?e.BufferArray.splice(0,1):e.javaconsole.scrollTop=e.javaconsole.scrollHeight,"hidden"===e.wrapper.style.visibility&&(e.wrapper.style.visibility="visible")},e.showconsole=function(){e.wrapper.style.visibility="visible"},e.hideconsole=function(){e.wrapper.style.visibility="hidden"},e.closer.onclick=function(){e.hideconsole()},e.hideconsole(),e};return Processing.logger=new PjsConsole(document),Processing}},{}],26:[function(require,module){module.exports=function(options,undef){function setupTypedArray(name,fallback){return name in window?window[name]:"function"==typeof window[fallback]?window[fallback]:function(obj){if(obj instanceof Array)return obj;if("number"==typeof obj){var arr=[];return arr.length=obj,arr}}}var defaultScope=options.defaultScope,extend=options.extend,Browser=options.Browser,ajax=Browser.ajax,navigator=Browser.navigator,window=Browser.window,document=(window.XMLHttpRequest,Browser.document),noop=options.noop,PConstants=defaultScope.PConstants;PFont=defaultScope.PFont,PShapeSVG=defaultScope.PShapeSVG,PVector=defaultScope.PVector,Char=Character=defaultScope.Char,ObjectIterator=defaultScope.ObjectIterator,XMLElement=defaultScope.XMLElement,XML=defaultScope.XML;{var HTMLCanvasElement=window.HTMLCanvasElement,HTMLImageElement=window.HTMLImageElement;"document"in this&&!("fake"in this.document)}document.head||(document.head=document.getElementsByTagName("head")[0]);var Float32Array=setupTypedArray("Float32Array","WebGLFloatArray"),Int32Array=setupTypedArray("Int32Array","WebGLIntArray"),Uint16Array=setupTypedArray("Uint16Array","WebGLUnsignedShortArray"),Uint8Array=setupTypedArray("Uint8Array","WebGLUnsignedByteArray");if(document.documentMode>=9&&!document.doctype)throw"The doctype directive is missing. The recommended doctype in Internet Explorer is the HTML5 doctype: <!DOCTYPE html>";var processingInstances=[],processingInstanceIds={},addInstance=function(processing){processing.externals.canvas.id!==undef&&processing.externals.canvas.id.length||(processing.externals.canvas.id="__processing"+processingInstances.length),processingInstanceIds[processing.externals.canvas.id]=processingInstances.length,processingInstances.push(processing)},removeInstance=function(id){processingInstances.splice(processingInstanceIds[id],1),delete processingInstanceIds[id]},Processing=this.Processing=function(aCanvas,aCode,aFunctions){function attachEventHandler(elem,type,fn){elem.addEventListener?elem.addEventListener(type,fn,!1):elem.attachEvent("on"+type,fn),eventHandlers.push({elem:elem,type:type,fn:fn})}function detachEventHandler(eventHandler){var elem=eventHandler.elem,type=eventHandler.type,fn=eventHandler.fn;elem.removeEventListener?elem.removeEventListener(type,fn,!1):elem.detachEvent&&elem.detachEvent("on"+type,fn)}function removeFirstArgument(args){return Array.prototype.slice.call(args,1)}function uniformf(cacheId,programObj,varName,varValue){var varLocation=curContextCache.locations[cacheId];varLocation===undef&&(varLocation=curContext.getUniformLocation(programObj,varName),curContextCache.locations[cacheId]=varLocation),null!==varLocation&&(4===varValue.length?curContext.uniform4fv(varLocation,varValue):3===varValue.length?curContext.uniform3fv(varLocation,varValue):2===varValue.length?curContext.uniform2fv(varLocation,varValue):curContext.uniform1f(varLocation,varValue))}function uniformi(cacheId,programObj,varName,varValue){var varLocation=curContextCache.locations[cacheId];varLocation===undef&&(varLocation=curContext.getUniformLocation(programObj,varName),curContextCache.locations[cacheId]=varLocation),null!==varLocation&&(4===varValue.length?curContext.uniform4iv(varLocation,varValue):3===varValue.length?curContext.uniform3iv(varLocation,varValue):2===varValue.length?curContext.uniform2iv(varLocation,varValue):curContext.uniform1i(varLocation,varValue))}function uniformMatrix(cacheId,programObj,varName,transpose,matrix){var varLocation=curContextCache.locations[cacheId];varLocation===undef&&(varLocation=curContext.getUniformLocation(programObj,varName),curContextCache.locations[cacheId]=varLocation),-1!==varLocation&&(16===matrix.length?curContext.uniformMatrix4fv(varLocation,transpose,matrix):9===matrix.length?curContext.uniformMatrix3fv(varLocation,transpose,matrix):curContext.uniformMatrix2fv(varLocation,transpose,matrix))}function vertexAttribPointer(cacheId,programObj,varName,size,VBO){var varLocation=curContextCache.attributes[cacheId];varLocation===undef&&(varLocation=curContext.getAttribLocation(programObj,varName),curContextCache.attributes[cacheId]=varLocation),-1!==varLocation&&(curContext.bindBuffer(curContext.ARRAY_BUFFER,VBO),curContext.vertexAttribPointer(varLocation,size,curContext.FLOAT,!1,0,0),curContext.enableVertexAttribArray(varLocation))}function disableVertexAttribPointer(cacheId,programObj,varName){var varLocation=curContextCache.attributes[cacheId];varLocation===undef&&(varLocation=curContext.getAttribLocation(programObj,varName),curContextCache.attributes[cacheId]=varLocation),-1!==varLocation&&curContext.disableVertexAttribArray(varLocation)}function color$4(aValue1,aValue2,aValue3,aValue4){var r,g,b,a;if(curColorMode===PConstants.HSB){var rgb=p.color.toRGB(aValue1,aValue2,aValue3);r=rgb[0],g=rgb[1],b=rgb[2]}else r=Math.round(255*(aValue1/colorModeX)),g=Math.round(255*(aValue2/colorModeY)),b=Math.round(255*(aValue3/colorModeZ));return a=Math.round(255*(aValue4/colorModeA)),r=0>r?0:r,g=0>g?0:g,b=0>b?0:b,a=0>a?0:a,r=r>255?255:r,g=g>255?255:g,b=b>255?255:b,a=a>255?255:a,a<<24&PConstants.ALPHA_MASK|r<<16&PConstants.RED_MASK|g<<8&PConstants.GREEN_MASK|b&PConstants.BLUE_MASK}function color$2(aValue1,aValue2){var a;return aValue1&PConstants.ALPHA_MASK?(a=Math.round(255*(aValue2/colorModeA)),a=a>255?255:a,a=0>a?0:a,aValue1-(aValue1&PConstants.ALPHA_MASK)+(a<<24&PConstants.ALPHA_MASK)):curColorMode===PConstants.RGB?color$4(aValue1,aValue1,aValue1,aValue2):curColorMode===PConstants.HSB?color$4(0,0,aValue1/colorModeX*colorModeZ,aValue2):void 0}function color$1(aValue1){if(colorModeX>=aValue1&&aValue1>=0){if(curColorMode===PConstants.RGB)return color$4(aValue1,aValue1,aValue1,colorModeA);if(curColorMode===PConstants.HSB)return color$4(0,0,aValue1/colorModeX*colorModeZ,colorModeA)}return aValue1?(aValue1>2147483647&&(aValue1-=4294967296),aValue1):void 0}function colorToHSB(colorInt){var red,green,blue;red=((colorInt&PConstants.RED_MASK)>>>16)/255,green=((colorInt&PConstants.GREEN_MASK)>>>8)/255,blue=(colorInt&PConstants.BLUE_MASK)/255;var hue,saturation,max=p.max(p.max(red,green),blue),min=p.min(p.min(red,green),blue);return min===max?[0,0,max*colorModeZ]:(saturation=(max-min)/max,hue=red===max?(green-blue)/(max-min):green===max?2+(blue-red)/(max-min):4+(red-green)/(max-min),hue/=6,0>hue?hue+=1:hue>1&&(hue-=1),[hue*colorModeX,saturation*colorModeY,max*colorModeZ])}function saveContext(){curContext.save()}function restoreContext(){curContext.restore(),isStrokeDirty=!0,isFillDirty=!0}function redrawHelper(){var sec=(Date.now()-timeSinceLastFPS)/1e3;framesSinceLastFPS++;var fps=framesSinceLastFPS/sec;sec>.5&&(timeSinceLastFPS=Date.now(),framesSinceLastFPS=0,p.__frameRate=fps),p.frameCount++}function unhexScalar(hex){var value=parseInt("0x"+hex,16);return value>2147483647&&(value-=4294967296),value}function booleanScalar(val){return"number"==typeof val?0!==val:"boolean"==typeof val?val:"string"==typeof val?"true"===val.toLowerCase():val instanceof Char?49===val.code||84===val.code||116===val.code:void 0}function floatScalar(val){return"number"==typeof val?val:"boolean"==typeof val?val?1:0:"string"==typeof val?parseFloat(val):val instanceof Char?val.code:void 0}function intScalar(val,radix){if("number"==typeof val)return 4294967295&val;if("boolean"==typeof val)return val?1:0;if("string"==typeof val){var number=parseInt(val,radix||10);return 4294967295&number}return val instanceof Char?val.code:void 0}function executeContextFill(){doFill&&(isFillDirty&&(curContext.fillStyle=p.color.toString(currentFillColor),isFillDirty=!1),curContext.fill())}function executeContextStroke(){doStroke&&(isStrokeDirty&&(curContext.strokeStyle=p.color.toString(currentStrokeColor),isStrokeDirty=!1),curContext.stroke())}function fillStrokeClose(){executeContextFill(),executeContextStroke(),curContext.closePath()}function getCanvasData(obj,w,h){var canvasData=canvasDataCache.shift();canvasData===undef&&(canvasData={},canvasData.canvas=document.createElement("canvas"),canvasData.context=canvasData.canvas.getContext("2d")),canvasDataCache.push(canvasData);var canvas=canvasData.canvas,context=canvasData.context,width=w||obj.width,height=h||obj.height;return canvas.width=width,canvas.height=height,obj?"data"in obj?context.putImageData(obj,0,0):(context.clearRect(0,0,width,height),context.drawImage(obj,0,0,width,height)):context.clearRect(0,0,width,height),canvasData
}function buildPixelsObject(pImage){return{getLength:function(aImg){return function(){if(aImg.isRemote)throw"Image is loaded remotely. Cannot get length.";return aImg.imageData.data.length?aImg.imageData.data.length/4:0}}(pImage),getPixel:function(aImg){return function(i){var offset=4*i,data=aImg.imageData.data;if(aImg.isRemote)throw"Image is loaded remotely. Cannot get pixels.";return data[offset+3]<<24&PConstants.ALPHA_MASK|data[offset]<<16&PConstants.RED_MASK|data[offset+1]<<8&PConstants.GREEN_MASK|data[offset+2]&PConstants.BLUE_MASK}}(pImage),setPixel:function(aImg){return function(i,c){var offset=4*i,data=aImg.imageData.data;if(aImg.isRemote)throw"Image is loaded remotely. Cannot set pixel.";data[offset+0]=(c&PConstants.RED_MASK)>>>16,data[offset+1]=(c&PConstants.GREEN_MASK)>>>8,data[offset+2]=c&PConstants.BLUE_MASK,data[offset+3]=(c&PConstants.ALPHA_MASK)>>>24,aImg.__isDirty=!0}}(pImage),toArray:function(aImg){return function(){var arr=[],data=aImg.imageData.data,length=aImg.width*aImg.height;if(aImg.isRemote)throw"Image is loaded remotely. Cannot get pixels.";for(var i=0,offset=0;length>i;i++,offset+=4)arr.push(data[offset+3]<<24&PConstants.ALPHA_MASK|data[offset]<<16&PConstants.RED_MASK|data[offset+1]<<8&PConstants.GREEN_MASK|data[offset+2]&PConstants.BLUE_MASK);return arr}}(pImage),set:function(aImg){return function(arr){var offset,data,c;if(this.isRemote)throw"Image is loaded remotely. Cannot set pixels.";data=aImg.imageData.data;for(var i=0,aL=arr.length;aL>i;i++)c=arr[i],offset=4*i,data[offset+0]=(c&PConstants.RED_MASK)>>>16,data[offset+1]=(c&PConstants.GREEN_MASK)>>>8,data[offset+2]=c&PConstants.BLUE_MASK,data[offset+3]=(c&PConstants.ALPHA_MASK)>>>24;aImg.__isDirty=!0}}(pImage)}}function get$2(x,y){var data;if(x>=p.width||0>x||0>y||y>=p.height)return 0;if(isContextReplaced){var offset=4*((0|x)+p.width*(0|y));return data=p.imageData.data,data[offset+3]<<24&PConstants.ALPHA_MASK|data[offset]<<16&PConstants.RED_MASK|data[offset+1]<<8&PConstants.GREEN_MASK|data[offset+2]&PConstants.BLUE_MASK}return data=p.toImageData(0|x,0|y,1,1).data,data[3]<<24&PConstants.ALPHA_MASK|data[0]<<16&PConstants.RED_MASK|data[1]<<8&PConstants.GREEN_MASK|data[2]&PConstants.BLUE_MASK}function get$3(x,y,img){if(img.isRemote)throw"Image is loaded remotely. Cannot get x,y.";var offset=y*img.width*4+4*x,data=img.imageData.data;return data[offset+3]<<24&PConstants.ALPHA_MASK|data[offset]<<16&PConstants.RED_MASK|data[offset+1]<<8&PConstants.GREEN_MASK|data[offset+2]&PConstants.BLUE_MASK}function get$4(x,y,w,h){var c=new PImage(w,h,PConstants.ARGB);return c.fromImageData(p.toImageData(x,y,w,h)),c}function get$5(x,y,w,h,img){if(img.isRemote)throw"Image is loaded remotely. Cannot get x,y,w,h.";for(var c=new PImage(w,h,PConstants.ARGB),cData=c.imageData.data,imgWidth=img.width,imgHeight=img.height,imgData=img.imageData.data,startRow=Math.max(0,-y),startColumn=Math.max(0,-x),stopRow=Math.min(h,imgHeight-y),stopColumn=Math.min(w,imgWidth-x),i=startRow;stopRow>i;++i)for(var sourceOffset=4*((y+i)*imgWidth+(x+startColumn)),targetOffset=4*(i*w+startColumn),j=startColumn;stopColumn>j;++j)cData[targetOffset++]=imgData[sourceOffset++],cData[targetOffset++]=imgData[sourceOffset++],cData[targetOffset++]=imgData[sourceOffset++],cData[targetOffset++]=imgData[sourceOffset++];return c.__isDirty=!0,c}function resetContext(){isContextReplaced&&(curContext=originalContext,isContextReplaced=!1,p.updatePixels())}function SetPixelContextWrapper(){function wrapFunction(newContext,name){function wrapper(){resetContext(),curContext[name].apply(curContext,arguments)}newContext[name]=wrapper}function wrapProperty(newContext,name){function getter(){return resetContext(),curContext[name]}function setter(value){resetContext(),curContext[name]=value}p.defineProperty(newContext,name,{get:getter,set:setter})}for(var n in curContext)"function"==typeof curContext[n]?wrapFunction(this,n):wrapProperty(this,n)}function replaceContext(){isContextReplaced||(p.loadPixels(),null===proxyContext&&(originalContext=curContext,proxyContext=new SetPixelContextWrapper),isContextReplaced=!0,curContext=proxyContext,setPixelsCached=0)}function set$3(x,y,c){x<p.width&&x>=0&&y>=0&&y<p.height&&(replaceContext(),p.pixels.setPixel((0|x)+p.width*(0|y),c),++setPixelsCached>maxPixelsCached&&resetContext())}function set$4(x,y,obj,img){if(img.isRemote)throw"Image is loaded remotely. Cannot set x,y.";var c=p.color.toArray(obj),offset=y*img.width*4+4*x,data=img.imageData.data;data[offset]=c[0],data[offset+1]=c[1],data[offset+2]=c[2],data[offset+3]=c[3]}function toP5String(obj){return obj instanceof String?obj:"number"==typeof obj?obj===(0|obj)?obj.toString():p.nf(obj,0,3):null===obj||obj===undef?"":obj.toString()}function text$4(str,x,y,z){var lines,linesCount;str.indexOf("\n")<0?(lines=[str],linesCount=1):(lines=str.split(/\r?\n/g),linesCount=lines.length);var yOffset=0;verticalTextAlignment===PConstants.TOP?yOffset=curTextAscent+curTextDescent:verticalTextAlignment===PConstants.CENTER?yOffset=curTextAscent/2-(linesCount-1)*curTextLeading/2:verticalTextAlignment===PConstants.BOTTOM&&(yOffset=-(curTextDescent+(linesCount-1)*curTextLeading));for(var i=0;linesCount>i;++i){var line=lines[i];drawing.text$line(line,x,y+yOffset,z,horizontalTextAlignment),yOffset+=curTextLeading}}function text$6(str,x,y,width,height,z){if(0!==str.length&&0!==width&&0!==height&&!(curTextSize>height)){for(var spaceMark=-1,start=0,lineWidth=0,drawCommands=[],charPos=0,len=str.length;len>charPos;charPos++){var currentChar=str[charPos],spaceChar=" "===currentChar,letterWidth=curTextFont.measureTextWidth(currentChar);if("\n"!==currentChar&&width>=lineWidth+letterWidth)spaceChar&&(spaceMark=charPos),lineWidth+=letterWidth;else{if(spaceMark+1===start){if(!(charPos>0))return;spaceMark=charPos}"\n"===currentChar?(drawCommands.push({text:str.substring(start,charPos),width:lineWidth}),start=charPos+1):(drawCommands.push({text:str.substring(start,spaceMark+1),width:lineWidth}),start=spaceMark+1),lineWidth=0,charPos=start-1}}len>start&&drawCommands.push({text:str.substring(start),width:lineWidth});var xOffset=1,yOffset=curTextAscent;horizontalTextAlignment===PConstants.CENTER?xOffset=width/2:horizontalTextAlignment===PConstants.RIGHT&&(xOffset=width);var linesCount=drawCommands.length,visibleLines=Math.min(linesCount,Math.floor(height/curTextLeading));verticalTextAlignment===PConstants.TOP?yOffset=curTextAscent+curTextDescent:verticalTextAlignment===PConstants.CENTER?yOffset=height/2-curTextLeading*(visibleLines/2-1):verticalTextAlignment===PConstants.BOTTOM&&(yOffset=curTextDescent+curTextLeading);var command,drawCommand,leading;for(command=0;linesCount>command&&(leading=command*curTextLeading,!(yOffset+leading>height-curTextDescent));command++)drawCommand=drawCommands[command],drawing.text$line(drawCommand.text,x+xOffset,y+yOffset+leading,z,horizontalTextAlignment)}}function wireDimensionalFunctions(mode){drawing="3D"===mode?new Drawing3D:"2D"===mode?new Drawing2D:new DrawingPre;for(var i in DrawingPre.prototype)DrawingPre.prototype.hasOwnProperty(i)&&i.indexOf("$")<0&&(p[i]=drawing[i]);drawing.$init()}function createDrawingPreFunction(name){return function(){return wireDimensionalFunctions("2D"),drawing[name].apply(this,arguments)}}function getKeyCode(e){var code=e.which||e.keyCode;switch(code){case 13:return 10;case 91:case 93:case 224:return 157;case 57392:return 17;case 46:return 127;case 45:return 155}return code}function getKeyChar(e){var c=e.which||e.keyCode,anyShiftPressed=e.shiftKey||e.ctrlKey||e.altKey||e.metaKey;switch(c){case 13:c=anyShiftPressed?13:10;break;case 8:c=anyShiftPressed?127:8}return new Char(c)}function suppressKeyEvent(e){return"function"==typeof e.preventDefault?e.preventDefault():"function"==typeof e.stopPropagation&&e.stopPropagation(),!1}function updateKeyPressed(){var ch;for(ch in pressedKeysMap)if(pressedKeysMap.hasOwnProperty(ch))return void(p.__keyPressed=!0);p.__keyPressed=!1}function resetKeyPressed(){p.__keyPressed=!1,pressedKeysMap=[],lastPressedKeyCode=null}function simulateKeyTyped(code,c){pressedKeysMap[code]=c,lastPressedKeyCode=null,p.key=c,p.keyCode=code,p.keyPressed(),p.keyCode=0,p.keyTyped(),updateKeyPressed()}function handleKeydown(e){var code=getKeyCode(e);if(code===PConstants.DELETE)return void simulateKeyTyped(code,new Char(127));if(codedKeys.indexOf(code)<0)return void(lastPressedKeyCode=code);var c=new Char(PConstants.CODED);return p.key=c,p.keyCode=code,pressedKeysMap[code]=c,p.keyPressed(),lastPressedKeyCode=null,updateKeyPressed(),suppressKeyEvent(e)}function handleKeypress(e){if(null!==lastPressedKeyCode){var code=lastPressedKeyCode,c=getKeyChar(e);return simulateKeyTyped(code,c),suppressKeyEvent(e)}}function handleKeyup(e){var code=getKeyCode(e),c=pressedKeysMap[code];c!==undef&&(p.key=c,p.keyCode=code,p.keyReleased(),delete pressedKeysMap[code],updateKeyPressed())}if(!(this instanceof Processing))throw"called Processing constructor as if it were a function: missing 'new'.";var curElement={},pgraphicsMode=aCanvas===undef&&aCode===undef;if(curElement=pgraphicsMode?document.createElement("canvas"):"string"==typeof aCanvas?document.getElementById(aCanvas):aCanvas,!("getContext"in curElement))throw"called Processing constructor without passing canvas element reference or id.";var eventHandlers=[],p=this;p.Char=p.Character=Char,extend.withCommonFunctions(p),extend.withMath(p),extend.withProxyFunctions(p,removeFirstArgument),extend.withTouch(p,curElement,attachEventHandler,document,PConstants),aFunctions&&Object.keys(aFunctions).forEach(function(name){p[name]=aFunctions[name]}),p.externals={canvas:curElement,context:undef,sketch:undef,window:window},p.name="Processing.js Instance",p.use3DContext=!1,p.focused=!1,p.breakShape=!1,p.glyphTable={},p.pmouseX=0,p.pmouseY=0,p.mouseX=0,p.mouseY=0,p.mouseButton=0,p.mouseScroll=0,p.mouseClicked=undef,p.mouseDragged=undef,p.mouseMoved=undef,p.mousePressed=undef,p.mouseReleased=undef,p.mouseScrolled=undef,p.mouseOver=undef,p.mouseOut=undef,p.touchStart=undef,p.touchEnd=undef,p.touchMove=undef,p.touchCancel=undef,p.key=undef,p.keyCode=undef,p.keyPressed=noop,p.keyReleased=noop,p.keyTyped=noop,p.draw=undef,p.setup=undef,p.__mousePressed=!1,p.__keyPressed=!1,p.__frameRate=60,p.frameCount=0,p.width=100,p.height=100;var curContext,curSketch,drawing,textcanvas,curveBasisMatrix,curveToBezierMatrix,curveDrawMatrix,bezierDrawMatrix,bezierBasisInverse,bezierBasisMatrix,programObject3D,programObject2D,programObjectUnlitShape,boxBuffer,boxNormBuffer,boxOutlineBuffer,rectBuffer,rectNormBuffer,sphereBuffer,lineBuffer,fillBuffer,fillColorBuffer,strokeColorBuffer,pointBuffer,shapeTexVBO,canTex,textTex,textBuffer,textureBuffer,indexBuffer,originalContext,setPixelsCached,sphereVerts,cam,cameraInv,modelView,modelViewInv,userMatrixStack,userReverseMatrixStack,inverseCopy,projection,doFill=!0,fillStyle=[1,1,1,1],currentFillColor=4294967295,isFillDirty=!0,doStroke=!0,strokeStyle=[0,0,0,1],currentStrokeColor=4278190080,isStrokeDirty=!0,lineWidth=1,loopStarted=!1,renderSmooth=!1,doLoop=!0,looping=0,curRectMode=PConstants.CORNER,curEllipseMode=PConstants.CENTER,normalX=0,normalY=0,normalZ=0,normalMode=PConstants.NORMAL_MODE_AUTO,curFrameRate=60,curMsPerFrame=1e3/curFrameRate,curCursor=PConstants.ARROW,oldCursor=curElement.style.cursor,curShape=PConstants.POLYGON,curvePoints=[],curTightness=0,curveDet=20,curveInited=!1,backgroundObj=-3355444,bezDetail=20,colorModeA=255,colorModeX=255,colorModeY=255,colorModeZ=255,pmouseXLastFrame=0,pmouseYLastFrame=0,curColorMode=PConstants.RGB,curTint=null,curTint3d=null,start=Date.now(),timeSinceLastFPS=start,framesSinceLastFPS=0,curContextCache={attributes:{},locations:{}},curTexture={width:0,height:0},curTextureMode=PConstants.IMAGE,usingTexture=!1,horizontalTextAlignment=PConstants.LEFT,verticalTextAlignment=PConstants.BASELINE,textMode=PConstants.MODEL,curFontName="Arial",curTextSize=12,curTextAscent=9,curTextDescent=2,curTextLeading=14,curTextFont=PFont.get(curFontName,curTextSize),proxyContext=null,isContextReplaced=!1,maxPixelsCached=1e3,pressedKeysMap=[],lastPressedKeyCode=null,codedKeys=[PConstants.SHIFT,PConstants.CONTROL,PConstants.ALT,PConstants.CAPSLK,PConstants.PGUP,PConstants.PGDN,PConstants.END,PConstants.HOME,PConstants.LEFT,PConstants.UP,PConstants.RIGHT,PConstants.DOWN,PConstants.NUMLK,PConstants.INSERT,PConstants.F1,PConstants.F2,PConstants.F3,PConstants.F4,PConstants.F5,PConstants.F6,PConstants.F7,PConstants.F8,PConstants.F9,PConstants.F10,PConstants.F11,PConstants.F12,PConstants.META],lightCount=0,sphereDetailV=0,sphereDetailU=0,sphereX=[],sphereY=[],sphereZ=[],sinLUT=new Float32Array(PConstants.SINCOS_LENGTH),cosLUT=new Float32Array(PConstants.SINCOS_LENGTH),manipulatingCamera=!1,frustumMode=!1,cameraFOV=60*(Math.PI/180),cameraX=p.width/2,cameraY=p.height/2,cameraZ=cameraY/Math.tan(cameraFOV/2),cameraNear=cameraZ/10,cameraFar=10*cameraZ,cameraAspect=p.width/p.height,vertArray=[],curveVertArray=[],curveVertCount=0,isCurve=!1,isBezier=!1,firstVert=!0,curShapeMode=PConstants.CORNER,styleArray=[],boxVerts=new Float32Array([.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,.5,.5,.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5]),boxOutlineVerts=new Float32Array([.5,.5,.5,.5,-.5,.5,.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,.5,.5,-.5,-.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5]),boxNorms=new Float32Array([0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0]),rectVerts=new Float32Array([0,0,0,0,1,0,1,1,0,1,0,0]),rectNorms=new Float32Array([0,0,1,0,0,1,0,0,1,0,0,1]),vertexShaderSrcUnlitShape="varying vec4 vFrontColor;attribute vec3 aVertex;attribute vec4 aColor;uniform mat4 uView;uniform mat4 uProjection;uniform float uPointSize;void main(void) {  vFrontColor = aColor;  gl_PointSize = uPointSize;  gl_Position = uProjection * uView * vec4(aVertex, 1.0);}",fragmentShaderSrcUnlitShape="#ifdef GL_ES\nprecision highp float;\n#endif\nvarying vec4 vFrontColor;uniform bool uSmooth;void main(void){  if(uSmooth == true){    float dist = distance(gl_PointCoord, vec2(0.5));    if(dist > 0.5){      discard;    }  }  gl_FragColor = vFrontColor;}",vertexShaderSrc2D="varying vec4 vFrontColor;attribute vec3 aVertex;attribute vec2 aTextureCoord;uniform vec4 uColor;uniform mat4 uModel;uniform mat4 uView;uniform mat4 uProjection;uniform float uPointSize;varying vec2 vTextureCoord;void main(void) {  gl_PointSize = uPointSize;  vFrontColor = uColor;  gl_Position = uProjection * uView * uModel * vec4(aVertex, 1.0);  vTextureCoord = aTextureCoord;}",fragmentShaderSrc2D="#ifdef GL_ES\nprecision highp float;\n#endif\nvarying vec4 vFrontColor;varying vec2 vTextureCoord;uniform sampler2D uSampler;uniform int uIsDrawingText;uniform bool uSmooth;void main(void){  if(uSmooth == true){    float dist = distance(gl_PointCoord, vec2(0.5));    if(dist > 0.5){      discard;    }  }  if(uIsDrawingText == 1){    float alpha = texture2D(uSampler, vTextureCoord).a;    gl_FragColor = vec4(vFrontColor.rgb * alpha, alpha);  }  else{    gl_FragColor = vFrontColor;  }}",webglMaxTempsWorkaround=/Windows/.test(navigator.userAgent),vertexShaderSrc3D="varying vec4 vFrontColor;attribute vec3 aVertex;attribute vec3 aNormal;attribute vec4 aColor;attribute vec2 aTexture;varying   vec2 vTexture;uniform vec4 uColor;uniform bool uUsingMat;uniform vec3 uSpecular;uniform vec3 uMaterialEmissive;uniform vec3 uMaterialAmbient;uniform vec3 uMaterialSpecular;uniform float uShininess;uniform mat4 uModel;uniform mat4 uView;uniform mat4 uProjection;uniform mat4 uNormalTransform;uniform int uLightCount;uniform vec3 uFalloff;struct Light {  int type;  vec3 color;  vec3 position;  vec3 direction;  float angle;  vec3 halfVector;  float concentration;};uniform Light uLights0;uniform Light uLights1;uniform Light uLights2;uniform Light uLights3;uniform Light uLights4;uniform Light uLights5;uniform Light uLights6;uniform Light uLights7;Light getLight(int index){  if(index == 0) return uLights0;  if(index == 1) return uLights1;  if(index == 2) return uLights2;  if(index == 3) return uLights3;  if(index == 4) return uLights4;  if(index == 5) return uLights5;  if(index == 6) return uLights6;  return uLights7;}void AmbientLight( inout vec3 totalAmbient, in vec3 ecPos, in Light light ) {  float d = length( light.position - ecPos );  float attenuation = 1.0 / ( uFalloff[0] + ( uFalloff[1] * d ) + ( uFalloff[2] * d * d ));  totalAmbient += light.color * attenuation;}void DirectionalLight( inout vec3 col, inout vec3 spec, in vec3 vertNormal, in vec3 ecPos, in Light light ) {  float powerFactor = 0.0;  float nDotVP = max(0.0, dot( vertNormal, normalize(-light.position) ));  float nDotVH = max(0.0, dot( vertNormal, normalize(-light.position-normalize(ecPos) )));  if( nDotVP != 0.0 ){    powerFactor = pow( nDotVH, uShininess );  }  col += light.color * nDotVP;  spec += uSpecular * powerFactor;}void PointLight( inout vec3 col, inout vec3 spec, in vec3 vertNormal, in vec3 ecPos, in Light light ) {  float powerFactor;   vec3 VP = light.position - ecPos;  float d = length( VP );   VP = normalize( VP );  float attenuation = 1.0 / ( uFalloff[0] + ( uFalloff[1] * d ) + ( uFalloff[2] * d * d ));  float nDotVP = max( 0.0, dot( vertNormal, VP ));  vec3 halfVector = normalize( VP - normalize(ecPos) );  float nDotHV = max( 0.0, dot( vertNormal, halfVector ));  if( nDotVP == 0.0 ) {    powerFactor = 0.0;  }  else {    powerFactor = pow( nDotHV, uShininess );  }  spec += uSpecular * powerFactor * attenuation;  col += light.color * nDotVP * attenuation;}void SpotLight( inout vec3 col, inout vec3 spec, in vec3 vertNormal, in vec3 ecPos, in Light light ) {  float spotAttenuation;  float powerFactor = 0.0;  vec3 VP = light.position - ecPos;  vec3 ldir = normalize( -light.direction );  float d = length( VP );  VP = normalize( VP );  float attenuation = 1.0 / ( uFalloff[0] + ( uFalloff[1] * d ) + ( uFalloff[2] * d * d ) );  float spotDot = dot( VP, ldir );"+(webglMaxTempsWorkaround?"  spotAttenuation = 1.0; ":"  if( spotDot > cos( light.angle ) ) {    spotAttenuation = pow( spotDot, light.concentration );  }  else{    spotAttenuation = 0.0;  }  attenuation *= spotAttenuation;")+"  float nDotVP = max( 0.0, dot( vertNormal, VP ) );  vec3 halfVector = normalize( VP - normalize(ecPos) );  float nDotHV = max( 0.0, dot( vertNormal, halfVector ) );  if( nDotVP != 0.0 ) {    powerFactor = pow( nDotHV, uShininess );  }  spec += uSpecular * powerFactor * attenuation;  col += light.color * nDotVP * attenuation;}void main(void) {  vec3 finalAmbient = vec3( 0.0 );  vec3 finalDiffuse = vec3( 0.0 );  vec3 finalSpecular = vec3( 0.0 );  vec4 col = uColor;  if ( uColor[0] == -1.0 ){    col = aColor;  }  vec3 norm = normalize(vec3( uNormalTransform * vec4( aNormal, 0.0 ) ));  vec4 ecPos4 = uView * uModel * vec4(aVertex, 1.0);  vec3 ecPos = (vec3(ecPos4))/ecPos4.w;  if( uLightCount == 0 ) {    vFrontColor = col + vec4(uMaterialSpecular, 1.0);  }  else {    for( int i = 0; i < 8; i++ ) {      Light l = getLight(i);      if( i >= uLightCount ){        break;      }      if( l.type == 0 ) {        AmbientLight( finalAmbient, ecPos, l );      }      else if( l.type == 1 ) {        DirectionalLight( finalDiffuse, finalSpecular, norm, ecPos, l );      }      else if( l.type == 2 ) {        PointLight( finalDiffuse, finalSpecular, norm, ecPos, l );      }      else {        SpotLight( finalDiffuse, finalSpecular, norm, ecPos, l );      }    }   if( uUsingMat == false ) {     vFrontColor = vec4(       vec3( col ) * finalAmbient +       vec3( col ) * finalDiffuse +       vec3( col ) * finalSpecular,       col[3] );   }   else{     vFrontColor = vec4(        uMaterialEmissive +        (vec3(col) * uMaterialAmbient * finalAmbient ) +        (vec3(col) * finalDiffuse) +        (uMaterialSpecular * finalSpecular),        col[3] );    }  }  vTexture.xy = aTexture.xy;  gl_Position = uProjection * uView * uModel * vec4( aVertex, 1.0 );}",fragmentShaderSrc3D="#ifdef GL_ES\nprecision highp float;\n#endif\nvarying vec4 vFrontColor;uniform sampler2D uSampler;uniform bool uUsingTexture;varying vec2 vTexture;void main(void){  if( uUsingTexture ){    gl_FragColor = vec4(texture2D(uSampler, vTexture.xy)) * vFrontColor;  }  else{    gl_FragColor = vFrontColor;  }}",createProgramObject=function(curContext,vetexShaderSource,fragmentShaderSource){var vertexShaderObject=curContext.createShader(curContext.VERTEX_SHADER);if(curContext.shaderSource(vertexShaderObject,vetexShaderSource),curContext.compileShader(vertexShaderObject),!curContext.getShaderParameter(vertexShaderObject,curContext.COMPILE_STATUS))throw curContext.getShaderInfoLog(vertexShaderObject);var fragmentShaderObject=curContext.createShader(curContext.FRAGMENT_SHADER);if(curContext.shaderSource(fragmentShaderObject,fragmentShaderSource),curContext.compileShader(fragmentShaderObject),!curContext.getShaderParameter(fragmentShaderObject,curContext.COMPILE_STATUS))throw curContext.getShaderInfoLog(fragmentShaderObject);var programObject=curContext.createProgram();if(curContext.attachShader(programObject,vertexShaderObject),curContext.attachShader(programObject,fragmentShaderObject),curContext.linkProgram(programObject),!curContext.getProgramParameter(programObject,curContext.LINK_STATUS))throw"Error linking shaders.";return programObject},imageModeCorner=function(x,y,w,h){return{x:x,y:y,w:w,h:h}},imageModeConvert=imageModeCorner,imageModeCorners=function(x,y,w,h,whAreSizes){return{x:x,y:y,w:whAreSizes?w:w-x,h:whAreSizes?h:h-y}},imageModeCenter=function(x,y,w,h){return{x:x-w/2,y:y-h/2,w:w,h:h}},DrawingShared=function(){},Drawing2D=function(){},Drawing3D=function(){},DrawingPre=function(){};Drawing2D.prototype=new DrawingShared,Drawing2D.prototype.constructor=Drawing2D,Drawing3D.prototype=new DrawingShared,Drawing3D.prototype.constructor=Drawing3D,DrawingPre.prototype=new DrawingShared,DrawingPre.prototype.constructor=DrawingPre,DrawingShared.prototype.a3DOnlyFunction=noop,p.shape=function(shape,x,y,width,height){arguments.length>=1&&null!==arguments[0]&&shape.isVisible()&&(p.pushMatrix(),curShapeMode===PConstants.CENTER?5===arguments.length?(p.translate(x-width/2,y-height/2),p.scale(width/shape.getWidth(),height/shape.getHeight())):3===arguments.length?p.translate(x-shape.getWidth()/2,-shape.getHeight()/2):p.translate(-shape.getWidth()/2,-shape.getHeight()/2):curShapeMode===PConstants.CORNER?5===arguments.length?(p.translate(x,y),p.scale(width/shape.getWidth(),height/shape.getHeight())):3===arguments.length&&p.translate(x,y):curShapeMode===PConstants.CORNERS&&(5===arguments.length?(width-=x,height-=y,p.translate(x,y),p.scale(width/shape.getWidth(),height/shape.getHeight())):3===arguments.length&&p.translate(x,y)),shape.draw(p),(1===arguments.length&&curShapeMode===PConstants.CENTER||arguments.length>1)&&p.popMatrix())},p.shapeMode=function(mode){curShapeMode=mode},p.loadShape=function(filename){return 1===arguments.length&&filename.indexOf(".svg")>-1?new PShapeSVG(null,filename):null},p.loadXML=function(uri){return new XML(p,uri)};var printMatrixHelper=function(elements){for(var big=0,i=0;i<elements.length;i++)big=0!==i?Math.max(big,Math.abs(elements[i])):Math.abs(elements[i]);var digits=(big+"").indexOf(".");return 0===digits?digits=1:-1===digits&&(digits=(big+"").length),digits},PMatrix2D=p.PMatrix2D=function(){0===arguments.length?this.reset():1===arguments.length&&arguments[0]instanceof PMatrix2D?this.set(arguments[0].array()):6===arguments.length&&this.set(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5])};PMatrix2D.prototype={set:function(){if(6===arguments.length){var a=arguments;this.set([a[0],a[1],a[2],a[3],a[4],a[5]])}else 1===arguments.length&&arguments[0]instanceof PMatrix2D?this.elements=arguments[0].array():1===arguments.length&&arguments[0]instanceof Array&&(this.elements=arguments[0].slice())},get:function(){var outgoing=new PMatrix2D;return outgoing.set(this.elements),outgoing},reset:function(){this.set([1,0,0,0,1,0])},array:function(){return this.elements.slice()},translate:function(tx,ty){this.elements[2]=tx*this.elements[0]+ty*this.elements[1]+this.elements[2],this.elements[5]=tx*this.elements[3]+ty*this.elements[4]+this.elements[5]},invTranslate:function(tx,ty){this.translate(-tx,-ty)},transpose:function(){},mult:function(source,target){var x,y;return source instanceof PVector?(x=source.x,y=source.y,target||(target=new PVector)):source instanceof Array&&(x=source[0],y=source[1],target||(target=[])),target instanceof Array?(target[0]=this.elements[0]*x+this.elements[1]*y+this.elements[2],target[1]=this.elements[3]*x+this.elements[4]*y+this.elements[5]):target instanceof PVector&&(target.x=this.elements[0]*x+this.elements[1]*y+this.elements[2],target.y=this.elements[3]*x+this.elements[4]*y+this.elements[5],target.z=0),target},multX:function(x,y){return x*this.elements[0]+y*this.elements[1]+this.elements[2]},multY:function(x,y){return x*this.elements[3]+y*this.elements[4]+this.elements[5]},skewX:function(angle){this.apply(1,0,1,angle,0,0)},skewY:function(angle){this.apply(1,0,1,0,angle,0)},shearX:function(angle){this.apply(1,0,1,Math.tan(angle),0,0)},shearY:function(angle){this.apply(1,0,1,0,Math.tan(angle),0)},determinant:function(){return this.elements[0]*this.elements[4]-this.elements[1]*this.elements[3]},invert:function(){var d=this.determinant();if(Math.abs(d)>PConstants.MIN_INT){var old00=this.elements[0],old01=this.elements[1],old02=this.elements[2],old10=this.elements[3],old11=this.elements[4],old12=this.elements[5];return this.elements[0]=old11/d,this.elements[3]=-old10/d,this.elements[1]=-old01/d,this.elements[4]=old00/d,this.elements[2]=(old01*old12-old11*old02)/d,this.elements[5]=(old10*old02-old00*old12)/d,!0}return!1},scale:function(sx,sy){sx&&!sy&&(sy=sx),sx&&sy&&(this.elements[0]*=sx,this.elements[1]*=sy,this.elements[3]*=sx,this.elements[4]*=sy)},invScale:function(sx,sy){sx&&!sy&&(sy=sx),this.scale(1/sx,1/sy)},apply:function(){var source;1===arguments.length&&arguments[0]instanceof PMatrix2D?source=arguments[0].array():6===arguments.length?source=Array.prototype.slice.call(arguments):1===arguments.length&&arguments[0]instanceof Array&&(source=arguments[0]);for(var result=[0,0,this.elements[2],0,0,this.elements[5]],e=0,row=0;2>row;row++)for(var col=0;3>col;col++,e++)result[e]+=this.elements[3*row+0]*source[col+0]+this.elements[3*row+1]*source[col+3];this.elements=result.slice()},preApply:function(){var source;1===arguments.length&&arguments[0]instanceof PMatrix2D?source=arguments[0].array():6===arguments.length?source=Array.prototype.slice.call(arguments):1===arguments.length&&arguments[0]instanceof Array&&(source=arguments[0]);var result=[0,0,source[2],0,0,source[5]];result[2]=source[2]+this.elements[2]*source[0]+this.elements[5]*source[1],result[5]=source[5]+this.elements[2]*source[3]+this.elements[5]*source[4],result[0]=this.elements[0]*source[0]+this.elements[3]*source[1],result[3]=this.elements[0]*source[3]+this.elements[3]*source[4],result[1]=this.elements[1]*source[0]+this.elements[4]*source[1],result[4]=this.elements[1]*source[3]+this.elements[4]*source[4],this.elements=result.slice()},rotate:function(angle){var c=Math.cos(angle),s=Math.sin(angle),temp1=this.elements[0],temp2=this.elements[1];this.elements[0]=c*temp1+s*temp2,this.elements[1]=-s*temp1+c*temp2,temp1=this.elements[3],temp2=this.elements[4],this.elements[3]=c*temp1+s*temp2,this.elements[4]=-s*temp1+c*temp2},rotateZ:function(angle){this.rotate(angle)},invRotateZ:function(angle){this.rotateZ(angle-Math.PI)},print:function(){var digits=printMatrixHelper(this.elements),output=""+p.nfs(this.elements[0],digits,4)+" "+p.nfs(this.elements[1],digits,4)+" "+p.nfs(this.elements[2],digits,4)+"\n"+p.nfs(this.elements[3],digits,4)+" "+p.nfs(this.elements[4],digits,4)+" "+p.nfs(this.elements[5],digits,4)+"\n\n";p.println(output)}};var PMatrix3D=p.PMatrix3D=function(){this.reset()};PMatrix3D.prototype={set:function(){16===arguments.length?this.elements=Array.prototype.slice.call(arguments):1===arguments.length&&arguments[0]instanceof PMatrix3D?this.elements=arguments[0].array():1===arguments.length&&arguments[0]instanceof Array&&(this.elements=arguments[0].slice())},get:function(){var outgoing=new PMatrix3D;return outgoing.set(this.elements),outgoing},reset:function(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},array:function(){return this.elements.slice()},translate:function(tx,ty,tz){tz===undef&&(tz=0),this.elements[3]+=tx*this.elements[0]+ty*this.elements[1]+tz*this.elements[2],this.elements[7]+=tx*this.elements[4]+ty*this.elements[5]+tz*this.elements[6],this.elements[11]+=tx*this.elements[8]+ty*this.elements[9]+tz*this.elements[10],this.elements[15]+=tx*this.elements[12]+ty*this.elements[13]+tz*this.elements[14]},transpose:function(){var temp=this.elements[4];this.elements[4]=this.elements[1],this.elements[1]=temp,temp=this.elements[8],this.elements[8]=this.elements[2],this.elements[2]=temp,temp=this.elements[6],this.elements[6]=this.elements[9],this.elements[9]=temp,temp=this.elements[3],this.elements[3]=this.elements[12],this.elements[12]=temp,temp=this.elements[7],this.elements[7]=this.elements[13],this.elements[13]=temp,temp=this.elements[11],this.elements[11]=this.elements[14],this.elements[14]=temp},mult:function(source,target){var x,y,z,w;return source instanceof PVector?(x=source.x,y=source.y,z=source.z,w=1,target||(target=new PVector)):source instanceof Array&&(x=source[0],y=source[1],z=source[2],w=source[3]||1,(!target||3!==target.length&&4!==target.length)&&(target=[0,0,0])),target instanceof Array&&(3===target.length?(target[0]=this.elements[0]*x+this.elements[1]*y+this.elements[2]*z+this.elements[3],target[1]=this.elements[4]*x+this.elements[5]*y+this.elements[6]*z+this.elements[7],target[2]=this.elements[8]*x+this.elements[9]*y+this.elements[10]*z+this.elements[11]):4===target.length&&(target[0]=this.elements[0]*x+this.elements[1]*y+this.elements[2]*z+this.elements[3]*w,target[1]=this.elements[4]*x+this.elements[5]*y+this.elements[6]*z+this.elements[7]*w,target[2]=this.elements[8]*x+this.elements[9]*y+this.elements[10]*z+this.elements[11]*w,target[3]=this.elements[12]*x+this.elements[13]*y+this.elements[14]*z+this.elements[15]*w)),target instanceof PVector&&(target.x=this.elements[0]*x+this.elements[1]*y+this.elements[2]*z+this.elements[3],target.y=this.elements[4]*x+this.elements[5]*y+this.elements[6]*z+this.elements[7],target.z=this.elements[8]*x+this.elements[9]*y+this.elements[10]*z+this.elements[11]),target},preApply:function(){var source;1===arguments.length&&arguments[0]instanceof PMatrix3D?source=arguments[0].array():16===arguments.length?source=Array.prototype.slice.call(arguments):1===arguments.length&&arguments[0]instanceof Array&&(source=arguments[0]);for(var result=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e=0,row=0;4>row;row++)for(var col=0;4>col;col++,e++)result[e]+=this.elements[col+0]*source[4*row+0]+this.elements[col+4]*source[4*row+1]+this.elements[col+8]*source[4*row+2]+this.elements[col+12]*source[4*row+3];this.elements=result.slice()},apply:function(){var source;1===arguments.length&&arguments[0]instanceof PMatrix3D?source=arguments[0].array():16===arguments.length?source=Array.prototype.slice.call(arguments):1===arguments.length&&arguments[0]instanceof Array&&(source=arguments[0]);for(var result=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e=0,row=0;4>row;row++)for(var col=0;4>col;col++,e++)result[e]+=this.elements[4*row+0]*source[col+0]+this.elements[4*row+1]*source[col+4]+this.elements[4*row+2]*source[col+8]+this.elements[4*row+3]*source[col+12];
this.elements=result.slice()},rotate:function(angle,v0,v1,v2){if(arguments.length<4)this.rotateZ(angle);else{var v=new PVector(v0,v1,v2),m=v.mag();if(0===m)return;1!=m&&(v.normalize(),v0=v.x,v1=v.y,v2=v.z);var c=p.cos(angle),s=p.sin(angle),t=1-c;this.apply(t*v0*v0+c,t*v0*v1-s*v2,t*v0*v2+s*v1,0,t*v0*v1+s*v2,t*v1*v1+c,t*v1*v2-s*v0,0,t*v0*v2-s*v1,t*v1*v2+s*v0,t*v2*v2+c,0,0,0,0,1)}},invApply:function(){inverseCopy===undef&&(inverseCopy=new PMatrix3D);var a=arguments;return inverseCopy.set(a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8],a[9],a[10],a[11],a[12],a[13],a[14],a[15]),inverseCopy.invert()?(this.preApply(inverseCopy),!0):!1},rotateX:function(angle){var c=p.cos(angle),s=p.sin(angle);this.apply([1,0,0,0,0,c,-s,0,0,s,c,0,0,0,0,1])},rotateY:function(angle){var c=p.cos(angle),s=p.sin(angle);this.apply([c,0,s,0,0,1,0,0,-s,0,c,0,0,0,0,1])},rotateZ:function(angle){var c=Math.cos(angle),s=Math.sin(angle);this.apply([c,-s,0,0,s,c,0,0,0,0,1,0,0,0,0,1])},scale:function(sx,sy,sz){!sx||sy||sz?sx&&sy&&!sz&&(sz=1):sy=sz=sx,sx&&sy&&sz&&(this.elements[0]*=sx,this.elements[1]*=sy,this.elements[2]*=sz,this.elements[4]*=sx,this.elements[5]*=sy,this.elements[6]*=sz,this.elements[8]*=sx,this.elements[9]*=sy,this.elements[10]*=sz,this.elements[12]*=sx,this.elements[13]*=sy,this.elements[14]*=sz)},skewX:function(angle){var t=Math.tan(angle);this.apply(1,t,0,0,0,1,0,0,0,0,1,0,0,0,0,1)},skewY:function(angle){var t=Math.tan(angle);this.apply(1,0,0,0,t,1,0,0,0,0,1,0,0,0,0,1)},shearX:function(angle){var t=Math.tan(angle);this.apply(1,t,0,0,0,1,0,0,0,0,1,0,0,0,0,1)},shearY:function(angle){var t=Math.tan(angle);this.apply(1,0,0,0,t,1,0,0,0,0,1,0,0,0,0,1)},multX:function(x,y,z,w){return z?w?this.elements[0]*x+this.elements[1]*y+this.elements[2]*z+this.elements[3]*w:this.elements[0]*x+this.elements[1]*y+this.elements[2]*z+this.elements[3]:this.elements[0]*x+this.elements[1]*y+this.elements[3]},multY:function(x,y,z,w){return z?w?this.elements[4]*x+this.elements[5]*y+this.elements[6]*z+this.elements[7]*w:this.elements[4]*x+this.elements[5]*y+this.elements[6]*z+this.elements[7]:this.elements[4]*x+this.elements[5]*y+this.elements[7]},multZ:function(x,y,z,w){return w?this.elements[8]*x+this.elements[9]*y+this.elements[10]*z+this.elements[11]*w:this.elements[8]*x+this.elements[9]*y+this.elements[10]*z+this.elements[11]},multW:function(x,y,z,w){return w?this.elements[12]*x+this.elements[13]*y+this.elements[14]*z+this.elements[15]*w:this.elements[12]*x+this.elements[13]*y+this.elements[14]*z+this.elements[15]},invert:function(){var fA0=this.elements[0]*this.elements[5]-this.elements[1]*this.elements[4],fA1=this.elements[0]*this.elements[6]-this.elements[2]*this.elements[4],fA2=this.elements[0]*this.elements[7]-this.elements[3]*this.elements[4],fA3=this.elements[1]*this.elements[6]-this.elements[2]*this.elements[5],fA4=this.elements[1]*this.elements[7]-this.elements[3]*this.elements[5],fA5=this.elements[2]*this.elements[7]-this.elements[3]*this.elements[6],fB0=this.elements[8]*this.elements[13]-this.elements[9]*this.elements[12],fB1=this.elements[8]*this.elements[14]-this.elements[10]*this.elements[12],fB2=this.elements[8]*this.elements[15]-this.elements[11]*this.elements[12],fB3=this.elements[9]*this.elements[14]-this.elements[10]*this.elements[13],fB4=this.elements[9]*this.elements[15]-this.elements[11]*this.elements[13],fB5=this.elements[10]*this.elements[15]-this.elements[11]*this.elements[14],fDet=fA0*fB5-fA1*fB4+fA2*fB3+fA3*fB2-fA4*fB1+fA5*fB0;if(Math.abs(fDet)<=1e-9)return!1;var kInv=[];kInv[0]=+this.elements[5]*fB5-this.elements[6]*fB4+this.elements[7]*fB3,kInv[4]=-this.elements[4]*fB5+this.elements[6]*fB2-this.elements[7]*fB1,kInv[8]=+this.elements[4]*fB4-this.elements[5]*fB2+this.elements[7]*fB0,kInv[12]=-this.elements[4]*fB3+this.elements[5]*fB1-this.elements[6]*fB0,kInv[1]=-this.elements[1]*fB5+this.elements[2]*fB4-this.elements[3]*fB3,kInv[5]=+this.elements[0]*fB5-this.elements[2]*fB2+this.elements[3]*fB1,kInv[9]=-this.elements[0]*fB4+this.elements[1]*fB2-this.elements[3]*fB0,kInv[13]=+this.elements[0]*fB3-this.elements[1]*fB1+this.elements[2]*fB0,kInv[2]=+this.elements[13]*fA5-this.elements[14]*fA4+this.elements[15]*fA3,kInv[6]=-this.elements[12]*fA5+this.elements[14]*fA2-this.elements[15]*fA1,kInv[10]=+this.elements[12]*fA4-this.elements[13]*fA2+this.elements[15]*fA0,kInv[14]=-this.elements[12]*fA3+this.elements[13]*fA1-this.elements[14]*fA0,kInv[3]=-this.elements[9]*fA5+this.elements[10]*fA4-this.elements[11]*fA3,kInv[7]=+this.elements[8]*fA5-this.elements[10]*fA2+this.elements[11]*fA1,kInv[11]=-this.elements[8]*fA4+this.elements[9]*fA2-this.elements[11]*fA0,kInv[15]=+this.elements[8]*fA3-this.elements[9]*fA1+this.elements[10]*fA0;var fInvDet=1/fDet;return kInv[0]*=fInvDet,kInv[1]*=fInvDet,kInv[2]*=fInvDet,kInv[3]*=fInvDet,kInv[4]*=fInvDet,kInv[5]*=fInvDet,kInv[6]*=fInvDet,kInv[7]*=fInvDet,kInv[8]*=fInvDet,kInv[9]*=fInvDet,kInv[10]*=fInvDet,kInv[11]*=fInvDet,kInv[12]*=fInvDet,kInv[13]*=fInvDet,kInv[14]*=fInvDet,kInv[15]*=fInvDet,this.elements=kInv.slice(),!0},toString:function(){for(var str="",i=0;15>i;i++)str+=this.elements[i]+", ";return str+=this.elements[15]},print:function(){var digits=printMatrixHelper(this.elements),output=""+p.nfs(this.elements[0],digits,4)+" "+p.nfs(this.elements[1],digits,4)+" "+p.nfs(this.elements[2],digits,4)+" "+p.nfs(this.elements[3],digits,4)+"\n"+p.nfs(this.elements[4],digits,4)+" "+p.nfs(this.elements[5],digits,4)+" "+p.nfs(this.elements[6],digits,4)+" "+p.nfs(this.elements[7],digits,4)+"\n"+p.nfs(this.elements[8],digits,4)+" "+p.nfs(this.elements[9],digits,4)+" "+p.nfs(this.elements[10],digits,4)+" "+p.nfs(this.elements[11],digits,4)+"\n"+p.nfs(this.elements[12],digits,4)+" "+p.nfs(this.elements[13],digits,4)+" "+p.nfs(this.elements[14],digits,4)+" "+p.nfs(this.elements[15],digits,4)+"\n\n";p.println(output)},invTranslate:function(tx,ty,tz){this.preApply(1,0,0,-tx,0,1,0,-ty,0,0,1,-tz,0,0,0,1)},invRotateX:function(angle){var c=Math.cos(-angle),s=Math.sin(-angle);this.preApply([1,0,0,0,0,c,-s,0,0,s,c,0,0,0,0,1])},invRotateY:function(angle){var c=Math.cos(-angle),s=Math.sin(-angle);this.preApply([c,0,s,0,0,1,0,0,-s,0,c,0,0,0,0,1])},invRotateZ:function(angle){var c=Math.cos(-angle),s=Math.sin(-angle);this.preApply([c,-s,0,0,s,c,0,0,0,0,1,0,0,0,0,1])},invScale:function(x,y,z){this.preApply([1/x,0,0,0,0,1/y,0,0,0,0,1/z,0,0,0,0,1])}};var PMatrixStack=p.PMatrixStack=function(){this.matrixStack=[]};PMatrixStack.prototype.load=function(){var tmpMatrix=drawing.$newPMatrix();tmpMatrix.set(1===arguments.length?arguments[0]:arguments),this.matrixStack.push(tmpMatrix)},Drawing2D.prototype.$newPMatrix=function(){return new PMatrix2D},Drawing3D.prototype.$newPMatrix=function(){return new PMatrix3D},PMatrixStack.prototype.push=function(){this.matrixStack.push(this.peek())},PMatrixStack.prototype.pop=function(){return this.matrixStack.pop()},PMatrixStack.prototype.peek=function(){var tmpMatrix=drawing.$newPMatrix();return tmpMatrix.set(this.matrixStack[this.matrixStack.length-1]),tmpMatrix},PMatrixStack.prototype.mult=function(matrix){this.matrixStack[this.matrixStack.length-1].apply(matrix)},p.split=function(str,delim){return str.split(delim)},p.splitTokens=function(str,tokens){if(tokens===undef)return str.split(/\s+/g);var i,c,chars=tokens.split(/()/g),buffer="",len=str.length,tokenized=[];for(i=0;len>i;i++)c=str[i],chars.indexOf(c)>-1?(""!==buffer&&tokenized.push(buffer),buffer=""):buffer+=c;return""!==buffer&&tokenized.push(buffer),tokenized},p.append=function(array,element){return array[array.length]=element,array},p.concat=function(array1,array2){return array1.concat(array2)},p.sort=function(array,numElem){var ret=[];if(array.length>0){for(var elemsToCopy=numElem>0?numElem:array.length,i=0;elemsToCopy>i;i++)ret.push(array[i]);if("string"==typeof array[0]?ret.sort():ret.sort(function(a,b){return a-b}),numElem>0)for(var j=ret.length;j<array.length;j++)ret.push(array[j])}return ret},p.splice=function(array,value,index){if(0===value.length)return array;if(value instanceof Array)for(var i=0,j=index;i<value.length;j++,i++)array.splice(j,0,value[i]);else array.splice(index,0,value);return array},p.subset=function(array,offset,length){var end=length!==undef?offset+length:array.length;return array.slice(offset,end)},p.join=function(array,seperator){return array.join(seperator)},p.shorten=function(ary){for(var newary=[],len=ary.length,i=0;len>i;i++)newary[i]=ary[i];return newary.pop(),newary},p.expand=function(ary,targetSize){var temp=ary.slice(0),newSize=targetSize||2*ary.length;return temp.length=newSize,temp},p.arrayCopy=function(){var src,dest,length,srcPos=0,destPos=0;2===arguments.length?(src=arguments[0],dest=arguments[1],length=src.length):3===arguments.length?(src=arguments[0],dest=arguments[1],length=arguments[2]):5===arguments.length&&(src=arguments[0],srcPos=arguments[1],dest=arguments[2],destPos=arguments[3],length=arguments[4]);for(var i=srcPos,j=destPos;length+srcPos>i;i++,j++){if(dest[j]===undef)throw"array index out of bounds exception";dest[j]=src[i]}},p.reverse=function(array){return array.reverse()},p.mix=function(a,b,f){return a+((b-a)*f>>8)},p.peg=function(n){return 0>n?0:n>255?255:n},p.modes=function(){function applyMode(c1,f,ar,ag,ab,br,bg,bb,cr,cg,cb){var a=min(((4278190080&c1)>>>24)+f,255)<<24,r=ar+((cr-ar)*f>>8);r=(0>r?0:r>255?255:r)<<16;var g=ag+((cg-ag)*f>>8);g=(0>g?0:g>255?255:g)<<8;var b=ab+((cb-ab)*f>>8);return b=0>b?0:b>255?255:b,a|r|g|b}var ALPHA_MASK=PConstants.ALPHA_MASK,RED_MASK=PConstants.RED_MASK,GREEN_MASK=PConstants.GREEN_MASK,BLUE_MASK=PConstants.BLUE_MASK,min=Math.min,max=Math.max;return{replace:function(c1,c2){return c2},blend:function(c1,c2){var f=(c2&ALPHA_MASK)>>>24,ar=c1&RED_MASK,ag=c1&GREEN_MASK,ab=c1&BLUE_MASK,br=c2&RED_MASK,bg=c2&GREEN_MASK,bb=c2&BLUE_MASK;return min(((c1&ALPHA_MASK)>>>24)+f,255)<<24|ar+((br-ar)*f>>8)&RED_MASK|ag+((bg-ag)*f>>8)&GREEN_MASK|ab+((bb-ab)*f>>8)&BLUE_MASK},add:function(c1,c2){var f=(c2&ALPHA_MASK)>>>24;return min(((c1&ALPHA_MASK)>>>24)+f,255)<<24|min((c1&RED_MASK)+((c2&RED_MASK)>>8)*f,RED_MASK)&RED_MASK|min((c1&GREEN_MASK)+((c2&GREEN_MASK)>>8)*f,GREEN_MASK)&GREEN_MASK|min((c1&BLUE_MASK)+((c2&BLUE_MASK)*f>>8),BLUE_MASK)},subtract:function(c1,c2){var f=(c2&ALPHA_MASK)>>>24;return min(((c1&ALPHA_MASK)>>>24)+f,255)<<24|max((c1&RED_MASK)-((c2&RED_MASK)>>8)*f,GREEN_MASK)&RED_MASK|max((c1&GREEN_MASK)-((c2&GREEN_MASK)>>8)*f,BLUE_MASK)&GREEN_MASK|max((c1&BLUE_MASK)-((c2&BLUE_MASK)*f>>8),0)},lightest:function(c1,c2){var f=(c2&ALPHA_MASK)>>>24;return min(((c1&ALPHA_MASK)>>>24)+f,255)<<24|max(c1&RED_MASK,((c2&RED_MASK)>>8)*f)&RED_MASK|max(c1&GREEN_MASK,((c2&GREEN_MASK)>>8)*f)&GREEN_MASK|max(c1&BLUE_MASK,(c2&BLUE_MASK)*f>>8)},darkest:function(c1,c2){var f=(c2&ALPHA_MASK)>>>24,ar=c1&RED_MASK,ag=c1&GREEN_MASK,ab=c1&BLUE_MASK,br=min(c1&RED_MASK,((c2&RED_MASK)>>8)*f),bg=min(c1&GREEN_MASK,((c2&GREEN_MASK)>>8)*f),bb=min(c1&BLUE_MASK,(c2&BLUE_MASK)*f>>8);return min(((c1&ALPHA_MASK)>>>24)+f,255)<<24|ar+((br-ar)*f>>8)&RED_MASK|ag+((bg-ag)*f>>8)&GREEN_MASK|ab+((bb-ab)*f>>8)&BLUE_MASK},difference:function(c1,c2){var f=(c2&ALPHA_MASK)>>>24,ar=(c1&RED_MASK)>>16,ag=(c1&GREEN_MASK)>>8,ab=c1&BLUE_MASK,br=(c2&RED_MASK)>>16,bg=(c2&GREEN_MASK)>>8,bb=c2&BLUE_MASK,cr=ar>br?ar-br:br-ar,cg=ag>bg?ag-bg:bg-ag,cb=ab>bb?ab-bb:bb-ab;return applyMode(c1,f,ar,ag,ab,br,bg,bb,cr,cg,cb)},exclusion:function(c1,c2){var f=(c2&ALPHA_MASK)>>>24,ar=(c1&RED_MASK)>>16,ag=(c1&GREEN_MASK)>>8,ab=c1&BLUE_MASK,br=(c2&RED_MASK)>>16,bg=(c2&GREEN_MASK)>>8,bb=c2&BLUE_MASK,cr=ar+br-(ar*br>>7),cg=ag+bg-(ag*bg>>7),cb=ab+bb-(ab*bb>>7);return applyMode(c1,f,ar,ag,ab,br,bg,bb,cr,cg,cb)},multiply:function(c1,c2){var f=(c2&ALPHA_MASK)>>>24,ar=(c1&RED_MASK)>>16,ag=(c1&GREEN_MASK)>>8,ab=c1&BLUE_MASK,br=(c2&RED_MASK)>>16,bg=(c2&GREEN_MASK)>>8,bb=c2&BLUE_MASK,cr=ar*br>>8,cg=ag*bg>>8,cb=ab*bb>>8;return applyMode(c1,f,ar,ag,ab,br,bg,bb,cr,cg,cb)},screen:function(c1,c2){var f=(c2&ALPHA_MASK)>>>24,ar=(c1&RED_MASK)>>16,ag=(c1&GREEN_MASK)>>8,ab=c1&BLUE_MASK,br=(c2&RED_MASK)>>16,bg=(c2&GREEN_MASK)>>8,bb=c2&BLUE_MASK,cr=255-((255-ar)*(255-br)>>8),cg=255-((255-ag)*(255-bg)>>8),cb=255-((255-ab)*(255-bb)>>8);return applyMode(c1,f,ar,ag,ab,br,bg,bb,cr,cg,cb)},hard_light:function(c1,c2){var f=(c2&ALPHA_MASK)>>>24,ar=(c1&RED_MASK)>>16,ag=(c1&GREEN_MASK)>>8,ab=c1&BLUE_MASK,br=(c2&RED_MASK)>>16,bg=(c2&GREEN_MASK)>>8,bb=c2&BLUE_MASK,cr=128>br?ar*br>>7:255-((255-ar)*(255-br)>>7),cg=128>bg?ag*bg>>7:255-((255-ag)*(255-bg)>>7),cb=128>bb?ab*bb>>7:255-((255-ab)*(255-bb)>>7);return applyMode(c1,f,ar,ag,ab,br,bg,bb,cr,cg,cb)},soft_light:function(c1,c2){var f=(c2&ALPHA_MASK)>>>24,ar=(c1&RED_MASK)>>16,ag=(c1&GREEN_MASK)>>8,ab=c1&BLUE_MASK,br=(c2&RED_MASK)>>16,bg=(c2&GREEN_MASK)>>8,bb=c2&BLUE_MASK,cr=(ar*br>>7)+(ar*ar>>8)-(ar*ar*br>>15),cg=(ag*bg>>7)+(ag*ag>>8)-(ag*ag*bg>>15),cb=(ab*bb>>7)+(ab*ab>>8)-(ab*ab*bb>>15);return applyMode(c1,f,ar,ag,ab,br,bg,bb,cr,cg,cb)},overlay:function(c1,c2){var f=(c2&ALPHA_MASK)>>>24,ar=(c1&RED_MASK)>>16,ag=(c1&GREEN_MASK)>>8,ab=c1&BLUE_MASK,br=(c2&RED_MASK)>>16,bg=(c2&GREEN_MASK)>>8,bb=c2&BLUE_MASK,cr=128>ar?ar*br>>7:255-((255-ar)*(255-br)>>7),cg=128>ag?ag*bg>>7:255-((255-ag)*(255-bg)>>7),cb=128>ab?ab*bb>>7:255-((255-ab)*(255-bb)>>7);return applyMode(c1,f,ar,ag,ab,br,bg,bb,cr,cg,cb)},dodge:function(c1,c2){var f=(c2&ALPHA_MASK)>>>24,ar=(c1&RED_MASK)>>16,ag=(c1&GREEN_MASK)>>8,ab=c1&BLUE_MASK,br=(c2&RED_MASK)>>16,bg=(c2&GREEN_MASK)>>8,bb=c2&BLUE_MASK,cr=255;255!==br&&(cr=(ar<<8)/(255-br),cr=0>cr?0:cr>255?255:cr);var cg=255;255!==bg&&(cg=(ag<<8)/(255-bg),cg=0>cg?0:cg>255?255:cg);var cb=255;return 255!==bb&&(cb=(ab<<8)/(255-bb),cb=0>cb?0:cb>255?255:cb),applyMode(c1,f,ar,ag,ab,br,bg,bb,cr,cg,cb)},burn:function(c1,c2){var f=(c2&ALPHA_MASK)>>>24,ar=(c1&RED_MASK)>>16,ag=(c1&GREEN_MASK)>>8,ab=c1&BLUE_MASK,br=(c2&RED_MASK)>>16,bg=(c2&GREEN_MASK)>>8,bb=c2&BLUE_MASK,cr=0;0!==br&&(cr=(255-ar<<8)/br,cr=255-(0>cr?0:cr>255?255:cr));var cg=0;0!==bg&&(cg=(255-ag<<8)/bg,cg=255-(0>cg?0:cg>255?255:cg));var cb=0;return 0!==bb&&(cb=(255-ab<<8)/bb,cb=255-(0>cb?0:cb>255?255:cb)),applyMode(c1,f,ar,ag,ab,br,bg,bb,cr,cg,cb)}}}(),p.color=function(aValue1,aValue2,aValue3,aValue4){return aValue1!==undef&&aValue2!==undef&&aValue3!==undef&&aValue4!==undef?color$4(aValue1,aValue2,aValue3,aValue4):aValue1!==undef&&aValue2!==undef&&aValue3!==undef?color$4(aValue1,aValue2,aValue3,colorModeA):aValue1!==undef&&aValue2!==undef?color$2(aValue1,aValue2):"number"==typeof aValue1?color$1(aValue1):color$4(colorModeX,colorModeY,colorModeZ,colorModeA)},p.color.toString=function(colorInt){return"rgba("+((colorInt&PConstants.RED_MASK)>>>16)+","+((colorInt&PConstants.GREEN_MASK)>>>8)+","+(colorInt&PConstants.BLUE_MASK)+","+((colorInt&PConstants.ALPHA_MASK)>>>24)/255+")"},p.color.toInt=function(r,g,b,a){return a<<24&PConstants.ALPHA_MASK|r<<16&PConstants.RED_MASK|g<<8&PConstants.GREEN_MASK|b&PConstants.BLUE_MASK},p.color.toArray=function(colorInt){return[(colorInt&PConstants.RED_MASK)>>>16,(colorInt&PConstants.GREEN_MASK)>>>8,colorInt&PConstants.BLUE_MASK,(colorInt&PConstants.ALPHA_MASK)>>>24]},p.color.toGLArray=function(colorInt){return[((colorInt&PConstants.RED_MASK)>>>16)/255,((colorInt&PConstants.GREEN_MASK)>>>8)/255,(colorInt&PConstants.BLUE_MASK)/255,((colorInt&PConstants.ALPHA_MASK)>>>24)/255]},p.color.toRGB=function(h,s,b){h=h>colorModeX?colorModeX:h,s=s>colorModeY?colorModeY:s,b=b>colorModeZ?colorModeZ:b,h=h/colorModeX*360,s=s/colorModeY*100,b=b/colorModeZ*100;var br=Math.round(b/100*255);if(0===s)return[br,br,br];var hue=h%360,f=hue%60,p=Math.round(b*(100-s)/1e4*255),q=Math.round(b*(6e3-s*f)/6e5*255),t=Math.round(b*(6e3-s*(60-f))/6e5*255);switch(Math.floor(hue/60)){case 0:return[br,t,p];case 1:return[q,br,p];case 2:return[p,br,t];case 3:return[p,q,br];case 4:return[t,p,br];case 5:return[br,p,q]}},p.brightness=function(colInt){return colorToHSB(colInt)[2]},p.saturation=function(colInt){return colorToHSB(colInt)[1]},p.hue=function(colInt){return colorToHSB(colInt)[0]},p.red=function(aColor){return((aColor&PConstants.RED_MASK)>>>16)/255*colorModeX},p.green=function(aColor){return((aColor&PConstants.GREEN_MASK)>>>8)/255*colorModeY},p.blue=function(aColor){return(aColor&PConstants.BLUE_MASK)/255*colorModeZ},p.alpha=function(aColor){return((aColor&PConstants.ALPHA_MASK)>>>24)/255*colorModeA},p.lerpColor=function(c1,c2,amt){var r,g,b,a,r1,g1,b1,a1,r2,g2,b2,a2,hsb1,hsb2,rgb,h,s,colorBits1=p.color(c1),colorBits2=p.color(c2);return curColorMode===PConstants.HSB?(hsb1=colorToHSB(colorBits1),a1=((colorBits1&PConstants.ALPHA_MASK)>>>24)/colorModeA,hsb2=colorToHSB(colorBits2),a2=((colorBits2&PConstants.ALPHA_MASK)>>>24)/colorModeA,h=p.lerp(hsb1[0],hsb2[0],amt),s=p.lerp(hsb1[1],hsb2[1],amt),b=p.lerp(hsb1[2],hsb2[2],amt),rgb=p.color.toRGB(h,s,b),a=p.lerp(a1,a2,amt)*colorModeA,a<<24&PConstants.ALPHA_MASK|rgb[0]<<16&PConstants.RED_MASK|rgb[1]<<8&PConstants.GREEN_MASK|rgb[2]&PConstants.BLUE_MASK):(r1=(colorBits1&PConstants.RED_MASK)>>>16,g1=(colorBits1&PConstants.GREEN_MASK)>>>8,b1=colorBits1&PConstants.BLUE_MASK,a1=((colorBits1&PConstants.ALPHA_MASK)>>>24)/colorModeA,r2=(colorBits2&PConstants.RED_MASK)>>>16,g2=(colorBits2&PConstants.GREEN_MASK)>>>8,b2=colorBits2&PConstants.BLUE_MASK,a2=((colorBits2&PConstants.ALPHA_MASK)>>>24)/colorModeA,r=0|p.lerp(r1,r2,amt),g=0|p.lerp(g1,g2,amt),b=0|p.lerp(b1,b2,amt),a=p.lerp(a1,a2,amt)*colorModeA,a<<24&PConstants.ALPHA_MASK|r<<16&PConstants.RED_MASK|g<<8&PConstants.GREEN_MASK|b&PConstants.BLUE_MASK)},p.colorMode=function(){curColorMode=arguments[0],arguments.length>1&&(colorModeX=arguments[1],colorModeY=arguments[2]||arguments[1],colorModeZ=arguments[3]||arguments[1],colorModeA=arguments[4]||arguments[1])},p.blendColor=function(c1,c2,mode){return mode===PConstants.REPLACE?p.modes.replace(c1,c2):mode===PConstants.BLEND?p.modes.blend(c1,c2):mode===PConstants.ADD?p.modes.add(c1,c2):mode===PConstants.SUBTRACT?p.modes.subtract(c1,c2):mode===PConstants.LIGHTEST?p.modes.lightest(c1,c2):mode===PConstants.DARKEST?p.modes.darkest(c1,c2):mode===PConstants.DIFFERENCE?p.modes.difference(c1,c2):mode===PConstants.EXCLUSION?p.modes.exclusion(c1,c2):mode===PConstants.MULTIPLY?p.modes.multiply(c1,c2):mode===PConstants.SCREEN?p.modes.screen(c1,c2):mode===PConstants.HARD_LIGHT?p.modes.hard_light(c1,c2):mode===PConstants.SOFT_LIGHT?p.modes.soft_light(c1,c2):mode===PConstants.OVERLAY?p.modes.overlay(c1,c2):mode===PConstants.DODGE?p.modes.dodge(c1,c2):mode===PConstants.BURN?p.modes.burn(c1,c2):void 0},p.printMatrix=function(){modelView.print()},Drawing2D.prototype.translate=function(x,y){modelView.translate(x,y),modelViewInv.invTranslate(x,y),curContext.translate(x,y)},Drawing3D.prototype.translate=function(x,y,z){modelView.translate(x,y,z),modelViewInv.invTranslate(x,y,z)},Drawing2D.prototype.scale=function(x,y){modelView.scale(x,y),modelViewInv.invScale(x,y),curContext.scale(x,y||x)},Drawing3D.prototype.scale=function(x,y,z){modelView.scale(x,y,z),modelViewInv.invScale(x,y,z)},Drawing2D.prototype.transform=function(pmatrix){var e=pmatrix.array();curContext.transform(e[0],e[3],e[1],e[4],e[2],e[5])},Drawing3D.prototype.transformm=function(){throw"p.transform is currently not supported in 3D mode"},Drawing2D.prototype.pushMatrix=function(){userMatrixStack.load(modelView),userReverseMatrixStack.load(modelViewInv),saveContext()},Drawing3D.prototype.pushMatrix=function(){userMatrixStack.load(modelView),userReverseMatrixStack.load(modelViewInv)},Drawing2D.prototype.popMatrix=function(){modelView.set(userMatrixStack.pop()),modelViewInv.set(userReverseMatrixStack.pop()),restoreContext()},Drawing3D.prototype.popMatrix=function(){modelView.set(userMatrixStack.pop()),modelViewInv.set(userReverseMatrixStack.pop())},Drawing2D.prototype.resetMatrix=function(){modelView.reset(),modelViewInv.reset(),curContext.setTransform(1,0,0,1,0,0)},Drawing3D.prototype.resetMatrix=function(){modelView.reset(),modelViewInv.reset()},DrawingShared.prototype.applyMatrix=function(){var a=arguments;modelView.apply(a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8],a[9],a[10],a[11],a[12],a[13],a[14],a[15]),modelViewInv.invApply(a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8],a[9],a[10],a[11],a[12],a[13],a[14],a[15])},Drawing2D.prototype.applyMatrix=function(){for(var a=arguments,cnt=a.length;16>cnt;cnt++)a[cnt]=0;a[10]=a[15]=1,DrawingShared.prototype.applyMatrix.apply(this,a)},p.rotateX=function(angleInRadians){modelView.rotateX(angleInRadians),modelViewInv.invRotateX(angleInRadians)},Drawing2D.prototype.rotateZ=function(){throw"rotateZ() is not supported in 2D mode. Use rotate(float) instead."},Drawing3D.prototype.rotateZ=function(angleInRadians){modelView.rotateZ(angleInRadians),modelViewInv.invRotateZ(angleInRadians)},p.rotateY=function(angleInRadians){modelView.rotateY(angleInRadians),modelViewInv.invRotateY(angleInRadians)},Drawing2D.prototype.rotate=function(angleInRadians){modelView.rotateZ(angleInRadians),modelViewInv.invRotateZ(angleInRadians),curContext.rotate(angleInRadians)},Drawing3D.prototype.rotate=function(angleInRadians){arguments.length<4?p.rotateZ(angleInRadians):(modelView.rotate(angleInRadians,arguments[1],arguments[2],arguments[3]),modelViewInv.rotate(-angleInRadians,arguments[1],arguments[2],arguments[3]))},Drawing2D.prototype.shearX=function(angleInRadians){modelView.shearX(angleInRadians),curContext.transform(1,0,angleInRadians,1,0,0)},Drawing3D.prototype.shearX=function(angleInRadians){modelView.shearX(angleInRadians)},Drawing2D.prototype.shearY=function(angleInRadians){modelView.shearY(angleInRadians),curContext.transform(1,angleInRadians,0,1,0,0)},Drawing3D.prototype.shearY=function(angleInRadians){modelView.shearY(angleInRadians)},p.pushStyle=function(){saveContext(),p.pushMatrix();var newState={doFill:doFill,currentFillColor:currentFillColor,doStroke:doStroke,currentStrokeColor:currentStrokeColor,curTint:curTint,curRectMode:curRectMode,curColorMode:curColorMode,colorModeX:colorModeX,colorModeZ:colorModeZ,colorModeY:colorModeY,colorModeA:colorModeA,curTextFont:curTextFont,horizontalTextAlignment:horizontalTextAlignment,verticalTextAlignment:verticalTextAlignment,textMode:textMode,curFontName:curFontName,curTextSize:curTextSize,curTextAscent:curTextAscent,curTextDescent:curTextDescent,curTextLeading:curTextLeading};styleArray.push(newState)},p.popStyle=function(){var oldState=styleArray.pop();if(!oldState)throw"Too many popStyle() without enough pushStyle()";restoreContext(),p.popMatrix(),doFill=oldState.doFill,currentFillColor=oldState.currentFillColor,doStroke=oldState.doStroke,currentStrokeColor=oldState.currentStrokeColor,curTint=oldState.curTint,curRectMode=oldState.curRectMode,curColorMode=oldState.curColorMode,colorModeX=oldState.colorModeX,colorModeZ=oldState.colorModeZ,colorModeY=oldState.colorModeY,colorModeA=oldState.colorModeA,curTextFont=oldState.curTextFont,curFontName=oldState.curFontName,curTextSize=oldState.curTextSize,horizontalTextAlignment=oldState.horizontalTextAlignment,verticalTextAlignment=oldState.verticalTextAlignment,textMode=oldState.textMode,curTextAscent=oldState.curTextAscent,curTextDescent=oldState.curTextDescent,curTextLeading=oldState.curTextLeading},p.year=function(){return(new Date).getFullYear()},p.month=function(){return(new Date).getMonth()+1},p.day=function(){return(new Date).getDate()},p.hour=function(){return(new Date).getHours()},p.minute=function(){return(new Date).getMinutes()},p.second=function(){return(new Date).getSeconds()},p.millis=function(){return Date.now()-start},Drawing2D.prototype.redraw=function(){redrawHelper(),curContext.lineWidth=lineWidth;var pmouseXLastEvent=p.pmouseX,pmouseYLastEvent=p.pmouseY;p.pmouseX=pmouseXLastFrame,p.pmouseY=pmouseYLastFrame,saveContext(),p.draw(),restoreContext(),pmouseXLastFrame=p.mouseX,pmouseYLastFrame=p.mouseY,p.pmouseX=pmouseXLastEvent,p.pmouseY=pmouseYLastEvent},Drawing3D.prototype.redraw=function(){redrawHelper();var pmouseXLastEvent=p.pmouseX,pmouseYLastEvent=p.pmouseY;p.pmouseX=pmouseXLastFrame,p.pmouseY=pmouseYLastFrame,curContext.clear(curContext.DEPTH_BUFFER_BIT),curContextCache={attributes:{},locations:{}},p.noLights(),p.lightFalloff(1,0,0),p.shininess(1),p.ambient(255,255,255),p.specular(0,0,0),p.emissive(0,0,0),p.camera(),p.draw(),pmouseXLastFrame=p.mouseX,pmouseYLastFrame=p.mouseY,p.pmouseX=pmouseXLastEvent,p.pmouseY=pmouseYLastEvent},p.noLoop=function(){doLoop=!1,loopStarted=!1,clearInterval(looping),curSketch.onPause()},p.loop=function(){loopStarted||(timeSinceLastFPS=Date.now(),framesSinceLastFPS=0,looping=window.setInterval(function(){try{curSketch.onFrameStart(),p.redraw(),curSketch.onFrameEnd()}catch(e_loop){throw window.clearInterval(looping),e_loop}},curMsPerFrame),doLoop=!0,loopStarted=!0,curSketch.onLoop())},p.frameRate=function(aRate){curFrameRate=aRate,curMsPerFrame=1e3/curFrameRate,doLoop&&(p.noLoop(),p.loop())},p.exit=function(){window.clearInterval(looping),removeInstance(p.externals.canvas.id),delete curElement.onmousedown;for(var lib in Processing.lib)Processing.lib.hasOwnProperty(lib)&&Processing.lib[lib].hasOwnProperty("detach")&&Processing.lib[lib].detach(p);for(var i=eventHandlers.length;i--;)detachEventHandler(eventHandlers[i]);curSketch.onExit()},p.cursor=function(){if(arguments.length>1||1===arguments.length&&arguments[0]instanceof p.PImage){var x,y,image=arguments[0];if(arguments.length>=3){if(x=arguments[1],y=arguments[2],0>x||0>y||y>=image.height||x>=image.width)throw"x and y must be non-negative and less than the dimensions of the image"}else x=image.width>>>1,y=image.height>>>1;var imageDataURL=image.toDataURL(),style='url("'+imageDataURL+'") '+x+" "+y+", default";curCursor=curElement.style.cursor=style}else if(1===arguments.length){var mode=arguments[0];curCursor=curElement.style.cursor=mode}else curCursor=curElement.style.cursor=oldCursor},p.noCursor=function(){curCursor=curElement.style.cursor=PConstants.NOCURSOR},p.link=function(href,target){target!==undef?window.open(href,target):window.location=href},p.beginDraw=noop,p.endDraw=noop,Drawing2D.prototype.toImageData=function(x,y,w,h){return x=x!==undef?x:0,y=y!==undef?y:0,w=w!==undef?w:p.width,h=h!==undef?h:p.height,curContext.getImageData(x,y,w,h)},Drawing3D.prototype.toImageData=function(x,y,w,h){x=x!==undef?x:0,y=y!==undef?y:0,w=w!==undef?w:p.width,h=h!==undef?h:p.height;var c=document.createElement("canvas"),ctx=c.getContext("2d"),obj=ctx.createImageData(w,h),uBuff=new Uint8Array(w*h*4);curContext.readPixels(x,y,w,h,curContext.RGBA,curContext.UNSIGNED_BYTE,uBuff);for(var i=0,ul=uBuff.length,obj_data=obj.data;ul>i;i++)obj_data[i]=uBuff[(h-1-Math.floor(i/4/w))*w*4+i%(4*w)];return obj},p.status=function(text){window.status=text},p.binary=function(num,numBits){var bit;if(numBits>0)bit=numBits;else if(num instanceof Char)bit=16,num|=0;else for(bit=32;bit>1&&!(num>>>bit-1&1);)bit--;for(var result="";bit>0;)result+=num>>>--bit&1?"1":"0";return result},p.unbinary=function(binaryString){for(var i=binaryString.length-1,mask=1,result=0;i>=0;){var ch=binaryString[i--];if("0"!==ch&&"1"!==ch)throw"the value passed into unbinary was not an 8 bit binary number";"1"===ch&&(result+=mask),mask<<=1}return result};var decimalToHex=function(d,padding){padding=padding===undef||null===padding?padding=8:padding,0>d&&(d=4294967295+d+1);for(var hex=Number(d).toString(16).toUpperCase();hex.length<padding;)hex="0"+hex;return hex.length>=padding&&(hex=hex.substring(hex.length-padding,hex.length)),hex};p.hex=function(value,len){return 1===arguments.length&&(len=value instanceof Char?4:8),decimalToHex(value,len)},p.unhex=function(hex){if(hex instanceof Array){for(var arr=[],i=0;i<hex.length;i++)arr.push(unhexScalar(hex[i]));return arr}return unhexScalar(hex)},p.loadStrings=function(){return""},p.saveStrings=function(){},p.loadBytes=function(url){for(var string=ajax(url),ret=[],i=0;i<string.length;i++)ret.push(string.charCodeAt(i));return ret},p.matchAll=function(aString,aRegExp){for(var latest,results=[],regexp=new RegExp(aRegExp,"g");null!==(latest=regexp.exec(aString));)results.push(latest),0===latest[0].length&&++regexp.lastIndex;return results.length>0?results:null},p.match=function(str,regexp){return str.match(regexp)};p.println=function(message){Processing.logger.println(message)},p.print=function(message){Processing.logger.print(message)},p.str=function(val){if(val instanceof Array){for(var arr=[],i=0;i<val.length;i++)arr.push(val[i].toString()+"");return arr}return val.toString()+""},p.parseBoolean=function(val){if(val instanceof Array){for(var ret=[],i=0;i<val.length;i++)ret.push(booleanScalar(val[i]));return ret}return booleanScalar(val)},p.parseByte=function(what){if(what instanceof Array){for(var bytes=[],i=0;i<what.length;i++)bytes.push(0-(128&what[i])|127&what[i]);return bytes}return 0-(128&what)|127&what},p.parseChar=function(key){if("number"==typeof key)return new Char(String.fromCharCode(65535&key));if(key instanceof Array){for(var ret=[],i=0;i<key.length;i++)ret.push(new Char(String.fromCharCode(65535&key[i])));return ret}throw"char() may receive only one argument of type int, byte, int[], or byte[]."},p.parseFloat=function(val){if(val instanceof Array){for(var ret=[],i=0;i<val.length;i++)ret.push(floatScalar(val[i]));return ret}return floatScalar(val)},p.parseInt=function(val,radix){if(val instanceof Array){for(var ret=[],i=0;i<val.length;i++)ret.push("string"!=typeof val[i]||/^\s*[+\-]?\d+\s*$/.test(val[i])?intScalar(val[i],radix):0);return ret}return intScalar(val,radix)},p.__int_cast=function(val){return 0|val},p.__instanceof=function(obj,type){if("function"!=typeof type)throw"Function is expected as type argument for instanceof operator";if("string"==typeof obj)return type===Object||type===String;if(obj instanceof type)return!0;if("object"!=typeof obj||null===obj)return!1;var objType=obj.constructor;if(type.$isInterface){for(var interfaces=[];objType;)objType.$interfaces&&(interfaces=interfaces.concat(objType.$interfaces)),objType=objType.$base;for(;interfaces.length>0;){var i=interfaces.shift();if(i===type)return!0;i.$interfaces&&(interfaces=interfaces.concat(i.$interfaces))}return!1}for(;objType.hasOwnProperty("$base");)if(objType=objType.$base,objType===type)return!0;return!1},DrawingShared.prototype.size=function(aWidth,aHeight){doStroke&&p.stroke(0),doFill&&p.fill(255);var savedProperties={fillStyle:curContext.fillStyle,strokeStyle:curContext.strokeStyle,lineCap:curContext.lineCap,lineJoin:curContext.lineJoin};curElement.style.length>0&&(curElement.style.removeProperty("width"),curElement.style.removeProperty("height")),curElement.width=p.width=aWidth||100,curElement.height=p.height=aHeight||100;for(var prop in savedProperties)savedProperties.hasOwnProperty(prop)&&(curContext[prop]=savedProperties[prop]);p.textFont(curTextFont),p.background(),maxPixelsCached=Math.max(1e3,aWidth*aHeight*.05),p.externals.context=curContext;for(var i=0;i<PConstants.SINCOS_LENGTH;i++)sinLUT[i]=p.sin(i*(PConstants.PI/180)*.5),cosLUT[i]=p.cos(i*(PConstants.PI/180)*.5)},Drawing2D.prototype.size=function(){curContext===undef&&(curContext=curElement.getContext("2d"),userMatrixStack=new PMatrixStack,userReverseMatrixStack=new PMatrixStack,modelView=new PMatrix2D,modelViewInv=new PMatrix2D),DrawingShared.prototype.size.apply(this,arguments)},Drawing3D.prototype.size=function(){var size3DCalled=!1;return function(aWidth,aHeight){function getGLContext(canvas){for(var gl,ctxNames=["experimental-webgl","webgl","webkit-3d"],i=0,l=ctxNames.length;l>i&&!(gl=canvas.getContext(ctxNames[i],{antialias:!1,preserveDrawingBuffer:!0}));i++);return gl}if(size3DCalled)throw"Multiple calls to size() for 3D renders are not allowed.";size3DCalled=!0;try{curElement.width=p.width=aWidth||100,curElement.height=p.height=aHeight||100,curContext=getGLContext(curElement),canTex=curContext.createTexture(),textTex=curContext.createTexture()}catch(e_size){Processing.debug(e_size)}if(!curContext)throw"WebGL context is not supported on this browser.";curContext.viewport(0,0,curElement.width,curElement.height),curContext.enable(curContext.DEPTH_TEST),curContext.enable(curContext.BLEND),curContext.blendFunc(curContext.SRC_ALPHA,curContext.ONE_MINUS_SRC_ALPHA),programObject2D=createProgramObject(curContext,vertexShaderSrc2D,fragmentShaderSrc2D),programObjectUnlitShape=createProgramObject(curContext,vertexShaderSrcUnlitShape,fragmentShaderSrcUnlitShape),p.strokeWeight(1),programObject3D=createProgramObject(curContext,vertexShaderSrc3D,fragmentShaderSrc3D),curContext.useProgram(programObject3D),uniformi("usingTexture3d",programObject3D,"usingTexture",usingTexture),p.lightFalloff(1,0,0),p.shininess(1),p.ambient(255,255,255),p.specular(0,0,0),p.emissive(0,0,0),boxBuffer=curContext.createBuffer(),curContext.bindBuffer(curContext.ARRAY_BUFFER,boxBuffer),curContext.bufferData(curContext.ARRAY_BUFFER,boxVerts,curContext.STATIC_DRAW),boxNormBuffer=curContext.createBuffer(),curContext.bindBuffer(curContext.ARRAY_BUFFER,boxNormBuffer),curContext.bufferData(curContext.ARRAY_BUFFER,boxNorms,curContext.STATIC_DRAW),boxOutlineBuffer=curContext.createBuffer(),curContext.bindBuffer(curContext.ARRAY_BUFFER,boxOutlineBuffer),curContext.bufferData(curContext.ARRAY_BUFFER,boxOutlineVerts,curContext.STATIC_DRAW),rectBuffer=curContext.createBuffer(),curContext.bindBuffer(curContext.ARRAY_BUFFER,rectBuffer),curContext.bufferData(curContext.ARRAY_BUFFER,rectVerts,curContext.STATIC_DRAW),rectNormBuffer=curContext.createBuffer(),curContext.bindBuffer(curContext.ARRAY_BUFFER,rectNormBuffer),curContext.bufferData(curContext.ARRAY_BUFFER,rectNorms,curContext.STATIC_DRAW),sphereBuffer=curContext.createBuffer(),lineBuffer=curContext.createBuffer(),fillBuffer=curContext.createBuffer(),fillColorBuffer=curContext.createBuffer(),strokeColorBuffer=curContext.createBuffer(),shapeTexVBO=curContext.createBuffer(),pointBuffer=curContext.createBuffer(),curContext.bindBuffer(curContext.ARRAY_BUFFER,pointBuffer),curContext.bufferData(curContext.ARRAY_BUFFER,new Float32Array([0,0,0]),curContext.STATIC_DRAW),textBuffer=curContext.createBuffer(),curContext.bindBuffer(curContext.ARRAY_BUFFER,textBuffer),curContext.bufferData(curContext.ARRAY_BUFFER,new Float32Array([1,1,0,-1,1,0,-1,-1,0,1,-1,0]),curContext.STATIC_DRAW),textureBuffer=curContext.createBuffer(),curContext.bindBuffer(curContext.ARRAY_BUFFER,textureBuffer),curContext.bufferData(curContext.ARRAY_BUFFER,new Float32Array([0,0,1,0,1,1,0,1]),curContext.STATIC_DRAW),indexBuffer=curContext.createBuffer(),curContext.bindBuffer(curContext.ELEMENT_ARRAY_BUFFER,indexBuffer),curContext.bufferData(curContext.ELEMENT_ARRAY_BUFFER,new Uint16Array([0,1,2,2,3,0]),curContext.STATIC_DRAW),cam=new PMatrix3D,cameraInv=new PMatrix3D,modelView=new PMatrix3D,modelViewInv=new PMatrix3D,projection=new PMatrix3D,p.camera(),p.perspective(),userMatrixStack=new PMatrixStack,userReverseMatrixStack=new PMatrixStack,curveBasisMatrix=new PMatrix3D,curveToBezierMatrix=new PMatrix3D,curveDrawMatrix=new PMatrix3D,bezierDrawMatrix=new PMatrix3D,bezierBasisInverse=new PMatrix3D,bezierBasisMatrix=new PMatrix3D,bezierBasisMatrix.set(-1,3,-3,1,3,-6,3,0,-3,3,0,0,1,0,0,0),DrawingShared.prototype.size.apply(this,arguments)
}}(),Drawing2D.prototype.ambientLight=DrawingShared.prototype.a3DOnlyFunction,Drawing3D.prototype.ambientLight=function(r,g,b,x,y,z){if(lightCount===PConstants.MAX_LIGHTS)throw"can only create "+PConstants.MAX_LIGHTS+" lights";var pos=new PVector(x,y,z),view=new PMatrix3D;view.scale(1,-1,1),view.apply(modelView.array()),view.mult(pos,pos);var col=color$4(r,g,b,0),normalizedCol=[((col&PConstants.RED_MASK)>>>16)/255,((col&PConstants.GREEN_MASK)>>>8)/255,(col&PConstants.BLUE_MASK)/255];curContext.useProgram(programObject3D),uniformf("uLights.color.3d."+lightCount,programObject3D,"uLights"+lightCount+".color",normalizedCol),uniformf("uLights.position.3d."+lightCount,programObject3D,"uLights"+lightCount+".position",pos.array()),uniformi("uLights.type.3d."+lightCount,programObject3D,"uLights"+lightCount+".type",0),uniformi("uLightCount3d",programObject3D,"uLightCount",++lightCount)},Drawing2D.prototype.directionalLight=DrawingShared.prototype.a3DOnlyFunction,Drawing3D.prototype.directionalLight=function(r,g,b,nx,ny,nz){if(lightCount===PConstants.MAX_LIGHTS)throw"can only create "+PConstants.MAX_LIGHTS+" lights";curContext.useProgram(programObject3D);var mvm=new PMatrix3D;mvm.scale(1,-1,1),mvm.apply(modelView.array()),mvm=mvm.array();var dir=[mvm[0]*nx+mvm[4]*ny+mvm[8]*nz,mvm[1]*nx+mvm[5]*ny+mvm[9]*nz,mvm[2]*nx+mvm[6]*ny+mvm[10]*nz],col=color$4(r,g,b,0),normalizedCol=[((col&PConstants.RED_MASK)>>>16)/255,((col&PConstants.GREEN_MASK)>>>8)/255,(col&PConstants.BLUE_MASK)/255];uniformf("uLights.color.3d."+lightCount,programObject3D,"uLights"+lightCount+".color",normalizedCol),uniformf("uLights.position.3d."+lightCount,programObject3D,"uLights"+lightCount+".position",dir),uniformi("uLights.type.3d."+lightCount,programObject3D,"uLights"+lightCount+".type",1),uniformi("uLightCount3d",programObject3D,"uLightCount",++lightCount)},Drawing2D.prototype.lightFalloff=DrawingShared.prototype.a3DOnlyFunction,Drawing3D.prototype.lightFalloff=function(constant,linear,quadratic){curContext.useProgram(programObject3D),uniformf("uFalloff3d",programObject3D,"uFalloff",[constant,linear,quadratic])},Drawing2D.prototype.lightSpecular=DrawingShared.prototype.a3DOnlyFunction,Drawing3D.prototype.lightSpecular=function(r,g,b){var col=color$4(r,g,b,0),normalizedCol=[((col&PConstants.RED_MASK)>>>16)/255,((col&PConstants.GREEN_MASK)>>>8)/255,(col&PConstants.BLUE_MASK)/255];curContext.useProgram(programObject3D),uniformf("uSpecular3d",programObject3D,"uSpecular",normalizedCol)},p.lights=function(){p.ambientLight(128,128,128),p.directionalLight(128,128,128,0,0,-1),p.lightFalloff(1,0,0),p.lightSpecular(0,0,0)},Drawing2D.prototype.pointLight=DrawingShared.prototype.a3DOnlyFunction,Drawing3D.prototype.pointLight=function(r,g,b,x,y,z){if(lightCount===PConstants.MAX_LIGHTS)throw"can only create "+PConstants.MAX_LIGHTS+" lights";var pos=new PVector(x,y,z),view=new PMatrix3D;view.scale(1,-1,1),view.apply(modelView.array()),view.mult(pos,pos);var col=color$4(r,g,b,0),normalizedCol=[((col&PConstants.RED_MASK)>>>16)/255,((col&PConstants.GREEN_MASK)>>>8)/255,(col&PConstants.BLUE_MASK)/255];curContext.useProgram(programObject3D),uniformf("uLights.color.3d."+lightCount,programObject3D,"uLights"+lightCount+".color",normalizedCol),uniformf("uLights.position.3d."+lightCount,programObject3D,"uLights"+lightCount+".position",pos.array()),uniformi("uLights.type.3d."+lightCount,programObject3D,"uLights"+lightCount+".type",2),uniformi("uLightCount3d",programObject3D,"uLightCount",++lightCount)},Drawing2D.prototype.noLights=DrawingShared.prototype.a3DOnlyFunction,Drawing3D.prototype.noLights=function(){lightCount=0,curContext.useProgram(programObject3D),uniformi("uLightCount3d",programObject3D,"uLightCount",lightCount)},Drawing2D.prototype.spotLight=DrawingShared.prototype.a3DOnlyFunction,Drawing3D.prototype.spotLight=function(r,g,b,x,y,z,nx,ny,nz,angle,concentration){if(lightCount===PConstants.MAX_LIGHTS)throw"can only create "+PConstants.MAX_LIGHTS+" lights";curContext.useProgram(programObject3D);var pos=new PVector(x,y,z),mvm=new PMatrix3D;mvm.scale(1,-1,1),mvm.apply(modelView.array()),mvm.mult(pos,pos),mvm=mvm.array();var dir=[mvm[0]*nx+mvm[4]*ny+mvm[8]*nz,mvm[1]*nx+mvm[5]*ny+mvm[9]*nz,mvm[2]*nx+mvm[6]*ny+mvm[10]*nz],col=color$4(r,g,b,0),normalizedCol=[((col&PConstants.RED_MASK)>>>16)/255,((col&PConstants.GREEN_MASK)>>>8)/255,(col&PConstants.BLUE_MASK)/255];uniformf("uLights.color.3d."+lightCount,programObject3D,"uLights"+lightCount+".color",normalizedCol),uniformf("uLights.position.3d."+lightCount,programObject3D,"uLights"+lightCount+".position",pos.array()),uniformf("uLights.direction.3d."+lightCount,programObject3D,"uLights"+lightCount+".direction",dir),uniformf("uLights.concentration.3d."+lightCount,programObject3D,"uLights"+lightCount+".concentration",concentration),uniformf("uLights.angle.3d."+lightCount,programObject3D,"uLights"+lightCount+".angle",angle),uniformi("uLights.type.3d."+lightCount,programObject3D,"uLights"+lightCount+".type",3),uniformi("uLightCount3d",programObject3D,"uLightCount",++lightCount)},Drawing2D.prototype.beginCamera=function(){throw"beginCamera() is not available in 2D mode"},Drawing3D.prototype.beginCamera=function(){if(manipulatingCamera)throw"You cannot call beginCamera() again before calling endCamera()";manipulatingCamera=!0,modelView=cameraInv,modelViewInv=cam},Drawing2D.prototype.endCamera=function(){throw"endCamera() is not available in 2D mode"},Drawing3D.prototype.endCamera=function(){if(!manipulatingCamera)throw"You cannot call endCamera() before calling beginCamera()";modelView.set(cam),modelViewInv.set(cameraInv),manipulatingCamera=!1},p.camera=function(eyeX,eyeY,eyeZ,centerX,centerY,centerZ,upX,upY,upZ){eyeX===undef&&(cameraX=p.width/2,cameraY=p.height/2,cameraZ=cameraY/Math.tan(cameraFOV/2),eyeX=cameraX,eyeY=cameraY,eyeZ=cameraZ,centerX=cameraX,centerY=cameraY,centerZ=0,upX=0,upY=1,upZ=0);var z=new PVector(eyeX-centerX,eyeY-centerY,eyeZ-centerZ),y=new PVector(upX,upY,upZ);z.normalize();var x=PVector.cross(y,z);y=PVector.cross(z,x),x.normalize(),y.normalize();var xX=x.x,xY=x.y,xZ=x.z,yX=y.x,yY=y.y,yZ=y.z,zX=z.x,zY=z.y,zZ=z.z;cam.set(xX,xY,xZ,0,yX,yY,yZ,0,zX,zY,zZ,0,0,0,0,1),cam.translate(-eyeX,-eyeY,-eyeZ),cameraInv.reset(),cameraInv.invApply(xX,xY,xZ,0,yX,yY,yZ,0,zX,zY,zZ,0,0,0,0,1),cameraInv.translate(eyeX,eyeY,eyeZ),modelView.set(cam),modelViewInv.set(cameraInv)},p.perspective=function(fov,aspect,near,far){0===arguments.length&&(cameraY=curElement.height/2,cameraZ=cameraY/Math.tan(cameraFOV/2),cameraNear=cameraZ/10,cameraFar=10*cameraZ,cameraAspect=p.width/p.height,fov=cameraFOV,aspect=cameraAspect,near=cameraNear,far=cameraFar);var yMax,yMin,xMax,xMin;yMax=near*Math.tan(fov/2),yMin=-yMax,xMax=yMax*aspect,xMin=yMin*aspect,p.frustum(xMin,xMax,yMin,yMax,near,far)},Drawing2D.prototype.frustum=function(){throw"Processing.js: frustum() is not supported in 2D mode"},Drawing3D.prototype.frustum=function(left,right,bottom,top,near,far){frustumMode=!0,projection=new PMatrix3D,projection.set(2*near/(right-left),0,(right+left)/(right-left),0,0,2*near/(top-bottom),(top+bottom)/(top-bottom),0,0,0,-(far+near)/(far-near),-(2*far*near)/(far-near),0,0,-1,0);var proj=new PMatrix3D;proj.set(projection),proj.transpose(),curContext.useProgram(programObject2D),uniformMatrix("projection2d",programObject2D,"uProjection",!1,proj.array()),curContext.useProgram(programObject3D),uniformMatrix("projection3d",programObject3D,"uProjection",!1,proj.array()),curContext.useProgram(programObjectUnlitShape),uniformMatrix("uProjectionUS",programObjectUnlitShape,"uProjection",!1,proj.array())},p.ortho=function(left,right,bottom,top,near,far){0===arguments.length&&(left=0,right=p.width,bottom=0,top=p.height,near=-10,far=10);var x=2/(right-left),y=2/(top-bottom),z=-2/(far-near),tx=-(right+left)/(right-left),ty=-(top+bottom)/(top-bottom),tz=-(far+near)/(far-near);projection=new PMatrix3D,projection.set(x,0,0,tx,0,y,0,ty,0,0,z,tz,0,0,0,1);var proj=new PMatrix3D;proj.set(projection),proj.transpose(),curContext.useProgram(programObject2D),uniformMatrix("projection2d",programObject2D,"uProjection",!1,proj.array()),curContext.useProgram(programObject3D),uniformMatrix("projection3d",programObject3D,"uProjection",!1,proj.array()),curContext.useProgram(programObjectUnlitShape),uniformMatrix("uProjectionUS",programObjectUnlitShape,"uProjection",!1,proj.array()),frustumMode=!1},p.printProjection=function(){projection.print()},p.printCamera=function(){cam.print()},Drawing2D.prototype.box=DrawingShared.prototype.a3DOnlyFunction,Drawing3D.prototype.box=function(w,h,d){h&&d||(h=d=w);var model=new PMatrix3D;model.scale(w,h,d);var view=new PMatrix3D;if(view.scale(1,-1,1),view.apply(modelView.array()),view.transpose(),doFill){if(curContext.useProgram(programObject3D),uniformMatrix("model3d",programObject3D,"uModel",!1,model.array()),uniformMatrix("view3d",programObject3D,"uView",!1,view.array()),curContext.enable(curContext.POLYGON_OFFSET_FILL),curContext.polygonOffset(1,1),uniformf("color3d",programObject3D,"uColor",fillStyle),lightCount>0){var v=new PMatrix3D;v.set(view);var m=new PMatrix3D;m.set(model),v.mult(m);var normalMatrix=new PMatrix3D;normalMatrix.set(v),normalMatrix.invert(),normalMatrix.transpose(),uniformMatrix("uNormalTransform3d",programObject3D,"uNormalTransform",!1,normalMatrix.array()),vertexAttribPointer("aNormal3d",programObject3D,"aNormal",3,boxNormBuffer)}else disableVertexAttribPointer("aNormal3d",programObject3D,"aNormal");vertexAttribPointer("aVertex3d",programObject3D,"aVertex",3,boxBuffer),disableVertexAttribPointer("aColor3d",programObject3D,"aColor"),disableVertexAttribPointer("aTexture3d",programObject3D,"aTexture"),curContext.drawArrays(curContext.TRIANGLES,0,boxVerts.length/3),curContext.disable(curContext.POLYGON_OFFSET_FILL)}lineWidth>0&&doStroke&&(curContext.useProgram(programObject2D),uniformMatrix("uModel2d",programObject2D,"uModel",!1,model.array()),uniformMatrix("uView2d",programObject2D,"uView",!1,view.array()),uniformf("uColor2d",programObject2D,"uColor",strokeStyle),uniformi("uIsDrawingText2d",programObject2D,"uIsDrawingText",!1),vertexAttribPointer("vertex2d",programObject2D,"aVertex",3,boxOutlineBuffer),disableVertexAttribPointer("aTextureCoord2d",programObject2D,"aTextureCoord"),curContext.drawArrays(curContext.LINES,0,boxOutlineVerts.length/3))};var initSphere=function(){var i;for(sphereVerts=[],i=0;sphereDetailU>i;i++)sphereVerts.push(0),sphereVerts.push(-1),sphereVerts.push(0),sphereVerts.push(sphereX[i]),sphereVerts.push(sphereY[i]),sphereVerts.push(sphereZ[i]);sphereVerts.push(0),sphereVerts.push(-1),sphereVerts.push(0),sphereVerts.push(sphereX[0]),sphereVerts.push(sphereY[0]),sphereVerts.push(sphereZ[0]);var v1,v11,v2,voff=0;for(i=2;sphereDetailV>i;i++){v1=v11=voff,voff+=sphereDetailU,v2=voff;for(var j=0;sphereDetailU>j;j++)sphereVerts.push(sphereX[v1]),sphereVerts.push(sphereY[v1]),sphereVerts.push(sphereZ[v1++]),sphereVerts.push(sphereX[v2]),sphereVerts.push(sphereY[v2]),sphereVerts.push(sphereZ[v2++]);v1=v11,v2=voff,sphereVerts.push(sphereX[v1]),sphereVerts.push(sphereY[v1]),sphereVerts.push(sphereZ[v1]),sphereVerts.push(sphereX[v2]),sphereVerts.push(sphereY[v2]),sphereVerts.push(sphereZ[v2])}for(i=0;sphereDetailU>i;i++)v2=voff+i,sphereVerts.push(sphereX[v2]),sphereVerts.push(sphereY[v2]),sphereVerts.push(sphereZ[v2]),sphereVerts.push(0),sphereVerts.push(1),sphereVerts.push(0);sphereVerts.push(sphereX[voff]),sphereVerts.push(sphereY[voff]),sphereVerts.push(sphereZ[voff]),sphereVerts.push(0),sphereVerts.push(1),sphereVerts.push(0),curContext.bindBuffer(curContext.ARRAY_BUFFER,sphereBuffer),curContext.bufferData(curContext.ARRAY_BUFFER,new Float32Array(sphereVerts),curContext.STATIC_DRAW)};p.sphereDetail=function(ures,vres){var i;if(1===arguments.length&&(ures=vres=arguments[0]),3>ures&&(ures=3),2>vres&&(vres=2),ures!==sphereDetailU||vres!==sphereDetailV){var delta=PConstants.SINCOS_LENGTH/ures,cx=new Float32Array(ures),cz=new Float32Array(ures);for(i=0;ures>i;i++)cx[i]=cosLUT[i*delta%PConstants.SINCOS_LENGTH|0],cz[i]=sinLUT[i*delta%PConstants.SINCOS_LENGTH|0];var vertCount=ures*(vres-1)+2,currVert=0;sphereX=new Float32Array(vertCount),sphereY=new Float32Array(vertCount),sphereZ=new Float32Array(vertCount);var angle_step=.5*PConstants.SINCOS_LENGTH/vres,angle=angle_step;for(i=1;vres>i;i++){for(var curradius=sinLUT[angle%PConstants.SINCOS_LENGTH|0],currY=-cosLUT[angle%PConstants.SINCOS_LENGTH|0],j=0;ures>j;j++)sphereX[currVert]=cx[j]*curradius,sphereY[currVert]=currY,sphereZ[currVert++]=cz[j]*curradius;angle+=angle_step}sphereDetailU=ures,sphereDetailV=vres,initSphere()}},Drawing2D.prototype.sphere=DrawingShared.prototype.a3DOnlyFunction,Drawing3D.prototype.sphere=function(){var sRad=arguments[0];(3>sphereDetailU||2>sphereDetailV)&&p.sphereDetail(30);var model=new PMatrix3D;model.scale(sRad,sRad,sRad);var view=new PMatrix3D;if(view.scale(1,-1,1),view.apply(modelView.array()),view.transpose(),doFill){if(lightCount>0){var v=new PMatrix3D;v.set(view);var m=new PMatrix3D;m.set(model),v.mult(m);var normalMatrix=new PMatrix3D;normalMatrix.set(v),normalMatrix.invert(),normalMatrix.transpose(),uniformMatrix("uNormalTransform3d",programObject3D,"uNormalTransform",!1,normalMatrix.array()),vertexAttribPointer("aNormal3d",programObject3D,"aNormal",3,sphereBuffer)}else disableVertexAttribPointer("aNormal3d",programObject3D,"aNormal");curContext.useProgram(programObject3D),disableVertexAttribPointer("aTexture3d",programObject3D,"aTexture"),uniformMatrix("uModel3d",programObject3D,"uModel",!1,model.array()),uniformMatrix("uView3d",programObject3D,"uView",!1,view.array()),vertexAttribPointer("aVertex3d",programObject3D,"aVertex",3,sphereBuffer),disableVertexAttribPointer("aColor3d",programObject3D,"aColor"),curContext.enable(curContext.POLYGON_OFFSET_FILL),curContext.polygonOffset(1,1),uniformf("uColor3d",programObject3D,"uColor",fillStyle),curContext.drawArrays(curContext.TRIANGLE_STRIP,0,sphereVerts.length/3),curContext.disable(curContext.POLYGON_OFFSET_FILL)}lineWidth>0&&doStroke&&(curContext.useProgram(programObject2D),uniformMatrix("uModel2d",programObject2D,"uModel",!1,model.array()),uniformMatrix("uView2d",programObject2D,"uView",!1,view.array()),vertexAttribPointer("aVertex2d",programObject2D,"aVertex",3,sphereBuffer),disableVertexAttribPointer("aTextureCoord2d",programObject2D,"aTextureCoord"),uniformf("uColor2d",programObject2D,"uColor",strokeStyle),uniformi("uIsDrawingText",programObject2D,"uIsDrawingText",!1),curContext.drawArrays(curContext.LINE_STRIP,0,sphereVerts.length/3))},p.modelX=function(x,y,z){var mv=modelView.array(),ci=cameraInv.array(),ax=mv[0]*x+mv[1]*y+mv[2]*z+mv[3],ay=mv[4]*x+mv[5]*y+mv[6]*z+mv[7],az=mv[8]*x+mv[9]*y+mv[10]*z+mv[11],aw=mv[12]*x+mv[13]*y+mv[14]*z+mv[15],ox=ci[0]*ax+ci[1]*ay+ci[2]*az+ci[3]*aw,ow=ci[12]*ax+ci[13]*ay+ci[14]*az+ci[15]*aw;return 0!==ow?ox/ow:ox},p.modelY=function(x,y,z){var mv=modelView.array(),ci=cameraInv.array(),ax=mv[0]*x+mv[1]*y+mv[2]*z+mv[3],ay=mv[4]*x+mv[5]*y+mv[6]*z+mv[7],az=mv[8]*x+mv[9]*y+mv[10]*z+mv[11],aw=mv[12]*x+mv[13]*y+mv[14]*z+mv[15],oy=ci[4]*ax+ci[5]*ay+ci[6]*az+ci[7]*aw,ow=ci[12]*ax+ci[13]*ay+ci[14]*az+ci[15]*aw;return 0!==ow?oy/ow:oy},p.modelZ=function(x,y,z){var mv=modelView.array(),ci=cameraInv.array(),ax=mv[0]*x+mv[1]*y+mv[2]*z+mv[3],ay=mv[4]*x+mv[5]*y+mv[6]*z+mv[7],az=mv[8]*x+mv[9]*y+mv[10]*z+mv[11],aw=mv[12]*x+mv[13]*y+mv[14]*z+mv[15],oz=ci[8]*ax+ci[9]*ay+ci[10]*az+ci[11]*aw,ow=ci[12]*ax+ci[13]*ay+ci[14]*az+ci[15]*aw;return 0!==ow?oz/ow:oz},Drawing2D.prototype.ambient=DrawingShared.prototype.a3DOnlyFunction,Drawing3D.prototype.ambient=function(v1,v2,v3){curContext.useProgram(programObject3D),uniformi("uUsingMat3d",programObject3D,"uUsingMat",!0);var col=p.color(v1,v2,v3);uniformf("uMaterialAmbient3d",programObject3D,"uMaterialAmbient",p.color.toGLArray(col).slice(0,3))},Drawing2D.prototype.emissive=DrawingShared.prototype.a3DOnlyFunction,Drawing3D.prototype.emissive=function(v1,v2,v3){curContext.useProgram(programObject3D),uniformi("uUsingMat3d",programObject3D,"uUsingMat",!0);var col=p.color(v1,v2,v3);uniformf("uMaterialEmissive3d",programObject3D,"uMaterialEmissive",p.color.toGLArray(col).slice(0,3))},Drawing2D.prototype.shininess=DrawingShared.prototype.a3DOnlyFunction,Drawing3D.prototype.shininess=function(shine){curContext.useProgram(programObject3D),uniformi("uUsingMat3d",programObject3D,"uUsingMat",!0),uniformf("uShininess3d",programObject3D,"uShininess",shine)},Drawing2D.prototype.specular=DrawingShared.prototype.a3DOnlyFunction,Drawing3D.prototype.specular=function(v1,v2,v3){curContext.useProgram(programObject3D),uniformi("uUsingMat3d",programObject3D,"uUsingMat",!0);var col=p.color(v1,v2,v3);uniformf("uMaterialSpecular3d",programObject3D,"uMaterialSpecular",p.color.toGLArray(col).slice(0,3))},p.screenX=function(x,y,z){var mv=modelView.array();if(16===mv.length){var ax=mv[0]*x+mv[1]*y+mv[2]*z+mv[3],ay=mv[4]*x+mv[5]*y+mv[6]*z+mv[7],az=mv[8]*x+mv[9]*y+mv[10]*z+mv[11],aw=mv[12]*x+mv[13]*y+mv[14]*z+mv[15],pj=projection.array(),ox=pj[0]*ax+pj[1]*ay+pj[2]*az+pj[3]*aw,ow=pj[12]*ax+pj[13]*ay+pj[14]*az+pj[15]*aw;return 0!==ow&&(ox/=ow),p.width*(1+ox)/2}return modelView.multX(x,y)},p.screenY=function(x,y,z){var mv=modelView.array();if(16===mv.length){var ax=mv[0]*x+mv[1]*y+mv[2]*z+mv[3],ay=mv[4]*x+mv[5]*y+mv[6]*z+mv[7],az=mv[8]*x+mv[9]*y+mv[10]*z+mv[11],aw=mv[12]*x+mv[13]*y+mv[14]*z+mv[15],pj=projection.array(),oy=pj[4]*ax+pj[5]*ay+pj[6]*az+pj[7]*aw,ow=pj[12]*ax+pj[13]*ay+pj[14]*az+pj[15]*aw;return 0!==ow&&(oy/=ow),p.height*(1+oy)/2}return modelView.multY(x,y)},p.screenZ=function(x,y,z){var mv=modelView.array();if(16!==mv.length)return 0;var pj=projection.array(),ax=mv[0]*x+mv[1]*y+mv[2]*z+mv[3],ay=mv[4]*x+mv[5]*y+mv[6]*z+mv[7],az=mv[8]*x+mv[9]*y+mv[10]*z+mv[11],aw=mv[12]*x+mv[13]*y+mv[14]*z+mv[15],oz=pj[8]*ax+pj[9]*ay+pj[10]*az+pj[11]*aw,ow=pj[12]*ax+pj[13]*ay+pj[14]*az+pj[15]*aw;return 0!==ow&&(oz/=ow),(oz+1)/2},DrawingShared.prototype.fill=function(){var color=p.color.apply(this,arguments);color===currentFillColor&&doFill||(doFill=!0,currentFillColor=color)},Drawing2D.prototype.fill=function(){DrawingShared.prototype.fill.apply(this,arguments),isFillDirty=!0},Drawing3D.prototype.fill=function(){DrawingShared.prototype.fill.apply(this,arguments),fillStyle=p.color.toGLArray(currentFillColor)},p.noFill=function(){doFill=!1},DrawingShared.prototype.stroke=function(){var color=p.color.apply(this,arguments);color===currentStrokeColor&&doStroke||(doStroke=!0,currentStrokeColor=color)},Drawing2D.prototype.stroke=function(){DrawingShared.prototype.stroke.apply(this,arguments),isStrokeDirty=!0},Drawing3D.prototype.stroke=function(){DrawingShared.prototype.stroke.apply(this,arguments),strokeStyle=p.color.toGLArray(currentStrokeColor)},p.noStroke=function(){doStroke=!1},DrawingShared.prototype.strokeWeight=function(w){lineWidth=w},Drawing2D.prototype.strokeWeight=function(w){DrawingShared.prototype.strokeWeight.apply(this,arguments),curContext.lineWidth=w},Drawing3D.prototype.strokeWeight=function(w){DrawingShared.prototype.strokeWeight.apply(this,arguments),curContext.useProgram(programObject2D),uniformf("pointSize2d",programObject2D,"uPointSize",w),curContext.useProgram(programObjectUnlitShape),uniformf("pointSizeUnlitShape",programObjectUnlitShape,"uPointSize",w),curContext.lineWidth(w)},p.strokeCap=function(value){drawing.$ensureContext().lineCap=value},p.strokeJoin=function(value){drawing.$ensureContext().lineJoin=value},Drawing2D.prototype.smooth=function(){renderSmooth=!0;var style=curElement.style;style.setProperty("image-rendering","optimizeQuality","important"),style.setProperty("-ms-interpolation-mode","bicubic","important"),curContext.hasOwnProperty("mozImageSmoothingEnabled")&&(curContext.mozImageSmoothingEnabled=!0)},Drawing3D.prototype.smooth=function(){renderSmooth=!0},Drawing2D.prototype.noSmooth=function(){renderSmooth=!1;var style=curElement.style;style.setProperty("image-rendering","optimizeSpeed","important"),style.setProperty("image-rendering","-moz-crisp-edges","important"),style.setProperty("image-rendering","-webkit-optimize-contrast","important"),style.setProperty("image-rendering","optimize-contrast","important"),style.setProperty("-ms-interpolation-mode","nearest-neighbor","important"),curContext.hasOwnProperty("mozImageSmoothingEnabled")&&(curContext.mozImageSmoothingEnabled=!1)},Drawing3D.prototype.noSmooth=function(){renderSmooth=!1},Drawing2D.prototype.point=function(x,y){doStroke&&(x=Math.round(x),y=Math.round(y),curContext.fillStyle=p.color.toString(currentStrokeColor),isFillDirty=!0,lineWidth>1?(curContext.beginPath(),curContext.arc(x,y,lineWidth/2,0,PConstants.TWO_PI,!1),curContext.fill()):curContext.fillRect(x,y,1,1))},Drawing3D.prototype.point=function(x,y,z){var model=new PMatrix3D;model.translate(x,y,z||0),model.transpose();var view=new PMatrix3D;view.scale(1,-1,1),view.apply(modelView.array()),view.transpose(),curContext.useProgram(programObject2D),uniformMatrix("uModel2d",programObject2D,"uModel",!1,model.array()),uniformMatrix("uView2d",programObject2D,"uView",!1,view.array()),lineWidth>0&&doStroke&&(uniformf("uColor2d",programObject2D,"uColor",strokeStyle),uniformi("uIsDrawingText2d",programObject2D,"uIsDrawingText",!1),uniformi("uSmooth2d",programObject2D,"uSmooth",renderSmooth),vertexAttribPointer("aVertex2d",programObject2D,"aVertex",3,pointBuffer),disableVertexAttribPointer("aTextureCoord2d",programObject2D,"aTextureCoord"),curContext.drawArrays(curContext.POINTS,0,1))},p.beginShape=function(type){curShape=type,curvePoints=[],vertArray=[]},Drawing2D.prototype.vertex=function(x,y,moveTo){var vert=[];firstVert&&(firstVert=!1),vert.isVert=!0,vert[0]=x,vert[1]=y,vert[2]=0,vert[3]=0,vert[4]=0,vert[5]=currentFillColor,vert[6]=currentStrokeColor,vertArray.push(vert),moveTo&&(vertArray[vertArray.length-1].moveTo=moveTo)},Drawing3D.prototype.vertex=function(x,y,z,u,v){var vert=[];firstVert&&(firstVert=!1),vert.isVert=!0,v===undef&&usingTexture&&(v=u,u=z,z=0),u!==undef&&v!==undef&&(curTextureMode===PConstants.IMAGE&&(u/=curTexture.width,v/=curTexture.height),u=u>1?1:u,u=0>u?0:u,v=v>1?1:v,v=0>v?0:v),vert[0]=x,vert[1]=y,vert[2]=z||0,vert[3]=u||0,vert[4]=v||0,vert[5]=fillStyle[0],vert[6]=fillStyle[1],vert[7]=fillStyle[2],vert[8]=fillStyle[3],vert[9]=strokeStyle[0],vert[10]=strokeStyle[1],vert[11]=strokeStyle[2],vert[12]=strokeStyle[3],vert[13]=normalX,vert[14]=normalY,vert[15]=normalZ,vertArray.push(vert)};var point3D=function(vArray,cArray){var view=new PMatrix3D;view.scale(1,-1,1),view.apply(modelView.array()),view.transpose(),curContext.useProgram(programObjectUnlitShape),uniformMatrix("uViewUS",programObjectUnlitShape,"uView",!1,view.array()),uniformi("uSmoothUS",programObjectUnlitShape,"uSmooth",renderSmooth),vertexAttribPointer("aVertexUS",programObjectUnlitShape,"aVertex",3,pointBuffer),curContext.bufferData(curContext.ARRAY_BUFFER,new Float32Array(vArray),curContext.STREAM_DRAW),vertexAttribPointer("aColorUS",programObjectUnlitShape,"aColor",4,fillColorBuffer),curContext.bufferData(curContext.ARRAY_BUFFER,new Float32Array(cArray),curContext.STREAM_DRAW),curContext.drawArrays(curContext.POINTS,0,vArray.length/3)},line3D=function(vArray,mode,cArray){var ctxMode;ctxMode="LINES"===mode?curContext.LINES:"LINE_LOOP"===mode?curContext.LINE_LOOP:curContext.LINE_STRIP;var view=new PMatrix3D;view.scale(1,-1,1),view.apply(modelView.array()),view.transpose(),curContext.useProgram(programObjectUnlitShape),uniformMatrix("uViewUS",programObjectUnlitShape,"uView",!1,view.array()),vertexAttribPointer("aVertexUS",programObjectUnlitShape,"aVertex",3,lineBuffer),curContext.bufferData(curContext.ARRAY_BUFFER,new Float32Array(vArray),curContext.STREAM_DRAW),vertexAttribPointer("aColorUS",programObjectUnlitShape,"aColor",4,strokeColorBuffer),curContext.bufferData(curContext.ARRAY_BUFFER,new Float32Array(cArray),curContext.STREAM_DRAW),curContext.drawArrays(ctxMode,0,vArray.length/3)},fill3D=function(vArray,mode,cArray,tArray){var ctxMode;ctxMode="TRIANGLES"===mode?curContext.TRIANGLES:"TRIANGLE_FAN"===mode?curContext.TRIANGLE_FAN:curContext.TRIANGLE_STRIP;var view=new PMatrix3D;view.scale(1,-1,1),view.apply(modelView.array()),view.transpose(),curContext.useProgram(programObject3D),uniformMatrix("model3d",programObject3D,"uModel",!1,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),uniformMatrix("view3d",programObject3D,"uView",!1,view.array()),curContext.enable(curContext.POLYGON_OFFSET_FILL),curContext.polygonOffset(1,1),uniformf("color3d",programObject3D,"uColor",[-1,0,0,0]),vertexAttribPointer("vertex3d",programObject3D,"aVertex",3,fillBuffer),curContext.bufferData(curContext.ARRAY_BUFFER,new Float32Array(vArray),curContext.STREAM_DRAW),usingTexture&&null!==curTint&&curTint3d(cArray),vertexAttribPointer("aColor3d",programObject3D,"aColor",4,fillColorBuffer),curContext.bufferData(curContext.ARRAY_BUFFER,new Float32Array(cArray),curContext.STREAM_DRAW),disableVertexAttribPointer("aNormal3d",programObject3D,"aNormal"),usingTexture&&(uniformi("uUsingTexture3d",programObject3D,"uUsingTexture",usingTexture),vertexAttribPointer("aTexture3d",programObject3D,"aTexture",2,shapeTexVBO),curContext.bufferData(curContext.ARRAY_BUFFER,new Float32Array(tArray),curContext.STREAM_DRAW)),curContext.drawArrays(ctxMode,0,vArray.length/3),curContext.disable(curContext.POLYGON_OFFSET_FILL)};Drawing2D.prototype.endShape=function(mode){if(0!==vertArray.length){var closeShape=mode===PConstants.CLOSE;closeShape&&vertArray.push(vertArray[0]);var cachedVertArray,fillVertArray=[],colorVertArray=[],strokeVertArray=[],texVertArray=[];firstVert=!0;var i,j,vertArrayLength=vertArray.length;for(i=0;vertArrayLength>i;i++)for(cachedVertArray=vertArray[i],j=0;3>j;j++)fillVertArray.push(cachedVertArray[j]);for(i=0;vertArrayLength>i;i++)for(cachedVertArray=vertArray[i],j=5;9>j;j++)colorVertArray.push(cachedVertArray[j]);for(i=0;vertArrayLength>i;i++)for(cachedVertArray=vertArray[i],j=9;13>j;j++)strokeVertArray.push(cachedVertArray[j]);for(i=0;vertArrayLength>i;i++)cachedVertArray=vertArray[i],texVertArray.push(cachedVertArray[3]),texVertArray.push(cachedVertArray[4]);if(!isCurve||curShape!==PConstants.POLYGON&&curShape!==undef)if(!isBezier||curShape!==PConstants.POLYGON&&curShape!==undef)if(curShape===PConstants.POINTS)for(i=0;vertArrayLength>i;i++)cachedVertArray=vertArray[i],doStroke&&p.stroke(cachedVertArray[6]),p.point(cachedVertArray[0],cachedVertArray[1]);else if(curShape===PConstants.LINES)for(i=0;vertArrayLength>i+1;i+=2)cachedVertArray=vertArray[i],doStroke&&p.stroke(vertArray[i+1][6]),p.line(cachedVertArray[0],cachedVertArray[1],vertArray[i+1][0],vertArray[i+1][1]);else if(curShape===PConstants.TRIANGLES)for(i=0;vertArrayLength>i+2;i+=3)cachedVertArray=vertArray[i],curContext.beginPath(),curContext.moveTo(cachedVertArray[0],cachedVertArray[1]),curContext.lineTo(vertArray[i+1][0],vertArray[i+1][1]),curContext.lineTo(vertArray[i+2][0],vertArray[i+2][1]),curContext.lineTo(cachedVertArray[0],cachedVertArray[1]),doFill&&(p.fill(vertArray[i+2][5]),executeContextFill()),doStroke&&(p.stroke(vertArray[i+2][6]),executeContextStroke()),curContext.closePath();else if(curShape===PConstants.TRIANGLE_STRIP)for(i=0;vertArrayLength>i+1;i++)cachedVertArray=vertArray[i],curContext.beginPath(),curContext.moveTo(vertArray[i+1][0],vertArray[i+1][1]),curContext.lineTo(cachedVertArray[0],cachedVertArray[1]),doStroke&&p.stroke(vertArray[i+1][6]),doFill&&p.fill(vertArray[i+1][5]),vertArrayLength>i+2&&(curContext.lineTo(vertArray[i+2][0],vertArray[i+2][1]),doStroke&&p.stroke(vertArray[i+2][6]),doFill&&p.fill(vertArray[i+2][5])),fillStrokeClose();else if(curShape===PConstants.TRIANGLE_FAN){if(vertArrayLength>2)for(curContext.beginPath(),curContext.moveTo(vertArray[0][0],vertArray[0][1]),curContext.lineTo(vertArray[1][0],vertArray[1][1]),curContext.lineTo(vertArray[2][0],vertArray[2][1]),doFill&&(p.fill(vertArray[2][5]),executeContextFill()),doStroke&&(p.stroke(vertArray[2][6]),executeContextStroke()),curContext.closePath(),i=3;vertArrayLength>i;i++)cachedVertArray=vertArray[i],curContext.beginPath(),curContext.moveTo(vertArray[0][0],vertArray[0][1]),curContext.lineTo(vertArray[i-1][0],vertArray[i-1][1]),curContext.lineTo(cachedVertArray[0],cachedVertArray[1]),doFill&&(p.fill(cachedVertArray[5]),executeContextFill()),doStroke&&(p.stroke(cachedVertArray[6]),executeContextStroke()),curContext.closePath()}else if(curShape===PConstants.QUADS)for(i=0;vertArrayLength>i+3;i+=4){for(cachedVertArray=vertArray[i],curContext.beginPath(),curContext.moveTo(cachedVertArray[0],cachedVertArray[1]),j=1;4>j;j++)curContext.lineTo(vertArray[i+j][0],vertArray[i+j][1]);curContext.lineTo(cachedVertArray[0],cachedVertArray[1]),doFill&&(p.fill(vertArray[i+3][5]),executeContextFill()),doStroke&&(p.stroke(vertArray[i+3][6]),executeContextStroke()),curContext.closePath()}else if(curShape===PConstants.QUAD_STRIP){if(vertArrayLength>3)for(i=0;vertArrayLength>i+1;i+=2)cachedVertArray=vertArray[i],curContext.beginPath(),vertArrayLength>i+3?(curContext.moveTo(vertArray[i+2][0],vertArray[i+2][1]),curContext.lineTo(cachedVertArray[0],cachedVertArray[1]),curContext.lineTo(vertArray[i+1][0],vertArray[i+1][1]),curContext.lineTo(vertArray[i+3][0],vertArray[i+3][1]),doFill&&p.fill(vertArray[i+3][5]),doStroke&&p.stroke(vertArray[i+3][6])):(curContext.moveTo(cachedVertArray[0],cachedVertArray[1]),curContext.lineTo(vertArray[i+1][0],vertArray[i+1][1])),fillStrokeClose()}else{for(curContext.beginPath(),curContext.moveTo(vertArray[0][0],vertArray[0][1]),i=1;vertArrayLength>i;i++)cachedVertArray=vertArray[i],cachedVertArray.isVert&&(cachedVertArray.moveTo?curContext.moveTo(cachedVertArray[0],cachedVertArray[1]):curContext.lineTo(cachedVertArray[0],cachedVertArray[1]));fillStrokeClose()}else{for(curContext.beginPath(),i=0;vertArrayLength>i;i++)cachedVertArray=vertArray[i],vertArray[i].isVert?vertArray[i].moveTo?curContext.moveTo(cachedVertArray[0],cachedVertArray[1]):curContext.lineTo(cachedVertArray[0],cachedVertArray[1]):curContext.bezierCurveTo(vertArray[i][0],vertArray[i][1],vertArray[i][2],vertArray[i][3],vertArray[i][4],vertArray[i][5]);fillStrokeClose()}else if(vertArrayLength>3){var b=[],s=1-curTightness;for(curContext.beginPath(),curContext.moveTo(vertArray[1][0],vertArray[1][1]),i=1;vertArrayLength>i+2;i++)cachedVertArray=vertArray[i],b[0]=[cachedVertArray[0],cachedVertArray[1]],b[1]=[cachedVertArray[0]+(s*vertArray[i+1][0]-s*vertArray[i-1][0])/6,cachedVertArray[1]+(s*vertArray[i+1][1]-s*vertArray[i-1][1])/6],b[2]=[vertArray[i+1][0]+(s*vertArray[i][0]-s*vertArray[i+2][0])/6,vertArray[i+1][1]+(s*vertArray[i][1]-s*vertArray[i+2][1])/6],b[3]=[vertArray[i+1][0],vertArray[i+1][1]],curContext.bezierCurveTo(b[1][0],b[1][1],b[2][0],b[2][1],b[3][0],b[3][1]);fillStrokeClose()}isCurve=!1,isBezier=!1,curveVertArray=[],curveVertCount=0,closeShape&&vertArray.pop()}},Drawing3D.prototype.endShape=function(mode){if(0!==vertArray.length){var cachedVertArray,closeShape=mode===PConstants.CLOSE,lineVertArray=[],fillVertArray=[],colorVertArray=[],strokeVertArray=[],texVertArray=[];firstVert=!0;var i,j,k,vertArrayLength=vertArray.length;for(i=0;vertArrayLength>i;i++)for(cachedVertArray=vertArray[i],j=0;3>j;j++)fillVertArray.push(cachedVertArray[j]);for(i=0;vertArrayLength>i;i++)for(cachedVertArray=vertArray[i],j=5;9>j;j++)colorVertArray.push(cachedVertArray[j]);for(i=0;vertArrayLength>i;i++)for(cachedVertArray=vertArray[i],j=9;13>j;j++)strokeVertArray.push(cachedVertArray[j]);for(i=0;vertArrayLength>i;i++)cachedVertArray=vertArray[i],texVertArray.push(cachedVertArray[3]),texVertArray.push(cachedVertArray[4]);if(closeShape){for(fillVertArray.push(vertArray[0][0]),fillVertArray.push(vertArray[0][1]),fillVertArray.push(vertArray[0][2]),i=5;9>i;i++)colorVertArray.push(vertArray[0][i]);for(i=9;13>i;i++)strokeVertArray.push(vertArray[0][i]);texVertArray.push(vertArray[0][3]),texVertArray.push(vertArray[0][4])}if(!isCurve||curShape!==PConstants.POLYGON&&curShape!==undef)if(!isBezier||curShape!==PConstants.POLYGON&&curShape!==undef){if(curShape===PConstants.POINTS){for(i=0;vertArrayLength>i;i++)for(cachedVertArray=vertArray[i],j=0;3>j;j++)lineVertArray.push(cachedVertArray[j]);
point3D(lineVertArray,strokeVertArray)}else if(curShape===PConstants.LINES){for(i=0;vertArrayLength>i;i++)for(cachedVertArray=vertArray[i],j=0;3>j;j++)lineVertArray.push(cachedVertArray[j]);for(i=0;vertArrayLength>i;i++)for(cachedVertArray=vertArray[i],j=5;9>j;j++)colorVertArray.push(cachedVertArray[j]);line3D(lineVertArray,"LINES",strokeVertArray)}else if(curShape===PConstants.TRIANGLES){if(vertArrayLength>2)for(i=0;vertArrayLength>i+2;i+=3){for(fillVertArray=[],texVertArray=[],lineVertArray=[],colorVertArray=[],strokeVertArray=[],j=0;3>j;j++)for(k=0;3>k;k++)lineVertArray.push(vertArray[i+j][k]),fillVertArray.push(vertArray[i+j][k]);for(j=0;3>j;j++)for(k=3;5>k;k++)texVertArray.push(vertArray[i+j][k]);for(j=0;3>j;j++)for(k=5;9>k;k++)colorVertArray.push(vertArray[i+j][k]),strokeVertArray.push(vertArray[i+j][k+4]);doStroke&&line3D(lineVertArray,"LINE_LOOP",strokeVertArray),(doFill||usingTexture)&&fill3D(fillVertArray,"TRIANGLES",colorVertArray,texVertArray)}}else if(curShape===PConstants.TRIANGLE_STRIP){if(vertArrayLength>2)for(i=0;vertArrayLength>i+2;i++){for(lineVertArray=[],fillVertArray=[],strokeVertArray=[],colorVertArray=[],texVertArray=[],j=0;3>j;j++)for(k=0;3>k;k++)lineVertArray.push(vertArray[i+j][k]),fillVertArray.push(vertArray[i+j][k]);for(j=0;3>j;j++)for(k=3;5>k;k++)texVertArray.push(vertArray[i+j][k]);for(j=0;3>j;j++)for(k=5;9>k;k++)strokeVertArray.push(vertArray[i+j][k+4]),colorVertArray.push(vertArray[i+j][k]);(doFill||usingTexture)&&fill3D(fillVertArray,"TRIANGLE_STRIP",colorVertArray,texVertArray),doStroke&&line3D(lineVertArray,"LINE_LOOP",strokeVertArray)}}else if(curShape===PConstants.TRIANGLE_FAN){if(vertArrayLength>2){for(i=0;3>i;i++)for(cachedVertArray=vertArray[i],j=0;3>j;j++)lineVertArray.push(cachedVertArray[j]);for(i=0;3>i;i++)for(cachedVertArray=vertArray[i],j=9;13>j;j++)strokeVertArray.push(cachedVertArray[j]);for(doStroke&&line3D(lineVertArray,"LINE_LOOP",strokeVertArray),i=2;vertArrayLength>i+1;i++){for(lineVertArray=[],strokeVertArray=[],lineVertArray.push(vertArray[0][0]),lineVertArray.push(vertArray[0][1]),lineVertArray.push(vertArray[0][2]),strokeVertArray.push(vertArray[0][9]),strokeVertArray.push(vertArray[0][10]),strokeVertArray.push(vertArray[0][11]),strokeVertArray.push(vertArray[0][12]),j=0;2>j;j++)for(k=0;3>k;k++)lineVertArray.push(vertArray[i+j][k]);for(j=0;2>j;j++)for(k=9;13>k;k++)strokeVertArray.push(vertArray[i+j][k]);doStroke&&line3D(lineVertArray,"LINE_STRIP",strokeVertArray)}(doFill||usingTexture)&&fill3D(fillVertArray,"TRIANGLE_FAN",colorVertArray,texVertArray)}}else if(curShape===PConstants.QUADS)for(i=0;vertArrayLength>i+3;i+=4){for(lineVertArray=[],j=0;4>j;j++)for(cachedVertArray=vertArray[i+j],k=0;3>k;k++)lineVertArray.push(cachedVertArray[k]);if(doStroke&&line3D(lineVertArray,"LINE_LOOP",strokeVertArray),doFill){for(fillVertArray=[],colorVertArray=[],texVertArray=[],j=0;3>j;j++)fillVertArray.push(vertArray[i][j]);for(j=5;9>j;j++)colorVertArray.push(vertArray[i][j]);for(j=0;3>j;j++)fillVertArray.push(vertArray[i+1][j]);for(j=5;9>j;j++)colorVertArray.push(vertArray[i+1][j]);for(j=0;3>j;j++)fillVertArray.push(vertArray[i+3][j]);for(j=5;9>j;j++)colorVertArray.push(vertArray[i+3][j]);for(j=0;3>j;j++)fillVertArray.push(vertArray[i+2][j]);for(j=5;9>j;j++)colorVertArray.push(vertArray[i+2][j]);usingTexture&&(texVertArray.push(vertArray[i+0][3]),texVertArray.push(vertArray[i+0][4]),texVertArray.push(vertArray[i+1][3]),texVertArray.push(vertArray[i+1][4]),texVertArray.push(vertArray[i+3][3]),texVertArray.push(vertArray[i+3][4]),texVertArray.push(vertArray[i+2][3]),texVertArray.push(vertArray[i+2][4])),fill3D(fillVertArray,"TRIANGLE_STRIP",colorVertArray,texVertArray)}}else if(curShape===PConstants.QUAD_STRIP){var tempArray=[];if(vertArrayLength>3){for(i=0;2>i;i++)for(cachedVertArray=vertArray[i],j=0;3>j;j++)lineVertArray.push(cachedVertArray[j]);for(i=0;2>i;i++)for(cachedVertArray=vertArray[i],j=9;13>j;j++)strokeVertArray.push(cachedVertArray[j]);for(line3D(lineVertArray,"LINE_STRIP",strokeVertArray),vertArrayLength>4&&vertArrayLength%2>0&&(tempArray=fillVertArray.splice(fillVertArray.length-3),vertArray.pop()),i=0;vertArrayLength>i+3;i+=2){for(lineVertArray=[],strokeVertArray=[],j=0;3>j;j++)lineVertArray.push(vertArray[i+1][j]);for(j=0;3>j;j++)lineVertArray.push(vertArray[i+3][j]);for(j=0;3>j;j++)lineVertArray.push(vertArray[i+2][j]);for(j=0;3>j;j++)lineVertArray.push(vertArray[i+0][j]);for(j=9;13>j;j++)strokeVertArray.push(vertArray[i+1][j]);for(j=9;13>j;j++)strokeVertArray.push(vertArray[i+3][j]);for(j=9;13>j;j++)strokeVertArray.push(vertArray[i+2][j]);for(j=9;13>j;j++)strokeVertArray.push(vertArray[i+0][j]);doStroke&&line3D(lineVertArray,"LINE_STRIP",strokeVertArray)}(doFill||usingTexture)&&fill3D(fillVertArray,"TRIANGLE_LIST",colorVertArray,texVertArray)}}else if(1===vertArrayLength){for(j=0;3>j;j++)lineVertArray.push(vertArray[0][j]);for(j=9;13>j;j++)strokeVertArray.push(vertArray[0][j]);point3D(lineVertArray,strokeVertArray)}else{for(i=0;vertArrayLength>i;i++){for(cachedVertArray=vertArray[i],j=0;3>j;j++)lineVertArray.push(cachedVertArray[j]);for(j=5;9>j;j++)strokeVertArray.push(cachedVertArray[j])}doStroke&&closeShape?line3D(lineVertArray,"LINE_LOOP",strokeVertArray):doStroke&&!closeShape&&line3D(lineVertArray,"LINE_STRIP",strokeVertArray),(doFill||usingTexture)&&fill3D(fillVertArray,"TRIANGLE_FAN",colorVertArray,texVertArray)}usingTexture=!1,curContext.useProgram(programObject3D),uniformi("usingTexture3d",programObject3D,"uUsingTexture",usingTexture)}else lineVertArray=fillVertArray,lineVertArray.splice(lineVertArray.length-3),strokeVertArray.splice(strokeVertArray.length-4),doStroke&&line3D(lineVertArray,null,strokeVertArray),doFill&&fill3D(fillVertArray,"TRIANGLES",colorVertArray);else lineVertArray=fillVertArray,doStroke&&line3D(lineVertArray,null,strokeVertArray),doFill&&fill3D(fillVertArray,null,colorVertArray);isCurve=!1,isBezier=!1,curveVertArray=[],curveVertCount=0}};var splineForward=function(segments,matrix){var f=1/segments,ff=f*f,fff=ff*f;matrix.set(0,0,0,1,fff,ff,f,0,6*fff,2*ff,0,0,6*fff,0,0,0)},curveInit=function(){curveDrawMatrix||(curveBasisMatrix=new PMatrix3D,curveDrawMatrix=new PMatrix3D,curveInited=!0);var s=curTightness;curveBasisMatrix.set((s-1)/2,(s+3)/2,(-3-s)/2,(1-s)/2,1-s,(-5-s)/2,s+2,(s-1)/2,(s-1)/2,0,(1-s)/2,0,0,1,0,0),splineForward(curveDet,curveDrawMatrix),bezierBasisInverse||(curveToBezierMatrix=new PMatrix3D),curveToBezierMatrix.set(curveBasisMatrix),curveToBezierMatrix.preApply(bezierBasisInverse),curveDrawMatrix.apply(curveBasisMatrix)};Drawing2D.prototype.bezierVertex=function(){isBezier=!0;var vert=[];if(firstVert)throw"vertex() must be used at least once before calling bezierVertex()";for(var i=0;i<arguments.length;i++)vert[i]=arguments[i];vertArray.push(vert),vertArray[vertArray.length-1].isVert=!1},Drawing3D.prototype.bezierVertex=function(){isBezier=!0;if(firstVert)throw"vertex() must be used at least once before calling bezierVertex()";if(9===arguments.length){bezierDrawMatrix===undef&&(bezierDrawMatrix=new PMatrix3D);var lastPoint=vertArray.length-1;splineForward(bezDetail,bezierDrawMatrix),bezierDrawMatrix.apply(bezierBasisMatrix);for(var draw=bezierDrawMatrix.array(),x1=vertArray[lastPoint][0],y1=vertArray[lastPoint][1],z1=vertArray[lastPoint][2],xplot1=draw[4]*x1+draw[5]*arguments[0]+draw[6]*arguments[3]+draw[7]*arguments[6],xplot2=draw[8]*x1+draw[9]*arguments[0]+draw[10]*arguments[3]+draw[11]*arguments[6],xplot3=draw[12]*x1+draw[13]*arguments[0]+draw[14]*arguments[3]+draw[15]*arguments[6],yplot1=draw[4]*y1+draw[5]*arguments[1]+draw[6]*arguments[4]+draw[7]*arguments[7],yplot2=draw[8]*y1+draw[9]*arguments[1]+draw[10]*arguments[4]+draw[11]*arguments[7],yplot3=draw[12]*y1+draw[13]*arguments[1]+draw[14]*arguments[4]+draw[15]*arguments[7],zplot1=draw[4]*z1+draw[5]*arguments[2]+draw[6]*arguments[5]+draw[7]*arguments[8],zplot2=draw[8]*z1+draw[9]*arguments[2]+draw[10]*arguments[5]+draw[11]*arguments[8],zplot3=draw[12]*z1+draw[13]*arguments[2]+draw[14]*arguments[5]+draw[15]*arguments[8],j=0;bezDetail>j;j++)x1+=xplot1,xplot1+=xplot2,xplot2+=xplot3,y1+=yplot1,yplot1+=yplot2,yplot2+=yplot3,z1+=zplot1,zplot1+=zplot2,zplot2+=zplot3,p.vertex(x1,y1,z1);p.vertex(arguments[6],arguments[7],arguments[8])}},p.texture=function(pimage){var curContext=drawing.$ensureContext();if(pimage.__texture)curContext.bindTexture(curContext.TEXTURE_2D,pimage.__texture);else if("canvas"===pimage.localName)curContext.bindTexture(curContext.TEXTURE_2D,canTex),curContext.texImage2D(curContext.TEXTURE_2D,0,curContext.RGBA,curContext.RGBA,curContext.UNSIGNED_BYTE,pimage),curContext.texParameteri(curContext.TEXTURE_2D,curContext.TEXTURE_MAG_FILTER,curContext.LINEAR),curContext.texParameteri(curContext.TEXTURE_2D,curContext.TEXTURE_MIN_FILTER,curContext.LINEAR),curContext.generateMipmap(curContext.TEXTURE_2D),curTexture.width=pimage.width,curTexture.height=pimage.height;else{var pot,texture=curContext.createTexture(),cvs=document.createElement("canvas"),cvsTextureCtx=cvs.getContext("2d");if(pimage.width&pimage.width-1===0)cvs.width=pimage.width;else{for(pot=1;pot<pimage.width;)pot*=2;cvs.width=pot}if(pimage.height&pimage.height-1===0)cvs.height=pimage.height;else{for(pot=1;pot<pimage.height;)pot*=2;cvs.height=pot}cvsTextureCtx.drawImage(pimage.sourceImg,0,0,pimage.width,pimage.height,0,0,cvs.width,cvs.height),curContext.bindTexture(curContext.TEXTURE_2D,texture),curContext.texParameteri(curContext.TEXTURE_2D,curContext.TEXTURE_MIN_FILTER,curContext.LINEAR_MIPMAP_LINEAR),curContext.texParameteri(curContext.TEXTURE_2D,curContext.TEXTURE_MAG_FILTER,curContext.LINEAR),curContext.texParameteri(curContext.TEXTURE_2D,curContext.TEXTURE_WRAP_T,curContext.CLAMP_TO_EDGE),curContext.texParameteri(curContext.TEXTURE_2D,curContext.TEXTURE_WRAP_S,curContext.CLAMP_TO_EDGE),curContext.texImage2D(curContext.TEXTURE_2D,0,curContext.RGBA,curContext.RGBA,curContext.UNSIGNED_BYTE,cvs),curContext.generateMipmap(curContext.TEXTURE_2D),pimage.__texture=texture,curTexture.width=pimage.width,curTexture.height=pimage.height}usingTexture=!0,curContext.useProgram(programObject3D),uniformi("usingTexture3d",programObject3D,"uUsingTexture",usingTexture)},p.textureMode=function(mode){curTextureMode=mode};var curveVertexSegment=function(x1,y1,z1,x2,y2,z2,x3,y3,z3,x4,y4,z4){var x0=x2,y0=y2,z0=z2,draw=curveDrawMatrix.array(),xplot1=draw[4]*x1+draw[5]*x2+draw[6]*x3+draw[7]*x4,xplot2=draw[8]*x1+draw[9]*x2+draw[10]*x3+draw[11]*x4,xplot3=draw[12]*x1+draw[13]*x2+draw[14]*x3+draw[15]*x4,yplot1=draw[4]*y1+draw[5]*y2+draw[6]*y3+draw[7]*y4,yplot2=draw[8]*y1+draw[9]*y2+draw[10]*y3+draw[11]*y4,yplot3=draw[12]*y1+draw[13]*y2+draw[14]*y3+draw[15]*y4,zplot1=draw[4]*z1+draw[5]*z2+draw[6]*z3+draw[7]*z4,zplot2=draw[8]*z1+draw[9]*z2+draw[10]*z3+draw[11]*z4,zplot3=draw[12]*z1+draw[13]*z2+draw[14]*z3+draw[15]*z4;p.vertex(x0,y0,z0);for(var j=0;curveDet>j;j++)x0+=xplot1,xplot1+=xplot2,xplot2+=xplot3,y0+=yplot1,yplot1+=yplot2,yplot2+=yplot3,z0+=zplot1,zplot1+=zplot2,zplot2+=zplot3,p.vertex(x0,y0,z0)};Drawing2D.prototype.curveVertex=function(x,y){isCurve=!0,p.vertex(x,y)},Drawing3D.prototype.curveVertex=function(x,y,z){isCurve=!0,curveInited||curveInit();var vert=[];vert[0]=x,vert[1]=y,vert[2]=z,curveVertArray.push(vert),curveVertCount++,curveVertCount>3&&curveVertexSegment(curveVertArray[curveVertCount-4][0],curveVertArray[curveVertCount-4][1],curveVertArray[curveVertCount-4][2],curveVertArray[curveVertCount-3][0],curveVertArray[curveVertCount-3][1],curveVertArray[curveVertCount-3][2],curveVertArray[curveVertCount-2][0],curveVertArray[curveVertCount-2][1],curveVertArray[curveVertCount-2][2],curveVertArray[curveVertCount-1][0],curveVertArray[curveVertCount-1][1],curveVertArray[curveVertCount-1][2])},Drawing2D.prototype.curve=function(x1,y1,x2,y2,x3,y3,x4,y4){p.beginShape(),p.curveVertex(x1,y1),p.curveVertex(x2,y2),p.curveVertex(x3,y3),p.curveVertex(x4,y4),p.endShape()},Drawing3D.prototype.curve=function(x1,y1,z1,x2,y2,z2,x3,y3,z3,x4,y4,z4){return z4!==undef?(p.beginShape(),p.curveVertex(x1,y1,z1),p.curveVertex(x2,y2,z2),p.curveVertex(x3,y3,z3),p.curveVertex(x4,y4,z4),void p.endShape()):(p.beginShape(),p.curveVertex(x1,y1),p.curveVertex(z1,x2),p.curveVertex(y2,z2),p.curveVertex(x3,y3),void p.endShape())},p.curveTightness=function(tightness){curTightness=tightness},p.curveDetail=function(detail){curveDet=detail,curveInit()},p.rectMode=function(aRectMode){curRectMode=aRectMode},p.imageMode=function(mode){switch(mode){case PConstants.CORNER:imageModeConvert=imageModeCorner;break;case PConstants.CORNERS:imageModeConvert=imageModeCorners;break;case PConstants.CENTER:imageModeConvert=imageModeCenter;break;default:throw"Invalid imageMode"}},p.ellipseMode=function(aEllipseMode){curEllipseMode=aEllipseMode},p.arc=function(x,y,width,height,start,stop){if(!(0>=width||start>stop)){for(curEllipseMode===PConstants.CORNERS?(width-=x,height-=y):curEllipseMode===PConstants.RADIUS?(x-=width,y-=height,width=2*width,height=2*height):curEllipseMode===PConstants.CENTER&&(x-=width/2,y-=height/2);0>start;)start+=PConstants.TWO_PI,stop+=PConstants.TWO_PI;stop-start>PConstants.TWO_PI&&(start=0,stop=PConstants.TWO_PI);var i,j,hr=width/2,vr=height/2,centerX=x+hr,centerY=y+vr,startLUT=0|.5+start*p.RAD_TO_DEG*2,stopLUT=0|.5+stop*p.RAD_TO_DEG*2;if(doFill){var savedStroke=doStroke;for(doStroke=!1,p.beginShape(),p.vertex(centerX,centerY),i=startLUT;stopLUT>=i;i++)j=i%PConstants.SINCOS_LENGTH,p.vertex(centerX+cosLUT[j]*hr,centerY+sinLUT[j]*vr);p.endShape(PConstants.CLOSE),doStroke=savedStroke}if(doStroke){var savedFill=doFill;for(doFill=!1,p.beginShape(),i=startLUT;stopLUT>=i;i++)j=i%PConstants.SINCOS_LENGTH,p.vertex(centerX+cosLUT[j]*hr,centerY+sinLUT[j]*vr);p.endShape(),doFill=savedFill}}},Drawing2D.prototype.line=function(x1,y1,x2,y2){if(doStroke){if(x1=Math.round(x1),x2=Math.round(x2),y1=Math.round(y1),y2=Math.round(y2),x1===x2&&y1===y2)return void p.point(x1,y1);for(var swap=undef,lineCap=undef,drawCrisp=!0,currentModelView=modelView.array(),identityMatrix=[1,0,0,0,1,0],i=0;6>i&&drawCrisp;i++)drawCrisp=currentModelView[i]===identityMatrix[i];drawCrisp&&(x1===x2?(y1>y2&&(swap=y1,y1=y2,y2=swap),y2++,lineWidth%2===1&&curContext.translate(.5,0)):y1===y2&&(x1>x2&&(swap=x1,x1=x2,x2=swap),x2++,lineWidth%2===1&&curContext.translate(0,.5)),1===lineWidth&&(lineCap=curContext.lineCap,curContext.lineCap="butt")),curContext.beginPath(),curContext.moveTo(x1||0,y1||0),curContext.lineTo(x2||0,y2||0),executeContextStroke(),drawCrisp&&(x1===x2&&lineWidth%2===1?curContext.translate(-.5,0):y1===y2&&lineWidth%2===1&&curContext.translate(0,-.5),1===lineWidth&&(curContext.lineCap=lineCap))}},Drawing3D.prototype.line=function(x1,y1,z1,x2,y2,z2){if((y2===undef||z2===undef)&&(z2=0,y2=x2,x2=z1,z1=0),x1===x2&&y1===y2&&z1===z2)return void p.point(x1,y1,z1);var lineVerts=[x1,y1,z1,x2,y2,z2],view=new PMatrix3D;view.scale(1,-1,1),view.apply(modelView.array()),view.transpose(),lineWidth>0&&doStroke&&(curContext.useProgram(programObject2D),uniformMatrix("uModel2d",programObject2D,"uModel",!1,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),uniformMatrix("uView2d",programObject2D,"uView",!1,view.array()),uniformf("uColor2d",programObject2D,"uColor",strokeStyle),uniformi("uIsDrawingText",programObject2D,"uIsDrawingText",!1),vertexAttribPointer("aVertex2d",programObject2D,"aVertex",3,lineBuffer),disableVertexAttribPointer("aTextureCoord2d",programObject2D,"aTextureCoord"),curContext.bufferData(curContext.ARRAY_BUFFER,new Float32Array(lineVerts),curContext.STREAM_DRAW),curContext.drawArrays(curContext.LINES,0,2))},Drawing2D.prototype.bezier=function(){if(8!==arguments.length)throw"You must use 8 parameters for bezier() in 2D mode";p.beginShape(),p.vertex(arguments[0],arguments[1]),p.bezierVertex(arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7]),p.endShape()},Drawing3D.prototype.bezier=function(){if(12!==arguments.length)throw"You must use 12 parameters for bezier() in 3D mode";p.beginShape(),p.vertex(arguments[0],arguments[1],arguments[2]),p.bezierVertex(arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8],arguments[9],arguments[10],arguments[11]),p.endShape()},p.bezierDetail=function(detail){bezDetail=detail},p.bezierPoint=function(a,b,c,d,t){return(1-t)*(1-t)*(1-t)*a+3*(1-t)*(1-t)*t*b+3*(1-t)*t*t*c+t*t*t*d},p.bezierTangent=function(a,b,c,d,t){return 3*t*t*(-a+3*b-3*c+d)+6*t*(a-2*b+c)+3*(-a+b)},p.curvePoint=function(a,b,c,d,t){return.5*(2*b+(-a+c)*t+(2*a-5*b+4*c-d)*t*t+(-a+3*b-3*c+d)*t*t*t)},p.curveTangent=function(a,b,c,d,t){return.5*(-a+c+2*(2*a-5*b+4*c-d)*t+3*(-a+3*b-3*c+d)*t*t)},p.triangle=function(x1,y1,x2,y2,x3,y3){p.beginShape(PConstants.TRIANGLES),p.vertex(x1,y1,0),p.vertex(x2,y2,0),p.vertex(x3,y3,0),p.endShape()},p.quad=function(x1,y1,x2,y2,x3,y3,x4,y4){p.beginShape(PConstants.QUADS),p.vertex(x1,y1,0),p.vertex(x2,y2,0),p.vertex(x3,y3,0),p.vertex(x4,y4,0),p.endShape()};var roundedRect$2d=function(x,y,width,height,tl,tr,br,bl){bl===undef&&(tr=tl,br=tl,bl=tl);var halfWidth=width/2,halfHeight=height/2;(tl>halfWidth||tl>halfHeight)&&(tl=Math.min(halfWidth,halfHeight)),(tr>halfWidth||tr>halfHeight)&&(tr=Math.min(halfWidth,halfHeight)),(br>halfWidth||br>halfHeight)&&(br=Math.min(halfWidth,halfHeight)),(bl>halfWidth||bl>halfHeight)&&(bl=Math.min(halfWidth,halfHeight)),(!doFill||doStroke)&&curContext.translate(.5,.5),curContext.beginPath(),curContext.moveTo(x+tl,y),curContext.lineTo(x+width-tr,y),curContext.quadraticCurveTo(x+width,y,x+width,y+tr),curContext.lineTo(x+width,y+height-br),curContext.quadraticCurveTo(x+width,y+height,x+width-br,y+height),curContext.lineTo(x+bl,y+height),curContext.quadraticCurveTo(x,y+height,x,y+height-bl),curContext.lineTo(x,y+tl),curContext.quadraticCurveTo(x,y,x+tl,y),(!doFill||doStroke)&&curContext.translate(-.5,-.5),executeContextFill(),executeContextStroke()};Drawing2D.prototype.rect=function(x,y,width,height,tl,tr,br,bl){if(width||height){if(curRectMode===PConstants.CORNERS?(width-=x,height-=y):curRectMode===PConstants.RADIUS?(width*=2,height*=2,x-=width/2,y-=height/2):curRectMode===PConstants.CENTER&&(x-=width/2,y-=height/2),x=Math.round(x),y=Math.round(y),width=Math.round(width),height=Math.round(height),tl!==undef)return void roundedRect$2d(x,y,width,height,tl,tr,br,bl);doStroke&&lineWidth%2===1&&curContext.translate(.5,.5),curContext.beginPath(),curContext.rect(x,y,width,height),executeContextFill(),executeContextStroke(),doStroke&&lineWidth%2===1&&curContext.translate(-.5,-.5)}},Drawing3D.prototype.rect=function(x,y,width,height,tl){if(tl!==undef)throw"rect() with rounded corners is not supported in 3D mode";curRectMode===PConstants.CORNERS?(width-=x,height-=y):curRectMode===PConstants.RADIUS?(width*=2,height*=2,x-=width/2,y-=height/2):curRectMode===PConstants.CENTER&&(x-=width/2,y-=height/2);var model=new PMatrix3D;model.translate(x,y,0),model.scale(width,height,1),model.transpose();var view=new PMatrix3D;if(view.scale(1,-1,1),view.apply(modelView.array()),view.transpose(),lineWidth>0&&doStroke&&(curContext.useProgram(programObject2D),uniformMatrix("uModel2d",programObject2D,"uModel",!1,model.array()),uniformMatrix("uView2d",programObject2D,"uView",!1,view.array()),uniformf("uColor2d",programObject2D,"uColor",strokeStyle),uniformi("uIsDrawingText2d",programObject2D,"uIsDrawingText",!1),vertexAttribPointer("aVertex2d",programObject2D,"aVertex",3,rectBuffer),disableVertexAttribPointer("aTextureCoord2d",programObject2D,"aTextureCoord"),curContext.drawArrays(curContext.LINE_LOOP,0,rectVerts.length/3)),doFill){if(curContext.useProgram(programObject3D),uniformMatrix("uModel3d",programObject3D,"uModel",!1,model.array()),uniformMatrix("uView3d",programObject3D,"uView",!1,view.array()),curContext.enable(curContext.POLYGON_OFFSET_FILL),curContext.polygonOffset(1,1),uniformf("color3d",programObject3D,"uColor",fillStyle),lightCount>0){var v=new PMatrix3D;v.set(view);var m=new PMatrix3D;m.set(model),v.mult(m);var normalMatrix=new PMatrix3D;normalMatrix.set(v),normalMatrix.invert(),normalMatrix.transpose(),uniformMatrix("uNormalTransform3d",programObject3D,"uNormalTransform",!1,normalMatrix.array()),vertexAttribPointer("aNormal3d",programObject3D,"aNormal",3,rectNormBuffer)}else disableVertexAttribPointer("normal3d",programObject3D,"aNormal");vertexAttribPointer("vertex3d",programObject3D,"aVertex",3,rectBuffer),curContext.drawArrays(curContext.TRIANGLE_FAN,0,rectVerts.length/3),curContext.disable(curContext.POLYGON_OFFSET_FILL)}},Drawing2D.prototype.ellipse=function(x,y,width,height){if(x=x||0,y=y||0,!(0>=width&&0>=height))if(curEllipseMode===PConstants.RADIUS?(width*=2,height*=2):curEllipseMode===PConstants.CORNERS?(width-=x,height-=y,x+=width/2,y+=height/2):curEllipseMode===PConstants.CORNER&&(x+=width/2,y+=height/2),width===height)curContext.beginPath(),curContext.arc(x,y,width/2,0,PConstants.TWO_PI,!1),executeContextFill(),executeContextStroke();else{var w=width/2,h=height/2,C=.5522847498307933,c_x=C*w,c_y=C*h;p.beginShape(),p.vertex(x+w,y),p.bezierVertex(x+w,y-c_y,x+c_x,y-h,x,y-h),p.bezierVertex(x-c_x,y-h,x-w,y-c_y,x-w,y),p.bezierVertex(x-w,y+c_y,x-c_x,y+h,x,y+h),p.bezierVertex(x+c_x,y+h,x+w,y+c_y,x+w,y),p.endShape()}},Drawing3D.prototype.ellipse=function(x,y,width,height){if(x=x||0,y=y||0,!(0>=width&&0>=height)){curEllipseMode===PConstants.RADIUS?(width*=2,height*=2):curEllipseMode===PConstants.CORNERS?(width-=x,height-=y,x+=width/2,y+=height/2):curEllipseMode===PConstants.CORNER&&(x+=width/2,y+=height/2);var w=width/2,h=height/2,C=.5522847498307933,c_x=C*w,c_y=C*h;if(p.beginShape(),p.vertex(x+w,y),p.bezierVertex(x+w,y-c_y,0,x+c_x,y-h,0,x,y-h,0),p.bezierVertex(x-c_x,y-h,0,x-w,y-c_y,0,x-w,y,0),p.bezierVertex(x-w,y+c_y,0,x-c_x,y+h,0,x,y+h,0),p.bezierVertex(x+c_x,y+h,0,x+w,y+c_y,0,x+w,y,0),p.endShape(),doFill){var i,j,xAv=0,yAv=0;for(i=0;i<vertArray.length;i++)xAv+=vertArray[i][0],yAv+=vertArray[i][1];xAv/=vertArray.length,yAv/=vertArray.length;var vert=[],fillVertArray=[],colorVertArray=[];for(vert[0]=xAv,vert[1]=yAv,vert[2]=0,vert[3]=0,vert[4]=0,vert[5]=fillStyle[0],vert[6]=fillStyle[1],vert[7]=fillStyle[2],vert[8]=fillStyle[3],vert[9]=strokeStyle[0],vert[10]=strokeStyle[1],vert[11]=strokeStyle[2],vert[12]=strokeStyle[3],vert[13]=normalX,vert[14]=normalY,vert[15]=normalZ,vertArray.unshift(vert),i=0;i<vertArray.length;i++){for(j=0;3>j;j++)fillVertArray.push(vertArray[i][j]);for(j=5;9>j;j++)colorVertArray.push(vertArray[i][j])}fill3D(fillVertArray,"TRIANGLE_FAN",colorVertArray)}}},p.normal=function(nx,ny,nz){if(3!==arguments.length||"number"!=typeof nx||"number"!=typeof ny||"number"!=typeof nz)throw"normal() requires three numeric arguments.";normalX=nx,normalY=ny,normalZ=nz,0!==curShape&&(normalMode===PConstants.NORMAL_MODE_AUTO?normalMode=PConstants.NORMAL_MODE_SHAPE:normalMode===PConstants.NORMAL_MODE_SHAPE&&(normalMode=PConstants.NORMAL_MODE_VERTEX))},p.save=function(file,img){return img!==undef?window.open(img.toDataURL(),"_blank"):window.open(p.externals.canvas.toDataURL(),"_blank")};var saveNumber=0;p.saveFrame=function(file){file===undef&&(file="screen-####.png");var frameFilename=file.replace(/#+/,function(all){for(var s=""+saveNumber++;s.length<all.length;)s="0"+s;return s});p.save(frameFilename)};var utilityContext2d=document.createElement("canvas").getContext("2d"),canvasDataCache=[undef,undef,undef],PImage=function(aWidth,aHeight,aFormat){if(this.__isDirty=!1,aWidth instanceof HTMLImageElement)this.fromHTMLImageData(aWidth);else if(aHeight||aFormat){this.width=aWidth||1,this.height=aHeight||1;var canvas=this.sourceImg=document.createElement("canvas");canvas.width=this.width,canvas.height=this.height;{this.imageData=canvas.getContext("2d").createImageData(this.width,this.height)}if(this.format=aFormat===PConstants.ARGB||aFormat===PConstants.ALPHA?aFormat:PConstants.RGB,this.format===PConstants.RGB)for(var i=3,data=this.imageData.data,len=data.length;len>i;i+=4)data[i]=255;this.__isDirty=!0,this.updatePixels()}else this.width=0,this.height=0,this.imageData=utilityContext2d.createImageData(1,1),this.format=PConstants.ARGB;this.pixels=buildPixelsObject(this)};PImage.prototype={__isPImage:!0,updatePixels:function(){var canvas=this.sourceImg;canvas&&canvas instanceof HTMLCanvasElement&&this.__isDirty&&canvas.getContext("2d").putImageData(this.imageData,0,0),this.__isDirty=!1},fromHTMLImageData:function(htmlImg){var canvasData=getCanvasData(htmlImg);try{var imageData=canvasData.context.getImageData(0,0,htmlImg.width,htmlImg.height);this.fromImageData(imageData)}catch(e){htmlImg.width&&htmlImg.height&&(this.isRemote=!0,this.width=htmlImg.width,this.height=htmlImg.height)}this.sourceImg=htmlImg},get:function(x,y,w,h){return arguments.length?2===arguments.length?p.get(x,y,this):4===arguments.length?p.get(x,y,w,h,this):void 0:p.get(this)},set:function(x,y,c){p.set(x,y,c,this),this.__isDirty=!0},blend:function(srcImg,x,y,width,height,dx,dy,dwidth,dheight,MODE){9===arguments.length?p.blend(this,srcImg,x,y,width,height,dx,dy,dwidth,dheight,this):10===arguments.length&&p.blend(srcImg,x,y,width,height,dx,dy,dwidth,dheight,MODE,this),delete this.sourceImg},copy:function(srcImg,sx,sy,swidth,sheight,dx,dy,dwidth,dheight){8===arguments.length?p.blend(this,srcImg,sx,sy,swidth,sheight,dx,dy,dwidth,PConstants.REPLACE,this):9===arguments.length&&p.blend(srcImg,sx,sy,swidth,sheight,dx,dy,dwidth,dheight,PConstants.REPLACE,this),delete this.sourceImg},filter:function(mode,param){2===arguments.length?p.filter(mode,param,this):1===arguments.length&&p.filter(mode,null,this),delete this.sourceImg},save:function(file){p.save(file,this)},resize:function(w,h){if(this.isRemote)throw"Image is loaded remotely. Cannot resize.";if(0!==this.width||0!==this.height){0===w&&0!==h?w=Math.floor(this.width/this.height*h):0===h&&0!==w&&(h=Math.floor(this.height/this.width*w));var canvas=getCanvasData(this.imageData).canvas,imageData=getCanvasData(canvas,w,h).context.getImageData(0,0,w,h);this.fromImageData(imageData)}},mask:function(mask){var i,size,obj=this.toImageData();if(mask instanceof PImage||mask.__isPImage){if(mask.width!==this.width||mask.height!==this.height)throw"mask must have the same dimensions as PImage.";for(mask=mask.toImageData(),i=2,size=this.width*this.height*4;size>i;i+=4)obj.data[i+1]=mask.data[i]}else if(mask instanceof Array){if(this.width*this.height!==mask.length)throw"mask array must be the same length as PImage pixels array.";for(i=0,size=mask.length;size>i;++i)obj.data[4*i+3]=mask[i]}this.fromImageData(obj)},loadPixels:noop,toImageData:function(){if(this.isRemote)return this.sourceImg;if(!this.__isDirty)return this.imageData;var canvasData=getCanvasData(this.sourceImg);return canvasData.context.getImageData(0,0,this.width,this.height)},toDataURL:function(){if(this.isRemote)throw"Image is loaded remotely. Cannot create dataURI.";var canvasData=getCanvasData(this.imageData);return canvasData.canvas.toDataURL()},fromImageData:function(canvasImg){var w=canvasImg.width,h=canvasImg.height,canvas=document.createElement("canvas"),ctx=canvas.getContext("2d");this.width=canvas.width=w,this.height=canvas.height=h,ctx.putImageData(canvasImg,0,0),this.format=PConstants.ARGB,this.imageData=canvasImg,this.sourceImg=canvas}},p.PImage=PImage,p.createImage=function(w,h,mode){return new PImage(w,h,mode)},p.loadImage=function(file,type,callback){var pimg;if(curSketch.imageCache.images[file])return pimg=new PImage(curSketch.imageCache.images[file]),pimg.loaded=!0,pimg;pimg=new PImage;var img=document.createElement("img");return pimg.sourceImg=img,img.onload=function(aImage,aPImage,aCallback){var image=aImage,pimg=aPImage,callback=aCallback;return function(){pimg.fromHTMLImageData(image),pimg.loaded=!0,callback&&callback()}}(img,pimg,callback),img.src=file,pimg},p.requestImage=p.loadImage,p.get=function(x,y,w,h,img){return void 0!==img?get$5(x,y,w,h,img):void 0!==h?get$4(x,y,w,h):void 0!==w?get$3(x,y,w):void 0!==y?get$2(x,y):void 0!==x?get$5(0,0,x.width,x.height,x):get$4(0,0,p.width,p.height)},p.createGraphics=function(w,h,render){var pg=new Processing;return pg.size(w,h,render),pg.background(0,0),pg},p.set=function(x,y,obj,img){3===arguments.length?"number"==typeof obj?set$3(x,y,obj):(obj instanceof PImage||obj.__isPImage)&&p.image(obj,x,y):4===arguments.length&&set$4(x,y,obj,img)},p.imageData={},p.pixels={getLength:function(){return p.imageData.data.length?p.imageData.data.length/4:0},getPixel:function(i){var offset=4*i,data=p.imageData.data;return data[offset+3]<<24&4278190080|data[offset+0]<<16&16711680|data[offset+1]<<8&65280|255&data[offset+2]},setPixel:function(i,c){var offset=4*i,data=p.imageData.data;data[offset+0]=(16711680&c)>>>16,data[offset+1]=(65280&c)>>>8,data[offset+2]=255&c,data[offset+3]=(4278190080&c)>>>24},toArray:function(){for(var arr=[],length=p.imageData.width*p.imageData.height,data=p.imageData.data,i=0,offset=0;length>i;i++,offset+=4)arr.push(data[offset+3]<<24&4278190080|data[offset+0]<<16&16711680|data[offset+1]<<8&65280|255&data[offset+2]);return arr},set:function(arr){for(var i=0,aL=arr.length;aL>i;i++)this.setPixel(i,arr[i])}},p.loadPixels=function(){p.imageData=drawing.$ensureContext().getImageData(0,0,p.width,p.height)},p.updatePixels=function(){p.imageData&&drawing.$ensureContext().putImageData(p.imageData,0,0)},p.hint=function(which){var curContext=drawing.$ensureContext();which===PConstants.DISABLE_DEPTH_TEST?(curContext.disable(curContext.DEPTH_TEST),curContext.depthMask(!1),curContext.clear(curContext.DEPTH_BUFFER_BIT)):which===PConstants.ENABLE_DEPTH_TEST?(curContext.enable(curContext.DEPTH_TEST),curContext.depthMask(!0)):which===PConstants.ENABLE_OPENGL_2X_SMOOTH||which===PConstants.ENABLE_OPENGL_4X_SMOOTH?renderSmooth=!0:which===PConstants.DISABLE_OPENGL_2X_SMOOTH&&(renderSmooth=!1)};var backgroundHelper=function(arg1,arg2,arg3,arg4){var obj;if(arg1 instanceof PImage||arg1.__isPImage){if(obj=arg1,!obj.loaded)throw"Error using image in background(): PImage not loaded.";if(obj.width!==p.width||obj.height!==p.height)throw"Background image must be the same dimensions as the canvas."}else obj=p.color(arg1,arg2,arg3,arg4);backgroundObj=obj};Drawing2D.prototype.background=function(arg1,arg2,arg3,arg4){arg1!==undef&&backgroundHelper(arg1,arg2,arg3,arg4),backgroundObj instanceof PImage||backgroundObj.__isPImage?(saveContext(),curContext.setTransform(1,0,0,1,0,0),p.image(backgroundObj,0,0),restoreContext()):(saveContext(),curContext.setTransform(1,0,0,1,0,0),p.alpha(backgroundObj)!==colorModeA&&curContext.clearRect(0,0,p.width,p.height),curContext.fillStyle=p.color.toString(backgroundObj),curContext.fillRect(0,0,p.width,p.height),isFillDirty=!0,restoreContext())},Drawing3D.prototype.background=function(arg1,arg2,arg3,arg4){arguments.length>0&&backgroundHelper(arg1,arg2,arg3,arg4);var c=p.color.toGLArray(backgroundObj);curContext.clearColor(c[0],c[1],c[2],c[3]),curContext.clear(curContext.COLOR_BUFFER_BIT|curContext.DEPTH_BUFFER_BIT)},Drawing2D.prototype.image=function(img,x,y,w,h){if(x=Math.round(x),y=Math.round(y),img.width>0){var bounds=(w||img.width,h||img.height,imageModeConvert(x||0,y||0,w||img.width,h||img.height,arguments.length<4)),fastImage=!!img.sourceImg&&null===curTint;if(fastImage){var htmlElement=img.sourceImg;img.__isDirty&&img.updatePixels(),curContext.drawImage(htmlElement,0,0,htmlElement.width,htmlElement.height,bounds.x,bounds.y,bounds.w,bounds.h)}else{var obj=img.toImageData();null!==curTint&&(curTint(obj),img.__isDirty=!0),curContext.drawImage(getCanvasData(obj).canvas,0,0,img.width,img.height,bounds.x,bounds.y,bounds.w,bounds.h)}}},Drawing3D.prototype.image=function(img,x,y,w,h){img.width>0&&(x=Math.round(x),y=Math.round(y),w=w||img.width,h=h||img.height,p.beginShape(p.QUADS),p.texture(img),p.vertex(x,y,0,0,0),p.vertex(x,y+h,0,0,h),p.vertex(x+w,y+h,0,w,h),p.vertex(x+w,y,0,w,0),p.endShape())},p.tint=function(a1,a2,a3,a4){var tintColor=p.color(a1,a2,a3,a4),r=p.red(tintColor)/colorModeX,g=p.green(tintColor)/colorModeY,b=p.blue(tintColor)/colorModeZ,a=p.alpha(tintColor)/colorModeA;curTint=function(obj){for(var data=obj.data,length=4*obj.width*obj.height,i=0;length>i;)data[i++]*=r,data[i++]*=g,data[i++]*=b,data[i++]*=a
},curTint3d=function(data){for(var i=0;i<data.length;)data[i++]=r,data[i++]=g,data[i++]=b,data[i++]=a}},p.noTint=function(){curTint=null,curTint3d=null},p.copy=function(src,sx,sy,sw,sh,dx,dy,dw,dh){dh===undef&&(dh=dw,dw=dy,dy=dx,dx=sh,sh=sw,sw=sy,sy=sx,sx=src,src=p),p.blend(src,sx,sy,sw,sh,dx,dy,dw,dh,PConstants.REPLACE)},p.blend=function(src,sx,sy,sw,sh,dx,dy,dw,dh,mode,pimgdest){if(src.isRemote)throw"Image is loaded remotely. Cannot blend image.";mode===undef&&(mode=dh,dh=dw,dw=dy,dy=dx,dx=sh,sh=sw,sw=sy,sy=sx,sx=src,src=p);var sx2=sx+sw,sy2=sy+sh,dx2=dx+dw,dy2=dy+dh,dest=pimgdest||p;(pimgdest===undef||mode===undef)&&p.loadPixels(),src.loadPixels(),src===p&&p.intersect(sx,sy,sx2,sy2,dx,dy,dx2,dy2)?p.blit_resize(p.get(sx,sy,sx2-sx,sy2-sy),0,0,sx2-sx-1,sy2-sy-1,dest.imageData.data,dest.width,dest.height,dx,dy,dx2,dy2,mode):p.blit_resize(src,sx,sy,sx2,sy2,dest.imageData.data,dest.width,dest.height,dx,dy,dx2,dy2,mode),pimgdest===undef&&p.updatePixels()};var buildBlurKernel=function(r){var i,radiusi,radius=p.floor(3.5*r);if(radius=1>radius?1:248>radius?radius:248,p.shared.blurRadius!==radius){p.shared.blurRadius=radius,p.shared.blurKernelSize=1+(p.shared.blurRadius<<1),p.shared.blurKernel=new Float32Array(p.shared.blurKernelSize);{var sharedBlurKernal=p.shared.blurKernel,sharedBlurKernelSize=p.shared.blurKernelSize;p.shared.blurRadius}for(i=0;sharedBlurKernelSize>i;i++)sharedBlurKernal[i]=0;var radiusiSquared=(radius-1)*(radius-1);for(i=1;radius>i;i++)sharedBlurKernal[radius+i]=sharedBlurKernal[radiusi]=radiusiSquared;sharedBlurKernal[radius]=radius*radius}},blurARGB=function(r,aImg){var sum,cr,cg,cb,ca,m,read,ri,ym,ymi,bk0,x,y,i,offset,wh=aImg.pixels.getLength(),r2=new Float32Array(wh),g2=new Float32Array(wh),b2=new Float32Array(wh),a2=new Float32Array(wh),yi=0;buildBlurKernel(r);var aImgHeight=aImg.height,aImgWidth=aImg.width,sharedBlurKernelSize=p.shared.blurKernelSize,sharedBlurRadius=p.shared.blurRadius,sharedBlurKernal=p.shared.blurKernel,pix=aImg.imageData.data;for(y=0;aImgHeight>y;y++){for(x=0;aImgWidth>x;x++){if(cb=cg=cr=ca=sum=0,read=x-sharedBlurRadius,0>read)bk0=-read,read=0;else{if(read>=aImgWidth)break;bk0=0}for(i=bk0;sharedBlurKernelSize>i&&!(read>=aImgWidth);i++)offset=4*(read+yi),m=sharedBlurKernal[i],ca+=m*pix[offset+3],cr+=m*pix[offset],cg+=m*pix[offset+1],cb+=m*pix[offset+2],sum+=m,read++;ri=yi+x,a2[ri]=ca/sum,r2[ri]=cr/sum,g2[ri]=cg/sum,b2[ri]=cb/sum}yi+=aImgWidth}for(yi=0,ym=-sharedBlurRadius,ymi=ym*aImgWidth,y=0;aImgHeight>y;y++){for(x=0;aImgWidth>x;x++){if(cb=cg=cr=ca=sum=0,0>ym)bk0=ri=-ym,read=x;else{if(ym>=aImgHeight)break;bk0=0,ri=ym,read=x+ymi}for(i=bk0;sharedBlurKernelSize>i&&!(ri>=aImgHeight);i++)m=sharedBlurKernal[i],ca+=m*a2[read],cr+=m*r2[read],cg+=m*g2[read],cb+=m*b2[read],sum+=m,ri++,read+=aImgWidth;offset=4*(x+yi),pix[offset]=cr/sum,pix[offset+1]=cg/sum,pix[offset+2]=cb/sum,pix[offset+3]=ca/sum}yi+=aImgWidth,ymi+=aImgWidth,ym++}},dilate=function(isInverted,aImg){var currRowIdx,maxRowIdx,colOrig,colOut,currLum,idxRight,idxLeft,idxUp,idxDown,colRight,colLeft,colUp,colDown,lumRight,lumLeft,lumUp,lumDown,currIdx=0,maxIdx=aImg.pixels.getLength(),out=new Int32Array(maxIdx);if(isInverted)for(;maxIdx>currIdx;)for(currRowIdx=currIdx,maxRowIdx=currIdx+aImg.width;maxRowIdx>currIdx;)colOrig=colOut=aImg.pixels.getPixel(currIdx),idxLeft=currIdx-1,idxRight=currIdx+1,idxUp=currIdx-aImg.width,idxDown=currIdx+aImg.width,currRowIdx>idxLeft&&(idxLeft=currIdx),idxRight>=maxRowIdx&&(idxRight=currIdx),0>idxUp&&(idxUp=0),idxDown>=maxIdx&&(idxDown=currIdx),colUp=aImg.pixels.getPixel(idxUp),colLeft=aImg.pixels.getPixel(idxLeft),colDown=aImg.pixels.getPixel(idxDown),colRight=aImg.pixels.getPixel(idxRight),currLum=77*(colOrig>>16&255)+151*(colOrig>>8&255)+28*(255&colOrig),lumLeft=77*(colLeft>>16&255)+151*(colLeft>>8&255)+28*(255&colLeft),lumRight=77*(colRight>>16&255)+151*(colRight>>8&255)+28*(255&colRight),lumUp=77*(colUp>>16&255)+151*(colUp>>8&255)+28*(255&colUp),lumDown=77*(colDown>>16&255)+151*(colDown>>8&255)+28*(255&colDown),currLum>lumLeft&&(colOut=colLeft,currLum=lumLeft),currLum>lumRight&&(colOut=colRight,currLum=lumRight),currLum>lumUp&&(colOut=colUp,currLum=lumUp),currLum>lumDown&&(colOut=colDown,currLum=lumDown),out[currIdx++]=colOut;else for(;maxIdx>currIdx;)for(currRowIdx=currIdx,maxRowIdx=currIdx+aImg.width;maxRowIdx>currIdx;)colOrig=colOut=aImg.pixels.getPixel(currIdx),idxLeft=currIdx-1,idxRight=currIdx+1,idxUp=currIdx-aImg.width,idxDown=currIdx+aImg.width,currRowIdx>idxLeft&&(idxLeft=currIdx),idxRight>=maxRowIdx&&(idxRight=currIdx),0>idxUp&&(idxUp=0),idxDown>=maxIdx&&(idxDown=currIdx),colUp=aImg.pixels.getPixel(idxUp),colLeft=aImg.pixels.getPixel(idxLeft),colDown=aImg.pixels.getPixel(idxDown),colRight=aImg.pixels.getPixel(idxRight),currLum=77*(colOrig>>16&255)+151*(colOrig>>8&255)+28*(255&colOrig),lumLeft=77*(colLeft>>16&255)+151*(colLeft>>8&255)+28*(255&colLeft),lumRight=77*(colRight>>16&255)+151*(colRight>>8&255)+28*(255&colRight),lumUp=77*(colUp>>16&255)+151*(colUp>>8&255)+28*(255&colUp),lumDown=77*(colDown>>16&255)+151*(colDown>>8&255)+28*(255&colDown),lumLeft>currLum&&(colOut=colLeft,currLum=lumLeft),lumRight>currLum&&(colOut=colRight,currLum=lumRight),lumUp>currLum&&(colOut=colUp,currLum=lumUp),lumDown>currLum&&(colOut=colDown,currLum=lumDown),out[currIdx++]=colOut;aImg.pixels.set(out)};p.filter=function(kind,param,aImg){var img,col,lum,i;if(3===arguments.length?(aImg.loadPixels(),img=aImg):(p.loadPixels(),img=p),param===undef&&(param=null),img.isRemote)throw"Image is loaded remotely. Cannot filter image.";var imglen=img.pixels.getLength();switch(kind){case PConstants.BLUR:var radius=param||1;blurARGB(radius,img);break;case PConstants.GRAY:if(img.format===PConstants.ALPHA){for(i=0;imglen>i;i++)col=255-img.pixels.getPixel(i),img.pixels.setPixel(i,4278190080|col<<16|col<<8|col);img.format=PConstants.RGB}else for(i=0;imglen>i;i++)col=img.pixels.getPixel(i),lum=77*(col>>16&255)+151*(col>>8&255)+28*(255&col)>>8,img.pixels.setPixel(i,col&PConstants.ALPHA_MASK|lum<<16|lum<<8|lum);break;case PConstants.INVERT:for(i=0;imglen>i;i++)img.pixels.setPixel(i,16777215^img.pixels.getPixel(i));break;case PConstants.POSTERIZE:if(null===param)throw"Use filter(POSTERIZE, int levels) instead of filter(POSTERIZE)";var levels=p.floor(param);if(2>levels||levels>255)throw"Levels must be between 2 and 255 for filter(POSTERIZE, levels)";var levels1=levels-1;for(i=0;imglen>i;i++){var rlevel=img.pixels.getPixel(i)>>16&255,glevel=img.pixels.getPixel(i)>>8&255,blevel=255&img.pixels.getPixel(i);rlevel=255*(rlevel*levels>>8)/levels1,glevel=255*(glevel*levels>>8)/levels1,blevel=255*(blevel*levels>>8)/levels1,img.pixels.setPixel(i,4278190080&img.pixels.getPixel(i)|rlevel<<16|glevel<<8|blevel)}break;case PConstants.OPAQUE:for(i=0;imglen>i;i++)img.pixels.setPixel(i,4278190080|img.pixels.getPixel(i));img.format=PConstants.RGB;break;case PConstants.THRESHOLD:if(null===param&&(param=.5),0>param||param>1)throw"Level must be between 0 and 1 for filter(THRESHOLD, level)";var thresh=p.floor(255*param);for(i=0;imglen>i;i++){var max=p.max((img.pixels.getPixel(i)&PConstants.RED_MASK)>>16,p.max((img.pixels.getPixel(i)&PConstants.GREEN_MASK)>>8,img.pixels.getPixel(i)&PConstants.BLUE_MASK));img.pixels.setPixel(i,img.pixels.getPixel(i)&PConstants.ALPHA_MASK|(thresh>max?0:16777215))}break;case PConstants.ERODE:dilate(!0,img);break;case PConstants.DILATE:dilate(!1,img)}img.updatePixels()},p.shared={fracU:0,ifU:0,fracV:0,ifV:0,u1:0,u2:0,v1:0,v2:0,sX:0,sY:0,iw:0,iw1:0,ih1:0,ul:0,ll:0,ur:0,lr:0,cUL:0,cLL:0,cUR:0,cLR:0,srcXOffset:0,srcYOffset:0,r:0,g:0,b:0,a:0,srcBuffer:null,blurRadius:0,blurKernelSize:0,blurKernel:null},p.intersect=function(sx1,sy1,sx2,sy2,dx1,dy1,dx2,dy2){var sw=sx2-sx1+1,sh=sy2-sy1+1,dw=dx2-dx1+1,dh=dy2-dy1+1;if(sx1>dx1)dw+=dx1-sx1,dw>sw&&(dw=sw);else{var w=sw+sx1-dx1;dw>w&&(dw=w)}if(sy1>dy1)dh+=dy1-sy1,dh>sh&&(dh=sh);else{var h=sh+sy1-dy1;dh>h&&(dh=h)}return!(0>=dw||0>=dh)};var blendFuncs={};if(blendFuncs[PConstants.BLEND]=p.modes.blend,blendFuncs[PConstants.ADD]=p.modes.add,blendFuncs[PConstants.SUBTRACT]=p.modes.subtract,blendFuncs[PConstants.LIGHTEST]=p.modes.lightest,blendFuncs[PConstants.DARKEST]=p.modes.darkest,blendFuncs[PConstants.REPLACE]=p.modes.replace,blendFuncs[PConstants.DIFFERENCE]=p.modes.difference,blendFuncs[PConstants.EXCLUSION]=p.modes.exclusion,blendFuncs[PConstants.MULTIPLY]=p.modes.multiply,blendFuncs[PConstants.SCREEN]=p.modes.screen,blendFuncs[PConstants.OVERLAY]=p.modes.overlay,blendFuncs[PConstants.HARD_LIGHT]=p.modes.hard_light,blendFuncs[PConstants.SOFT_LIGHT]=p.modes.soft_light,blendFuncs[PConstants.DODGE]=p.modes.dodge,blendFuncs[PConstants.BURN]=p.modes.burn,p.blit_resize=function(img,srcX1,srcY1,srcX2,srcY2,destPixels,screenW,screenH,destX1,destY1,destX2,destY2,mode){var x,y;0>srcX1&&(srcX1=0),0>srcY1&&(srcY1=0),srcX2>=img.width&&(srcX2=img.width-1),srcY2>=img.height&&(srcY2=img.height-1);var srcW=srcX2-srcX1,srcH=srcY2-srcY1,destW=destX2-destX1,destH=destY2-destY1;if(!(0>=destW||0>=destH||0>=srcW||0>=srcH||destX1>=screenW||destY1>=screenH||srcX1>=img.width||srcY1>=img.height)){var dx=Math.floor(srcW/destW*PConstants.PRECISIONF),dy=Math.floor(srcH/destH*PConstants.PRECISIONF),pshared=p.shared;pshared.srcXOffset=Math.floor(0>destX1?-destX1*dx:srcX1*PConstants.PRECISIONF),pshared.srcYOffset=Math.floor(0>destY1?-destY1*dy:srcY1*PConstants.PRECISIONF),0>destX1&&(destW+=destX1,destX1=0),0>destY1&&(destH+=destY1,destY1=0),destW=Math.min(destW,screenW-destX1),destH=Math.min(destH,screenH-destY1);var destColor,destOffset=destY1*screenW+destX1;pshared.srcBuffer=img.imageData.data,pshared.iw=img.width,pshared.iw1=img.width-1,pshared.ih1=img.height-1;var blendedColor,idx,cULoffset,cURoffset,cLLoffset,cLRoffset,blendFunc=(p.filter_bilinear,p.filter_new_scanline,blendFuncs[mode]),ALPHA_MASK=PConstants.ALPHA_MASK,RED_MASK=PConstants.RED_MASK,GREEN_MASK=PConstants.GREEN_MASK,BLUE_MASK=PConstants.BLUE_MASK,PREC_MAXVAL=PConstants.PREC_MAXVAL,PRECISIONB=PConstants.PRECISIONB,PREC_RED_SHIFT=PConstants.PREC_RED_SHIFT,PREC_ALPHA_SHIFT=PConstants.PREC_ALPHA_SHIFT,srcBuffer=pshared.srcBuffer,min=Math.min;for(y=0;destH>y;y++){for(pshared.sX=pshared.srcXOffset,pshared.fracV=pshared.srcYOffset&PREC_MAXVAL,pshared.ifV=PREC_MAXVAL-pshared.fracV,pshared.v1=(pshared.srcYOffset>>PRECISIONB)*pshared.iw,pshared.v2=min((pshared.srcYOffset>>PRECISIONB)+1,pshared.ih1)*pshared.iw,x=0;destW>x;x++)idx=4*(destOffset+x),destColor=destPixels[idx+3]<<24&ALPHA_MASK|destPixels[idx]<<16&RED_MASK|destPixels[idx+1]<<8&GREEN_MASK|destPixels[idx+2]&BLUE_MASK,pshared.fracU=pshared.sX&PREC_MAXVAL,pshared.ifU=PREC_MAXVAL-pshared.fracU,pshared.ul=pshared.ifU*pshared.ifV>>PRECISIONB,pshared.ll=pshared.ifU*pshared.fracV>>PRECISIONB,pshared.ur=pshared.fracU*pshared.ifV>>PRECISIONB,pshared.lr=pshared.fracU*pshared.fracV>>PRECISIONB,pshared.u1=pshared.sX>>PRECISIONB,pshared.u2=min(pshared.u1+1,pshared.iw1),cULoffset=4*(pshared.v1+pshared.u1),cURoffset=4*(pshared.v1+pshared.u2),cLLoffset=4*(pshared.v2+pshared.u1),cLRoffset=4*(pshared.v2+pshared.u2),pshared.cUL=srcBuffer[cULoffset+3]<<24&ALPHA_MASK|srcBuffer[cULoffset]<<16&RED_MASK|srcBuffer[cULoffset+1]<<8&GREEN_MASK|srcBuffer[cULoffset+2]&BLUE_MASK,pshared.cUR=srcBuffer[cURoffset+3]<<24&ALPHA_MASK|srcBuffer[cURoffset]<<16&RED_MASK|srcBuffer[cURoffset+1]<<8&GREEN_MASK|srcBuffer[cURoffset+2]&BLUE_MASK,pshared.cLL=srcBuffer[cLLoffset+3]<<24&ALPHA_MASK|srcBuffer[cLLoffset]<<16&RED_MASK|srcBuffer[cLLoffset+1]<<8&GREEN_MASK|srcBuffer[cLLoffset+2]&BLUE_MASK,pshared.cLR=srcBuffer[cLRoffset+3]<<24&ALPHA_MASK|srcBuffer[cLRoffset]<<16&RED_MASK|srcBuffer[cLRoffset+1]<<8&GREEN_MASK|srcBuffer[cLRoffset+2]&BLUE_MASK,pshared.r=pshared.ul*((pshared.cUL&RED_MASK)>>16)+pshared.ll*((pshared.cLL&RED_MASK)>>16)+pshared.ur*((pshared.cUR&RED_MASK)>>16)+pshared.lr*((pshared.cLR&RED_MASK)>>16)<<PREC_RED_SHIFT&RED_MASK,pshared.g=pshared.ul*(pshared.cUL&GREEN_MASK)+pshared.ll*(pshared.cLL&GREEN_MASK)+pshared.ur*(pshared.cUR&GREEN_MASK)+pshared.lr*(pshared.cLR&GREEN_MASK)>>>PRECISIONB&GREEN_MASK,pshared.b=pshared.ul*(pshared.cUL&BLUE_MASK)+pshared.ll*(pshared.cLL&BLUE_MASK)+pshared.ur*(pshared.cUR&BLUE_MASK)+pshared.lr*(pshared.cLR&BLUE_MASK)>>>PRECISIONB,pshared.a=pshared.ul*((pshared.cUL&ALPHA_MASK)>>>24)+pshared.ll*((pshared.cLL&ALPHA_MASK)>>>24)+pshared.ur*((pshared.cUR&ALPHA_MASK)>>>24)+pshared.lr*((pshared.cLR&ALPHA_MASK)>>>24)<<PREC_ALPHA_SHIFT&ALPHA_MASK,blendedColor=blendFunc(destColor,pshared.a|pshared.r|pshared.g|pshared.b),destPixels[idx]=(blendedColor&RED_MASK)>>>16,destPixels[idx+1]=(blendedColor&GREEN_MASK)>>>8,destPixels[idx+2]=blendedColor&BLUE_MASK,destPixels[idx+3]=(blendedColor&ALPHA_MASK)>>>24,pshared.sX+=dx;destOffset+=screenW,pshared.srcYOffset+=dy}}},p.loadFont=function(name,size){if(name===undef)throw"font name required in loadFont.";if(-1===name.indexOf(".svg"))return size===undef&&(size=curTextFont.size),PFont.get(name,size);var font=p.loadGlyphs(name);return{name:name,css:"12px sans-serif",glyph:!0,units_per_em:font.units_per_em,horiz_adv_x:1/font.units_per_em*font.horiz_adv_x,ascent:font.ascent,descent:font.descent,width:function(str){for(var width=0,len=str.length,i=0;len>i;i++)try{width+=parseFloat(p.glyphLook(p.glyphTable[name],str[i]).horiz_adv_x)}catch(e){Processing.debug(e)}return width/p.glyphTable[name].units_per_em}}},p.createFont=function(name,size){return p.loadFont(name,size)},p.textFont=function(pfont,size){size!==undef&&(pfont.glyph||(pfont=PFont.get(pfont.name,size)),curTextSize=size),curTextFont=pfont,curFontName=curTextFont.name,curTextAscent=curTextFont.ascent,curTextDescent=curTextFont.descent,curTextLeading=curTextFont.leading;var curContext=drawing.$ensureContext();curContext.font=curTextFont.css},p.textSize=function(size){curTextFont=PFont.get(curFontName,size),curTextSize=size,curTextAscent=curTextFont.ascent,curTextDescent=curTextFont.descent,curTextLeading=curTextFont.leading;var curContext=drawing.$ensureContext();curContext.font=curTextFont.css},p.textAscent=function(){return curTextAscent},p.textDescent=function(){return curTextDescent},p.textLeading=function(leading){curTextLeading=leading},p.textAlign=function(xalign,yalign){horizontalTextAlignment=xalign,verticalTextAlignment=yalign||PConstants.BASELINE},Drawing2D.prototype.textWidth=function(str){var i,lines=toP5String(str).split(/\r?\n/g),width=0,linesCount=lines.length;for(curContext.font=curTextFont.css,i=0;linesCount>i;++i)width=Math.max(width,curTextFont.measureTextWidth(lines[i]));return 0|width},Drawing3D.prototype.textWidth=function(str){var i,lines=toP5String(str).split(/\r?\n/g),width=0,linesCount=lines.length;textcanvas===undef&&(textcanvas=document.createElement("canvas"));var textContext=textcanvas.getContext("2d");for(textContext.font=curTextFont.css,i=0;linesCount>i;++i)width=Math.max(width,textContext.measureText(lines[i]).width);return 0|width},p.glyphLook=function(font,chr){try{switch(chr){case"1":return font.one;case"2":return font.two;case"3":return font.three;case"4":return font.four;case"5":return font.five;case"6":return font.six;case"7":return font.seven;case"8":return font.eight;case"9":return font.nine;case"0":return font.zero;case" ":return font.space;case"$":return font.dollar;case"!":return font.exclam;case'"':return font.quotedbl;case"#":return font.numbersign;case"%":return font.percent;case"&":return font.ampersand;case"'":return font.quotesingle;case"(":return font.parenleft;case")":return font.parenright;case"*":return font.asterisk;case"+":return font.plus;case",":return font.comma;case"-":return font.hyphen;case".":return font.period;case"/":return font.slash;case"_":return font.underscore;case":":return font.colon;case";":return font.semicolon;case"<":return font.less;case"=":return font.equal;case">":return font.greater;case"?":return font.question;case"@":return font.at;case"[":return font.bracketleft;case"\\":return font.backslash;case"]":return font.bracketright;case"^":return font.asciicircum;case"`":return font.grave;case"{":return font.braceleft;case"|":return font.bar;case"}":return font.braceright;case"~":return font.asciitilde;default:return font[chr]}}catch(e){Processing.debug(e)}},Drawing2D.prototype.text$line=function(str,x,y,z,align){var textWidth=0,xOffset=0;if(curTextFont.glyph){var font=p.glyphTable[curFontName];saveContext(),curContext.translate(x,y+curTextSize),(align===PConstants.RIGHT||align===PConstants.CENTER)&&(textWidth=font.width(str),xOffset=align===PConstants.RIGHT?-textWidth:-textWidth/2);var upem=font.units_per_em,newScale=1/upem*curTextSize;curContext.scale(newScale,newScale);for(var i=0,len=str.length;len>i;i++)try{p.glyphLook(font,str[i]).draw()}catch(e){Processing.debug(e)}restoreContext()}else str&&"fillText"in curContext&&(isFillDirty&&(curContext.fillStyle=p.color.toString(currentFillColor),isFillDirty=!1),(align===PConstants.RIGHT||align===PConstants.CENTER)&&(textWidth=curTextFont.measureTextWidth(str),xOffset=align===PConstants.RIGHT?-textWidth:-textWidth/2),curContext.fillText(str,x+xOffset,y))},Drawing3D.prototype.text$line=function(str,x,y,z,align){textcanvas===undef&&(textcanvas=document.createElement("canvas"));var oldContext=curContext;curContext=textcanvas.getContext("2d"),curContext.font=curTextFont.css;var textWidth=curTextFont.measureTextWidth(str);textcanvas.width=textWidth,textcanvas.height=curTextSize,curContext=textcanvas.getContext("2d"),curContext.font=curTextFont.css,curContext.textBaseline="top",Drawing2D.prototype.text$line(str,0,0,0,PConstants.LEFT);var aspect=textcanvas.width/textcanvas.height;curContext=oldContext,curContext.bindTexture(curContext.TEXTURE_2D,textTex),curContext.texImage2D(curContext.TEXTURE_2D,0,curContext.RGBA,curContext.RGBA,curContext.UNSIGNED_BYTE,textcanvas),curContext.texParameteri(curContext.TEXTURE_2D,curContext.TEXTURE_MAG_FILTER,curContext.LINEAR),curContext.texParameteri(curContext.TEXTURE_2D,curContext.TEXTURE_MIN_FILTER,curContext.LINEAR),curContext.texParameteri(curContext.TEXTURE_2D,curContext.TEXTURE_WRAP_T,curContext.CLAMP_TO_EDGE),curContext.texParameteri(curContext.TEXTURE_2D,curContext.TEXTURE_WRAP_S,curContext.CLAMP_TO_EDGE);var xOffset=0;align===PConstants.RIGHT?xOffset=-textWidth:align===PConstants.CENTER&&(xOffset=-textWidth/2);var model=new PMatrix3D,scalefactor=.5*curTextSize;model.translate(x+xOffset-scalefactor/2,y-scalefactor,z),model.scale(-aspect*scalefactor,-scalefactor,scalefactor),model.translate(-1,-1,-1),model.transpose();var view=new PMatrix3D;view.scale(1,-1,1),view.apply(modelView.array()),view.transpose(),curContext.useProgram(programObject2D),vertexAttribPointer("aVertex2d",programObject2D,"aVertex",3,textBuffer),vertexAttribPointer("aTextureCoord2d",programObject2D,"aTextureCoord",2,textureBuffer),uniformi("uSampler2d",programObject2D,"uSampler",[0]),uniformi("uIsDrawingText2d",programObject2D,"uIsDrawingText",!0),uniformMatrix("uModel2d",programObject2D,"uModel",!1,model.array()),uniformMatrix("uView2d",programObject2D,"uView",!1,view.array()),uniformf("uColor2d",programObject2D,"uColor",fillStyle),curContext.bindBuffer(curContext.ELEMENT_ARRAY_BUFFER,indexBuffer),curContext.drawElements(curContext.TRIANGLES,6,curContext.UNSIGNED_SHORT,0)},p.text=function(){textMode!==PConstants.SHAPE&&(3===arguments.length?text$4(toP5String(arguments[0]),arguments[1],arguments[2],0):4===arguments.length?text$4(toP5String(arguments[0]),arguments[1],arguments[2],arguments[3]):5===arguments.length?text$6(toP5String(arguments[0]),arguments[1],arguments[2],arguments[3],arguments[4],0):6===arguments.length&&text$6(toP5String(arguments[0]),arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]))},p.textMode=function(mode){textMode=mode},p.loadGlyphs=function(url){var x,y,cx,cy,nx,ny,d,a,lastCom,lenC,horiz_adv_x,path,getXY="[0-9\\-]+",regex=function(needle,hay){var latest,i=0,results=[],regexp=new RegExp(needle,"g");for(latest=results[i]=regexp.exec(hay);latest;)i++,latest=results[i]=regexp.exec(hay);return results},buildPath=function(d){var c=regex("[A-Za-z][0-9\\- ]+|Z",d),beforePathDraw=function(){return saveContext(),drawing.$ensureContext()},afterPathDraw=function(){executeContextFill(),executeContextStroke(),restoreContext()};path="return {draw:function(){var curContext=beforePathDraw();curContext.beginPath();",x=0,y=0,cx=0,cy=0,nx=0,ny=0,d=0,a=0,lastCom="",lenC=c.length-1;for(var j=0;lenC>j;j++){var com=c[j][0],xy=regex(getXY,com);switch(com[0]){case"M":x=parseFloat(xy[0][0]),y=parseFloat(xy[1][0]),path+="curContext.moveTo("+x+","+-y+");";break;case"L":x=parseFloat(xy[0][0]),y=parseFloat(xy[1][0]),path+="curContext.lineTo("+x+","+-y+");";break;case"H":x=parseFloat(xy[0][0]),path+="curContext.lineTo("+x+","+-y+");";break;case"V":y=parseFloat(xy[0][0]),path+="curContext.lineTo("+x+","+-y+");";break;case"T":nx=parseFloat(xy[0][0]),ny=parseFloat(xy[1][0]),"Q"===lastCom||"T"===lastCom?(d=Math.sqrt(Math.pow(x-cx,2)+Math.pow(cy-y,2)),a=Math.PI+Math.atan2(cx-x,cy-y),cx=x+Math.sin(a)*d,cy=y+Math.cos(a)*d):(cx=x,cy=y),path+="curContext.quadraticCurveTo("+cx+","+-cy+","+nx+","+-ny+");",x=nx,y=ny;break;case"Q":cx=parseFloat(xy[0][0]),cy=parseFloat(xy[1][0]),nx=parseFloat(xy[2][0]),ny=parseFloat(xy[3][0]),path+="curContext.quadraticCurveTo("+cx+","+-cy+","+nx+","+-ny+");",x=nx,y=ny;break;case"Z":path+="curContext.closePath();"}lastCom=com[0]}return path+="afterPathDraw();",path+="curContext.translate("+horiz_adv_x+",0);",path+="}}",new Function("beforePathDraw","afterPathDraw",path)(beforePathDraw,afterPathDraw)},parseSVGFont=function(svg){var font=svg.getElementsByTagName("font");p.glyphTable[url].horiz_adv_x=font[0].getAttribute("horiz-adv-x");var font_face=svg.getElementsByTagName("font-face")[0];p.glyphTable[url].units_per_em=parseFloat(font_face.getAttribute("units-per-em")),p.glyphTable[url].ascent=parseFloat(font_face.getAttribute("ascent")),p.glyphTable[url].descent=parseFloat(font_face.getAttribute("descent"));for(var glyph=svg.getElementsByTagName("glyph"),len=glyph.length,i=0;len>i;i++){var unicode=glyph[i].getAttribute("unicode"),name=glyph[i].getAttribute("glyph-name");horiz_adv_x=glyph[i].getAttribute("horiz-adv-x"),null===horiz_adv_x&&(horiz_adv_x=p.glyphTable[url].horiz_adv_x),d=glyph[i].getAttribute("d"),d!==undef&&(path=buildPath(d),p.glyphTable[url][name]={name:name,unicode:unicode,horiz_adv_x:horiz_adv_x,draw:path.draw})}},loadXML=function(){var xmlDoc;try{xmlDoc=document.implementation.createDocument("","",null)}catch(e_fx_op){return void Processing.debug(e_fx_op.message)}try{xmlDoc.async=!1,xmlDoc.load(url),parseSVGFont(xmlDoc.getElementsByTagName("svg")[0])}catch(e_sf_ch){Processing.debug(e_sf_ch);try{var xmlhttp=new window.XMLHttpRequest;xmlhttp.open("GET",url,!1),xmlhttp.send(null),parseSVGFont(xmlhttp.responseXML.documentElement)}catch(e){Processing.debug(e_sf_ch)}}};return p.glyphTable[url]={},loadXML(url),p.glyphTable[url]},p.param=function(name){var attributeName="data-processing-"+name;if(curElement.hasAttribute(attributeName))return curElement.getAttribute(attributeName);for(var i=0,len=curElement.childNodes.length;len>i;++i){var item=curElement.childNodes.item(i);if(1===item.nodeType&&"param"===item.tagName.toLowerCase()&&item.getAttribute("name")===name)return item.getAttribute("value")}return curSketch.params.hasOwnProperty(name)?curSketch.params[name]:null},DrawingPre.prototype.translate=createDrawingPreFunction("translate"),DrawingPre.prototype.transform=createDrawingPreFunction("transform"),DrawingPre.prototype.scale=createDrawingPreFunction("scale"),DrawingPre.prototype.pushMatrix=createDrawingPreFunction("pushMatrix"),DrawingPre.prototype.popMatrix=createDrawingPreFunction("popMatrix"),DrawingPre.prototype.resetMatrix=createDrawingPreFunction("resetMatrix"),DrawingPre.prototype.applyMatrix=createDrawingPreFunction("applyMatrix"),DrawingPre.prototype.rotate=createDrawingPreFunction("rotate"),DrawingPre.prototype.rotateZ=createDrawingPreFunction("rotateZ"),DrawingPre.prototype.shearX=createDrawingPreFunction("shearX"),DrawingPre.prototype.shearY=createDrawingPreFunction("shearY"),DrawingPre.prototype.redraw=createDrawingPreFunction("redraw"),DrawingPre.prototype.toImageData=createDrawingPreFunction("toImageData"),DrawingPre.prototype.ambientLight=createDrawingPreFunction("ambientLight"),DrawingPre.prototype.directionalLight=createDrawingPreFunction("directionalLight"),DrawingPre.prototype.lightFalloff=createDrawingPreFunction("lightFalloff"),DrawingPre.prototype.lightSpecular=createDrawingPreFunction("lightSpecular"),DrawingPre.prototype.pointLight=createDrawingPreFunction("pointLight"),DrawingPre.prototype.noLights=createDrawingPreFunction("noLights"),DrawingPre.prototype.spotLight=createDrawingPreFunction("spotLight"),DrawingPre.prototype.beginCamera=createDrawingPreFunction("beginCamera"),DrawingPre.prototype.endCamera=createDrawingPreFunction("endCamera"),DrawingPre.prototype.frustum=createDrawingPreFunction("frustum"),DrawingPre.prototype.box=createDrawingPreFunction("box"),DrawingPre.prototype.sphere=createDrawingPreFunction("sphere"),DrawingPre.prototype.ambient=createDrawingPreFunction("ambient"),DrawingPre.prototype.emissive=createDrawingPreFunction("emissive"),DrawingPre.prototype.shininess=createDrawingPreFunction("shininess"),DrawingPre.prototype.specular=createDrawingPreFunction("specular"),DrawingPre.prototype.fill=createDrawingPreFunction("fill"),DrawingPre.prototype.stroke=createDrawingPreFunction("stroke"),DrawingPre.prototype.strokeWeight=createDrawingPreFunction("strokeWeight"),DrawingPre.prototype.smooth=createDrawingPreFunction("smooth"),DrawingPre.prototype.noSmooth=createDrawingPreFunction("noSmooth"),DrawingPre.prototype.point=createDrawingPreFunction("point"),DrawingPre.prototype.vertex=createDrawingPreFunction("vertex"),DrawingPre.prototype.endShape=createDrawingPreFunction("endShape"),DrawingPre.prototype.bezierVertex=createDrawingPreFunction("bezierVertex"),DrawingPre.prototype.curveVertex=createDrawingPreFunction("curveVertex"),DrawingPre.prototype.curve=createDrawingPreFunction("curve"),DrawingPre.prototype.line=createDrawingPreFunction("line"),DrawingPre.prototype.bezier=createDrawingPreFunction("bezier"),DrawingPre.prototype.rect=createDrawingPreFunction("rect"),DrawingPre.prototype.ellipse=createDrawingPreFunction("ellipse"),DrawingPre.prototype.background=createDrawingPreFunction("background"),DrawingPre.prototype.image=createDrawingPreFunction("image"),DrawingPre.prototype.textWidth=createDrawingPreFunction("textWidth"),DrawingPre.prototype.text$line=createDrawingPreFunction("text$line"),DrawingPre.prototype.$ensureContext=createDrawingPreFunction("$ensureContext"),DrawingPre.prototype.$newPMatrix=createDrawingPreFunction("$newPMatrix"),DrawingPre.prototype.size=function(aWidth,aHeight,aMode){wireDimensionalFunctions(aMode===PConstants.WEBGL?"3D":"2D"),p.size(aWidth,aHeight,aMode)},DrawingPre.prototype.$init=noop,Drawing2D.prototype.$init=function(){p.size(p.width,p.height),curContext.lineCap="round",p.noSmooth(),p.disableContextMenu()},Drawing3D.prototype.$init=function(){p.use3DContext=!0,p.disableContextMenu()},DrawingShared.prototype.$ensureContext=function(){return curContext},curElement.getAttribute("tabindex")||curElement.setAttribute("tabindex",0),pgraphicsMode)curSketch=new Processing.Sketch,wireDimensionalFunctions(),p.size=function(w,h,render){wireDimensionalFunctions(render&&render===PConstants.WEBGL?"3D":"2D"),p.size(w,h,render)};else{curSketch=aCode instanceof Processing.Sketch?aCode:"function"==typeof aCode?new Processing.Sketch(aCode):aCode?Processing.compile(aCode):new Processing.Sketch(function(){}),p.externals.sketch=curSketch,wireDimensionalFunctions(),curElement.onfocus=function(){p.focused=!0},curElement.onblur=function(){p.focused=!1,curSketch.options.globalKeyEvents||resetKeyPressed()},curSketch.options.pauseOnBlur&&(attachEventHandler(window,"focus",function(){doLoop&&p.loop()}),attachEventHandler(window,"blur",function(){doLoop&&loopStarted&&(p.noLoop(),doLoop=!0),resetKeyPressed()}));var keyTrigger=curSketch.options.globalKeyEvents?window:curElement;attachEventHandler(keyTrigger,"keydown",handleKeydown),attachEventHandler(keyTrigger,"keypress",handleKeypress),attachEventHandler(keyTrigger,"keyup",handleKeyup);for(var i in Processing.lib)Processing.lib.hasOwnProperty(i)&&(Processing.lib[i].hasOwnProperty("attach")?Processing.lib[i].attach(p):Processing.lib[i]instanceof Function&&Processing.lib[i].call(this));var retryInterval=100,executeSketch=function(processing){if(curSketch.imageCache.pending||PFont.preloading.pending(retryInterval))window.setTimeout(function(){executeSketch(processing)},retryInterval);else{if(window.opera){var link,element,operaCache=curSketch.imageCache.operaCache;for(link in operaCache)operaCache.hasOwnProperty(link)&&(element=operaCache[link],null!==element&&document.body.removeChild(element),delete operaCache[link])}curSketch.attach(processing,defaultScope),curSketch.onLoad(processing),processing.setup&&(processing.setup(),processing.resetMatrix(),curSketch.onSetup()),resetContext(),processing.draw&&(doLoop?processing.loop():processing.redraw())}};addInstance(this),executeSketch(p)}};return Processing.debug=function(){return"console"in window?function(){}:noop}(),Processing.prototype=defaultScope,Processing.instances=processingInstances,Processing.getInstanceById=function(name){return processingInstances[processingInstanceIds[name]]},function(Processing){function createUnsupportedFunc(n){return function(){throw"Processing.js does not support "+n+"."}}for(var prettyName,p5Name,unsupportedP5="open() createOutput() createInput() BufferedReader selectFolder() dataPath() createWriter() selectOutput() beginRecord() saveStream() endRecord() selectInput() saveBytes() createReader() beginRaw() endRaw() PrintWriter delay()".split(" "),count=unsupportedP5.length;count--;)prettyName=unsupportedP5[count],p5Name=prettyName.replace("()",""),Processing[p5Name]=createUnsupportedFunc(prettyName)}(defaultScope),Processing}},{}],27:[function(require,module){var source={virtEquals:require("./Helpers/virtEquals"),virtHashCode:require("./Helpers/virtHashCode"),ObjectIterator:require("./Helpers/ObjectIterator"),PConstants:require("./Helpers/PConstants"),ArrayList:require("./Objects/ArrayList"),HashMap:require("./Objects/HashMap"),PVector:require("./Objects/PVector"),PFont:require("./Objects/PFont"),Char:require("./Objects/Char"),XMLAttribute:require("./Objects/XMLAttribute"),XMLElement:require("./Objects/XMLElement"),PMatrix2D:require("./Objects/PMatrix2D"),PMatrix3D:require("./Objects/PMatrix3D"),PShape:require("./Objects/PShape"),colors:require("./Objects/webcolors"),PShapeSVG:require("./Objects/PShapeSVG"),CommonFunctions:require("./P5Functions/commonFunctions"),defaultScope:require("./Helpers/defaultScope"),Processing:require("./Processing"),setupParser:require("./Parser/Parser"),finalize:require("./Helpers/finalizeProcessing")};source.extend={withMath:require("./P5Functions/Math.js"),withProxyFunctions:require("./P5Functions/JavaProxyFunctions")(source.virtHashCode,source.virtEquals),withTouch:require("./P5Functions/touchmouse"),withCommonFunctions:source.CommonFunctions.withCommonFunctions},module.exports=function(Browser,testHarness){var noop=function(){},virtEquals=source.virtEquals,virtHashCode=source.virtHashCode,PConstants=source.PConstants,CommonFunctions=source.CommonFunctions,ObjectIterator=source.ObjectIterator,Char=source.Char,XMLAttribute=source.XMLAttribute(),ArrayList=source.ArrayList({virtHashCode:virtHashCode,virtEquals:virtEquals}),HashMap=source.HashMap({virtHashCode:virtHashCode,virtEquals:virtEquals}),PVector=source.PVector({PConstants:PConstants}),PFont=source.PFont({Browser:Browser,noop:noop}),XMLElement=source.XMLElement({Browser:Browser,XMLAttribute:XMLAttribute}),PMatrix2D=source.PMatrix2D({p:CommonFunctions}),PMatrix3D=source.PMatrix3D({p:CommonFunctions}),PShape=source.PShape({PConstants:PConstants,PMatrix2D:PMatrix2D,PMatrix3D:PMatrix3D}),PShapeSVG=source.PShapeSVG({CommonFunctions:CommonFunctions,PConstants:PConstants,PShape:PShape,XMLElement:XMLElement,colors:source.colors}),defaultScope=source.defaultScope({ArrayList:ArrayList,HashMap:HashMap,PVector:PVector,PFont:PFont,PShapeSVG:PShapeSVG,ObjectIterator:ObjectIterator,PConstants:PConstants,Char:Char,XMLElement:XMLElement,XML:XMLElement}),Processing=source.Processing({defaultScope:defaultScope,Browser:Browser,extend:source.extend,noop:noop});
return Processing=source.setupParser(Processing,{Browser:Browser,aFunctions:testHarness,defaultScope:defaultScope}),Processing=source.finalize(Processing,{version:require("../package.json").version,isDomPresent:!1||Browser.isDomPresent,window:Browser.window,document:Browser.document,noop:noop})}},{"../package.json":2,"./Helpers/ObjectIterator":3,"./Helpers/PConstants":4,"./Helpers/defaultScope":5,"./Helpers/finalizeProcessing":6,"./Helpers/virtEquals":7,"./Helpers/virtHashCode":8,"./Objects/ArrayList":9,"./Objects/Char":10,"./Objects/HashMap":11,"./Objects/PFont":12,"./Objects/PMatrix2D":13,"./Objects/PMatrix3D":14,"./Objects/PShape":15,"./Objects/PShapeSVG":16,"./Objects/PVector":17,"./Objects/XMLAttribute":18,"./Objects/XMLElement":19,"./Objects/webcolors":20,"./P5Functions/JavaProxyFunctions":21,"./P5Functions/Math.js":22,"./P5Functions/commonFunctions":23,"./P5Functions/touchmouse":24,"./Parser/Parser":25,"./Processing":26}]},{},[1]),!function(){"use strict";function e(){try{"undefined"!=typeof AudioContext?n=new AudioContext:"undefined"!=typeof webkitAudioContext?n=new webkitAudioContext:o=!1}catch(e){o=!1}if(!o)if("undefined"!=typeof Audio)try{new Audio}catch(e){t=!0}else t=!0}var n=null,o=!0,t=!1;if(e(),o){var r="undefined"==typeof n.createGain?n.createGainNode():n.createGain();r.gain.value=1,r.connect(n.destination)}var d=function(){this.init()};d.prototype={init:function(){var e=this||u;return e._codecs={},e._howls=[],e._muted=!1,e._volume=1,e.iOSAutoEnable=!0,e.noAudio=t,e.usingWebAudio=o,e.ctx=n,t||e._setupCodecs(),e},volume:function(e){var n=this||u;if(e=parseFloat(e),"undefined"!=typeof e&&e>=0&&1>=e){n._volume=e,o&&(r.gain.value=e);for(var t=0;t<n._howls.length;t++)if(!n._howls[t]._webAudio)for(var d=n._howls[t]._getSoundIds(),a=0;a<d.length;a++){var i=n._howls[t]._soundById(d[a]);i&&i._node&&(i._node.volume=i._volume*e)}return n}return n._volume},mute:function(e){var n=this||u;n._muted=e,o&&(r.gain.value=e?0:n._volume);for(var t=0;t<n._howls.length;t++)if(!n._howls[t]._webAudio)for(var d=n._howls[t]._getSoundIds(),a=0;a<d.length;a++){var i=n._howls[t]._soundById(d[a]);i&&i._node&&(i._node.muted=e?!0:i._muted)}return n},codecs:function(e){return(this||u)._codecs[e]},_setupCodecs:function(){var e=this||u,n=new Audio;return e._codecs={mp3:!!n.canPlayType("audio/mpeg;").replace(/^no$/,""),opus:!!n.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!n.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!n.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),aac:!!n.canPlayType("audio/aac;").replace(/^no$/,""),m4a:!!(n.canPlayType("audio/x-m4a;")||n.canPlayType("audio/m4a;")||n.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(n.canPlayType("audio/x-mp4;")||n.canPlayType("audio/mp4;")||n.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!n.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),webm:!!n.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")},e},_enableiOSAudio:function(){var e=this||u;if(!n||!e._iOSEnabled&&/iPhone|iPad|iPod/i.test(navigator.userAgent)){e._iOSEnabled=!1;var o=function(){var t=n.createBuffer(1,1,22050),r=n.createBufferSource();r.buffer=t,r.connect(n.destination),"undefined"==typeof r.start?r.noteOn(0):r.start(0),setTimeout(function(){(r.playbackState===r.PLAYING_STATE||r.playbackState===r.FINISHED_STATE)&&(e._iOSEnabled=!0,e.iOSAutoEnable=!1,window.removeEventListener("touchstart",o,!1))},0)};return window.addEventListener("touchstart",o,!1),e}}};var u=new d,a=function(e){var n=this;return e.src?void n.init(e):void console.error("An array of source files must be passed with any new Howl.")};a.prototype={init:function(e){var t=this;return t._autoplay=e.autoplay||!1,t._ext=e.ext||null,t._html5=e.html5||!1,t._muted=e.mute||!1,t._loop=e.loop||!1,t._pool=e.pool||5,t._preload="boolean"==typeof e.preload?e.preload:!0,t._rate=e.rate||1,t._sprite=e.sprite||{},t._src="string"!=typeof e.src?e.src:[e.src],t._volume=void 0!==e.volume?e.volume:1,t._duration=0,t._loaded=!1,t._sounds=[],t._endTimers={},t._onend=e.onend?[{fn:e.onend}]:[],t._onfaded=e.onfaded?[{fn:e.onfaded}]:[],t._onload=e.onload?[{fn:e.onload}]:[],t._onloaderror=e.onloaderror?[{fn:e.onloaderror}]:[],t._onpause=e.onpause?[{fn:e.onpause}]:[],t._onplay=e.onplay?[{fn:e.onplay}]:[],t._webAudio=o&&!t._html5,"undefined"!=typeof n&&n&&u.iOSAutoEnable&&u._enableiOSAudio(),u._howls.push(t),t._preload&&t.load(),t},load:function(){var e=this,n=null;if(t)return void e._emit("loaderror");for(var o=0;o<e._src.length;o++){var r,d;if(e._ext&&e._ext[o]?r=e._ext[o]:(d=e._src[o],r=/^data:audio\/([^;,]+);/i.exec(d),r||(r=/\.([^.]+)$/.exec(d.split("?",1)[0])),r&&(r=r[1].toLowerCase())),u.codecs(r)){n=e._src[o];break}}return n?(e._src=n,new i(e),e._webAudio&&s(e),e):void e._emit("loaderror")},play:function(e){var o=this,t=null;if("number"==typeof e)t=e,e=null;else if("undefined"==typeof e){e="__default";for(var r=0,d=0;d<o._sounds.length;d++)o._sounds[d]._paused&&!o._sounds[d]._ended&&(r++,t=o._sounds[d]._id);1===r?e=null:t=null}var a=t?o._soundById(t):o._inactiveSound();if(t&&!e&&(e=a._sprite||"__default"),!a)return null;if(!o._loaded&&!o._sprite[e])return o.once("load",function(){o.play(a._id)}),a._id;if(t&&!a._paused)return a._id;var i=a._seek>0?a._seek:o._sprite[e][0]/1e3,_=(o._sprite[e][0]+o._sprite[e][1])/1e3-i,s=!(!a._loop&&!o._sprite[e][2]),l=function(){o._emit("end",a._id),!o._webAudio&&s&&o.stop(a._id).play(a._id),o._webAudio&&s&&(o._emit("play",a._id),a._seek=a._start||0,a._playStart=n.currentTime,o._endTimers[a._id]=setTimeout(l,1e3*(a._stop-a._start)/Math.abs(o._rate))),o._webAudio&&!s&&(a._paused=!0,a._ended=!0,a._seek=a._start||0,o._clearTimer(a._id),a._node.bufferSource=null),o._webAudio||s||o.stop(a._id)};o._endTimers[a._id]=setTimeout(l,1e3*_/Math.abs(o._rate)),a._paused=!1,a._ended=!1,a._sprite=e,a._seek=i,a._start=o._sprite[e][0]/1e3,a._stop=(o._sprite[e][0]+o._sprite[e][1])/1e3,a._loop=s;var f=a._node;if(o._webAudio){var c=function(){o._refreshBuffer(a);var e=a._muted||o._muted?0:a._volume*u.volume();f.gain.setValueAtTime(e,n.currentTime),a._playStart=n.currentTime,"undefined"==typeof f.bufferSource.start?f.bufferSource.noteGrainOn(0,i,_):f.bufferSource.start(0,i,_),o._endTimers[a._id]||(o._endTimers[a._id]=setTimeout(l,1e3*_/Math.abs(o._rate))),setTimeout(function(){o._emit("play",a._id)},0)};o._loaded?c():(o.once("load",c),o._clearTimer(a._id))}else{var p=function(){f.currentTime=i,f.muted=a._muted||o._muted||u._muted||f.muted,f.volume=a._volume*u.volume(),f.playbackRate=o._rate,setTimeout(function(){f.play(),o._emit("play",a._id)},0)};if(4===f.readyState||!f.readyState&&navigator.isCocoonJS)p();else{var m=function(){o._endTimers[a._id]=setTimeout(l,1e3*_/Math.abs(o._rate)),p(),f.removeEventListener("canplaythrough",m,!1)};f.addEventListener("canplaythrough",m,!1),o._clearTimer(a._id)}}return a._id},pause:function(e){var n=this;if(!n._loaded)return n.once("play",function(){n.pause(e)}),n;for(var o=n._getSoundIds(e),t=0;t<o.length;t++){n._clearTimer(o[t]);var r=n._soundById(o[t]);if(r&&!r._paused){if(r._seek=n.seek(o[t]),r._paused=!0,n._webAudio){if(!r._node.bufferSource)return n;"undefined"==typeof r._node.bufferSource.stop?r._node.bufferSource.noteOff(0):r._node.bufferSource.stop(0),r._node.bufferSource=null}else isNaN(r._node.duration)||r._node.pause();arguments[1]||n._emit("pause",r._id)}}return n},stop:function(e){var n=this;if(!n._loaded)return n.once("play",function(){n.stop(e)}),n;for(var o=n._getSoundIds(e),t=0;t<o.length;t++){n._clearTimer(o[t]);var r=n._soundById(o[t]);if(r&&!r._paused)if(r._seek=r._start||0,r._paused=!0,r._ended=!0,n._webAudio){if(!r._node.bufferSource)return n;"undefined"==typeof r._node.bufferSource.stop?r._node.bufferSource.noteOff(0):r._node.bufferSource.stop(0),r._node.bufferSource=null}else isNaN(r._node.duration)||(r._node.pause(),r._node.currentTime=r._start||0)}return n},mute:function(e,o){var t=this;if(!t._loaded)return t.once("play",function(){t.mute(e,o)}),t;if("undefined"==typeof o){if("boolean"!=typeof e)return t._muted;t._muted=e}for(var r=t._getSoundIds(o),d=0;d<r.length;d++){var a=t._soundById(r[d]);a&&(a._muted=e,t._webAudio&&a._node?a._node.gain.setValueAtTime(e?0:a._volume*u.volume(),n.currentTime):a._node&&(a._node.muted=u._muted?!0:e))}return t},volume:function(){var e,o,t=this,r=arguments;if(0===r.length)return t._volume;if(1===r.length){var d=t._getSoundIds(),a=d.indexOf(r[0]);a>=0?o=parseInt(r[0],10):e=parseFloat(r[0])}else 2===r.length&&(e=parseFloat(r[0]),o=parseInt(r[1],10));var i;if(!("undefined"!=typeof e&&e>=0&&1>=e))return i=o?t._soundById(o):t._sounds[0],i?i._volume:0;if(!t._loaded)return t.once("play",function(){t.volume.apply(t,r)}),t;"undefined"==typeof o&&(t._volume=e),o=t._getSoundIds(o);for(var _=0;_<o.length;_++)i=t._soundById(o[_]),i&&(i._volume=e,t._webAudio&&i._node?i._node.gain.setValueAtTime(e*u.volume(),n.currentTime):i._node&&(i._node.volume=e*u.volume()));return t},fade:function(e,o,t,r){var d=this;if(!d._loaded)return d.once("play",function(){d.fade(e,o,t,r)}),d;d.volume(e,r);for(var u=d._getSoundIds(r),a=0;a<u.length;a++){var i=d._soundById(u[a]);if(i)if(d._webAudio){var _=n.currentTime,s=_+t/1e3;i._volume=e,i._node.gain.setValueAtTime(e,_),i._node.gain.linearRampToValueAtTime(o,s),setTimeout(function(e,t){setTimeout(function(){t._volume=o,d._emit("faded",e)},s-n.currentTime>0?Math.ceil(1e3*(s-n.currentTime)):0)}.bind(d,u[a],i),t)}else{var l=Math.abs(e-o),f=e>o?"out":"in",c=l/.01,p=t/c;!function(){var n=e,t=setInterval(function(e){n+="in"===f?.01:-.01,n=Math.max(0,n),n=Math.min(1,n),n=Math.round(100*n)/100,d.volume(n,e),n===o&&(clearInterval(t),d._emit("faded",e))}.bind(d,u[a]),p)}()}}return d},loop:function(){var e,n,o,t=this,r=arguments;if(0===r.length)return t._loop;if(1===r.length){if("boolean"!=typeof r[0])return o=t._soundById(parseInt(r[0],10)),o?o._loop:!1;e=r[0]}else 2===r.length&&(e=r[0],n=parseInt(r[1],10));for(var d=t._getSoundIds(n),u=0;u<d.length;u++)o=t._soundById(d[u]),o&&(o._loop=e);return t},seek:function(){var e,o,t=this,r=arguments;if(0===r.length)o=t._sounds[0]._id;else if(1===r.length){var d=t._getSoundIds(),u=d.indexOf(r[0]);u>=0?o=parseInt(r[0],10):(o=t._sounds[0]._id,e=parseFloat(r[0]))}else 2===r.length&&(e=parseFloat(r[0]),o=parseInt(r[1],10));if("undefined"==typeof o)return t;if(!t._loaded)return t.once("load",function(){t.seek.apply(t,r)}),t;var a=t._soundById(o);if(a){if(!(e>=0))return t._webAudio?a._seek+(n.currentTime-a._playStart):a._node.currentTime;var i=t.playing(o);i&&t.pause(o,!0),a._seek=e,t._clearTimer(o),i&&t.play(o)}return t},playing:function(e){var n=this,o=n._soundById(e)||n._sounds[0];return o?!o._paused:!1},duration:function(){return this._duration},unload:function(){for(var e=this,n=e._sounds,o=0;o<n.length;o++){n[o]._paused||(e.stop(n[o]._id),e._emit("end",n[o]._id)),e._webAudio||(n[o]._node.src="",n[o]._node.removeEventListener("error",n[o]._errorFn,!1),n[o]._node.removeEventListener("canplaythrough",n[o]._loadFn,!1)),delete n[o]._node,e._clearTimer(n[o]._id);var t=u._howls.indexOf(e);t>=0&&u._howls.splice(t,1)}return _&&delete _[e._src],e=null,null},on:function(e,n,o){var t=this,r=t["_on"+e];return"function"==typeof n&&r.push({id:o,fn:n}),t},off:function(e,n,o){var t=this,r=t["_on"+e];if(n){for(var d=0;d<r.length;d++)if(n===r[d].fn&&o===r[d].id){r.splice(d,1);break}}else r=[];return t},once:function(e,n,o){var t=this,r=function(){n.apply(t,arguments),t.off(e,r,o)};return t.on(e,r,o),t},_emit:function(e,n,o){for(var t=this,r=t["_on"+e],d=0;d<r.length;d++)r[d].id&&r[d].id!==n||setTimeout(function(e){e.call(this,n,o)}.bind(t,r[d].fn),0);return t},_clearTimer:function(e){var n=this;return n._endTimers[e]&&(clearTimeout(n._endTimers[e]),delete n._endTimers[e]),n},_soundById:function(e){for(var n=this,o=0;o<n._sounds.length;o++)if(e===n._sounds[o]._id)return n._sounds[o];return null},_inactiveSound:function(){var e=this;e._drain();for(var n=0;n<e._sounds.length;n++)if(e._sounds[n]._ended)return e._sounds[n].reset();return new i(e)},_drain:function(){var e=this,n=e._pool,o=0,t=0;if(!(e._sounds.length<n)){for(t=0;t<e._sounds.length;t++)e._sounds[t]._ended&&o++;for(t=e._sounds.length-1;t>=0;t--){if(n>=o)return;e._sounds[t]._ended&&(e._webAudio&&e._sounds[t]._node&&e._sounds[t]._node.disconnect(0),e._sounds.splice(t,1),o--)}}},_getSoundIds:function(e){var n=this;if("undefined"==typeof e){for(var o=[],t=0;t<n._sounds.length;t++)o.push(n._sounds[t]._id);return o}return[e]},_refreshBuffer:function(e){var o=this;return e._node.bufferSource=n.createBufferSource(),e._node.bufferSource.buffer=_[o._src],e._node.bufferSource.connect(e._panner?e._panner:e._node),e._node.bufferSource.loop=e._loop,e._loop&&(e._node.bufferSource.loopStart=e._start||0,e._node.bufferSource.loopEnd=e._stop),e._node.bufferSource.playbackRate.value=o._rate,o}};var i=function(e){this._parent=e,this.init()};if(i.prototype={init:function(){var e=this,n=e._parent;return e._muted=n._muted,e._loop=n._loop,e._volume=n._volume,e._muted=n._muted,e._seek=0,e._paused=!0,e._ended=!0,e._id=Math.round(Date.now()*Math.random()),n._sounds.push(e),e.create(),e},create:function(){var e=this,o=e._parent,t=u._muted||e._muted||e._parent._muted?0:e._volume*u.volume();return o._webAudio?(e._node="undefined"==typeof n.createGain?n.createGainNode():n.createGain(),e._node.gain.setValueAtTime(t,n.currentTime),e._node.paused=!0,e._node.connect(r)):(e._node=new Audio,e._errorFn=e._errorListener.bind(e),e._node.addEventListener("error",e._errorFn,!1),e._loadFn=e._loadListener.bind(e),e._node.addEventListener("canplaythrough",e._loadFn,!1),e._node.src=o._src,e._node.preload="auto",e._node.volume=t,e._node.load()),e},reset:function(){var e=this,n=e._parent;return e._muted=n._muted,e._loop=n._loop,e._volume=n._volume,e._muted=n._muted,e._seek=0,e._paused=!0,e._ended=!0,e._sprite=null,e._id=Math.round(Date.now()*Math.random()),e},_errorListener:function(){var e=this;e._node.error&&4===e._node.error.code&&(u.noAudio=!0),e._parent._emit("loaderror",e._id,e._node.error?e._node.error.code:0),e._node.removeEventListener("error",e._errorListener,!1)},_loadListener:function(){var e=this,n=e._parent;n._duration=Math.ceil(10*e._node.duration)/10,0===Object.keys(n._sprite).length&&(n._sprite={__default:[0,1e3*n._duration]}),n._loaded||(n._loaded=!0,n._emit("load")),n._autoplay&&n.play(),e._node.removeEventListener("canplaythrough",e._loadListener,!1)}},o)var _={},s=function(e){var n=e._src;if(_[n])return e._duration=_[n].duration,void c(e);if(/^data:[^;]+;base64,/.test(n)){for(var o=atob(n.split(",")[1]),t=new Uint8Array(o.length),r=0;r<o.length;++r)t[r]=o.charCodeAt(r);f(t.buffer,e)}else{var d=new XMLHttpRequest;d.open("GET",n,!0),d.responseType="arraybuffer",d.onload=function(){f(d.response,e)},d.onerror=function(){e._webAudio&&(e._buffer=!0,e._webAudio=!1,e._sounds=[],delete _[n],e.load())},l(d)}},l=function(e){try{e.send()}catch(n){e.onerror()}},f=function(e,o){n.decodeAudioData(e,function(e){e&&(_[o._src]=e,c(o,e))},function(){o._emit("loaderror")})},c=function(e,n){n&&!e._duration&&(e._duration=n.duration),0===Object.keys(e._sprite).length&&(e._sprite={__default:[0,1e3*e._duration]}),e._loaded||(e._loaded=!0,e._emit("load")),e._autoplay&&e.play()};"function"==typeof define&&define.amd&&define("howler",function(){return{Howler:u,Howl:a}}),"undefined"!=typeof exports&&(exports.Howler=u,exports.Howl=a),"undefined"!=typeof window&&(window.HowlerGlobal=d,window.Howler=u,window.Howl=a,window.Sound=i)}(),function($,global){"use strict";function ResponsiveImages(){imgix.onready(function(){imgix.fluid()})}global.gogoro=global.gogoro||{},global.gogoro.common=global.gogoro.common||{},global.gogoro.common.ResponsiveImages=ResponsiveImages}(window.jQuery,window),function(define){"use strict";define(["jquery"],function($){function both(val){return $.isFunction(val)||$.isPlainObject(val)?val:{top:val,left:val}}var $scrollTo=$.scrollTo=function(target,duration,settings){return $(window).scrollTo(target,duration,settings)};return $scrollTo.defaults={axis:"xy",duration:0,limit:!0},$scrollTo.window=function(){return $(window)._scrollable()},$.fn._scrollable=function(){return this.map(function(){var elem=this,isWin=!elem.nodeName||-1!==$.inArray(elem.nodeName.toLowerCase(),["iframe","#document","html","body"]);if(!isWin)return elem;var doc=(elem.contentWindow||elem).document||elem.ownerDocument||elem;return/webkit/i.test(navigator.userAgent)||"BackCompat"===doc.compatMode?doc.body:doc.documentElement})},$.fn.scrollTo=function(target,duration,settings){return"object"==typeof duration&&(settings=duration,duration=0),"function"==typeof settings&&(settings={onAfter:settings}),"max"===target&&(target=9e9),settings=$.extend({},$scrollTo.defaults,settings),duration=duration||settings.duration,settings.queue=settings.queue&&settings.axis.length>1,settings.queue&&(duration/=2),settings.offset=both(settings.offset),settings.over=both(settings.over),this._scrollable().each(function(){function animate(callback){$elem.animate(attr,duration,settings.easing,callback&&function(){callback.call(this,targ,settings)})}if(null!==target){var toff,elem=this,$elem=$(elem),targ=target,attr={},win=$elem.is("html,body");switch(typeof targ){case"number":case"string":if(/^([+-]=?)?\d+(\.\d+)?(px|%)?$/.test(targ)){targ=both(targ);break}if(targ=win?$(targ):$(targ,this),!targ.length)return;case"object":(targ.is||targ.style)&&(toff=(targ=$(targ)).offset())}var offset=$.isFunction(settings.offset)&&settings.offset(elem,targ)||settings.offset;$.each(settings.axis.split(""),function(i,axis){var Pos="x"===axis?"Left":"Top",pos=Pos.toLowerCase(),key="scroll"+Pos,old=elem[key],max=$scrollTo.max(elem,axis);if(toff)attr[key]=toff[pos]+(win?0:old-$elem.offset()[pos]),settings.margin&&(attr[key]-=parseInt(targ.css("margin"+Pos),10)||0,attr[key]-=parseInt(targ.css("border"+Pos+"Width"),10)||0),attr[key]+=offset[pos]||0,settings.over[pos]&&(attr[key]+=targ["x"===axis?"width":"height"]()*settings.over[pos]);else{var val=targ[pos];attr[key]=val.slice&&"%"===val.slice(-1)?parseFloat(val)/100*max:val}settings.limit&&/^\d+$/.test(attr[key])&&(attr[key]=attr[key]<=0?0:Math.min(attr[key],max)),!i&&settings.queue&&(old!==attr[key]&&animate(settings.onAfterFirst),delete attr[key])}),animate(settings.onAfter)}}).end()},$scrollTo.max=function(elem,axis){var Dim="x"===axis?"Width":"Height",scroll="scroll"+Dim;if(!$(elem).is("html,body"))return elem[scroll]-$(elem)[Dim.toLowerCase()]();var size="client"+Dim,html=elem.ownerDocument.documentElement,body=elem.ownerDocument.body;return Math.max(html[scroll],body[scroll])-Math.min(html[size],body[size])},$scrollTo})}("function"==typeof define&&define.amd?define:function(deps,factory){"use strict";"undefined"!=typeof module&&module.exports?module.exports=factory(require("jquery")):factory(jQuery)}),function($,global){"use strict";function VideoModal(){var self=this;$(".launch-video-modal").unbind().on("click",function(e){e.preventDefault(),self.launch(this)})}global.gogoro=global.gogoro||{},global.gogoro.common=global.gogoro.common||{},global.gogoro.common.VideoModal=VideoModal,VideoModal.prototype.launch=function(element){var self=this,videoSrc=$(element).attr("data-video-src"),videoId=$(element).attr("data-video-id");$("<div>",{"class":"video-modal"}).appendTo("body"),$("<a>",{href:"#","class":"close-video-modal",html:'<i class="icon-close"></i>'}).appendTo(".video-modal"),$("<div>",{"class":"container"}).appendTo(".video-modal"),$("<div>",{"class":"row vertical-center-simple"}).appendTo(".video-modal .container"),$("<div>",{"class":"col-sm-10 col-sm-offset-1 video-container embed-responsive embed-responsive-16by9"}).appendTo(".video-modal .row"),$("<iframe>",{id:videoId,"class":"embed-responsive-item",src:videoSrc,allowfullscreen:"",frameborder:"0"}).appendTo(".video-modal .video-container"),$("#"+videoId).attr("width",972),$("#"+videoId).attr("height",547),setTimeout(function(){$(".video-modal").velocity("stop").velocity("fadeIn"),$(".video-modal .close-video-modal, .video-modal").on("click",function(e){e.preventDefault(),self.close(videoSrc,"#"+videoId)})},100),$("html.lt-ie9").length&&(setTimeout(function(){var videoPosY=($(".video-modal .video-container").outerHeight()-$(window).outerHeight())/2;$(".video-modal .video-container").css({top:Math.abs(videoPosY)})},1e3),$(window).resize(function(){var videoPosY=($(".video-modal .video-container").outerHeight()-$(window).outerHeight())/2;$(".video-modal .video-container").css({top:Math.abs(videoPosY)})}))},VideoModal.prototype.close=function(src,id){var $target=$(".video-modal");$(id)[0].contentWindow.postMessage('{"event":"command","func":"pauseVideo","args":""}',"*"),$target.velocity("stop").velocity("fadeOut",{complete:function(){$target.remove()}}),$("body").removeClass("video-modal-active")}}(window.jQuery,window),function(w){"use strict";function callMedia(){applyMedia(!0)}var respond={};w.respond=respond,respond.update=function(){};var requestQueue=[],xmlHttp=function(){var xmlhttpmethod=!1;try{xmlhttpmethod=new w.XMLHttpRequest}catch(e){xmlhttpmethod=new w.ActiveXObject("Microsoft.XMLHTTP")}return function(){return xmlhttpmethod}}(),ajax=function(url,callback){var req=xmlHttp();req&&(req.open("GET",url,!0),req.onreadystatechange=function(){4!==req.readyState||200!==req.status&&304!==req.status||callback(req.responseText)},4!==req.readyState&&req.send(null))},isUnsupportedMediaQuery=function(query){return query.replace(respond.regex.minmaxwh,"").match(respond.regex.other)};if(respond.ajax=ajax,respond.queue=requestQueue,respond.unsupportedmq=isUnsupportedMediaQuery,respond.regex={media:/@media[^\{]+\{([^\{\}]*\{[^\}\{]*\})+/gi,keyframes:/@(?:\-(?:o|moz|webkit)\-)?keyframes[^\{]+\{(?:[^\{\}]*\{[^\}\{]*\})+[^\}]*\}/gi,comments:/\/\*[^*]*\*+([^/][^*]*\*+)*\//gi,urls:/(url\()['"]?([^\/\)'"][^:\)'"]+)['"]?(\))/g,findStyles:/@media *([^\{]+)\{([\S\s]+?)$/,only:/(only\s+)?([a-zA-Z]+)\s?/,minw:/\(\s*min\-width\s*:\s*(\s*[0-9\.]+)(px|em)\s*\)/,maxw:/\(\s*max\-width\s*:\s*(\s*[0-9\.]+)(px|em)\s*\)/,minmaxwh:/\(\s*m(in|ax)\-(height|width)\s*:\s*(\s*[0-9\.]+)(px|em)\s*\)/gi,other:/\([^\)]*\)/g},respond.mediaQueriesSupported=w.matchMedia&&null!==w.matchMedia("only all")&&w.matchMedia("only all").matches,!respond.mediaQueriesSupported){var lastCall,resizeDefer,eminpx,doc=w.document,docElem=doc.documentElement,mediastyles=[],rules=[],appendedEls=[],parsedSheets={},resizeThrottle=30,head=doc.getElementsByTagName("head")[0]||docElem,base=doc.getElementsByTagName("base")[0],links=head.getElementsByTagName("link"),getEmValue=function(){var ret,div=doc.createElement("div"),body=doc.body,originalHTMLFontSize=docElem.style.fontSize,originalBodyFontSize=body&&body.style.fontSize,fakeUsed=!1;return div.style.cssText="position:absolute;font-size:1em;width:1em",body||(body=fakeUsed=doc.createElement("body"),body.style.background="none"),docElem.style.fontSize="100%",body.style.fontSize="100%",body.appendChild(div),fakeUsed&&docElem.insertBefore(body,docElem.firstChild),ret=div.offsetWidth,fakeUsed?docElem.removeChild(body):body.removeChild(div),docElem.style.fontSize=originalHTMLFontSize,originalBodyFontSize&&(body.style.fontSize=originalBodyFontSize),ret=eminpx=parseFloat(ret)},applyMedia=function(fromResize){var name="clientWidth",docElemProp=docElem[name],currWidth="CSS1Compat"===doc.compatMode&&docElemProp||doc.body[name]||docElemProp,styleBlocks={},lastLink=links[links.length-1],now=(new Date).getTime();if(fromResize&&lastCall&&resizeThrottle>now-lastCall)return w.clearTimeout(resizeDefer),void(resizeDefer=w.setTimeout(applyMedia,resizeThrottle));lastCall=now;for(var i in mediastyles)if(mediastyles.hasOwnProperty(i)){var thisstyle=mediastyles[i],min=thisstyle.minw,max=thisstyle.maxw,minnull=null===min,maxnull=null===max,em="em";min&&(min=parseFloat(min)*(min.indexOf(em)>-1?eminpx||getEmValue():1)),max&&(max=parseFloat(max)*(max.indexOf(em)>-1?eminpx||getEmValue():1)),thisstyle.hasquery&&(minnull&&maxnull||!(minnull||currWidth>=min)||!(maxnull||max>=currWidth))||(styleBlocks[thisstyle.media]||(styleBlocks[thisstyle.media]=[]),styleBlocks[thisstyle.media].push(rules[thisstyle.rules]))}for(var j in appendedEls)appendedEls.hasOwnProperty(j)&&appendedEls[j]&&appendedEls[j].parentNode===head&&head.removeChild(appendedEls[j]);appendedEls.length=0;for(var k in styleBlocks)if(styleBlocks.hasOwnProperty(k)){var ss=doc.createElement("style"),css=styleBlocks[k].join("\n");ss.type="text/css",ss.media=k,head.insertBefore(ss,lastLink.nextSibling),ss.styleSheet?ss.styleSheet.cssText=css:ss.appendChild(doc.createTextNode(css)),appendedEls.push(ss)}},translate=function(styles,href,media){var qs=styles.replace(respond.regex.comments,"").replace(respond.regex.keyframes,"").match(respond.regex.media),ql=qs&&qs.length||0;href=href.substring(0,href.lastIndexOf("/"));var repUrls=function(css){return css.replace(respond.regex.urls,"$1"+href+"$2$3")},useMedia=!ql&&media;href.length&&(href+="/"),useMedia&&(ql=1);for(var i=0;ql>i;i++){var fullq,thisq,eachq,eql;useMedia?(fullq=media,rules.push(repUrls(styles))):(fullq=qs[i].match(respond.regex.findStyles)&&RegExp.$1,rules.push(RegExp.$2&&repUrls(RegExp.$2))),eachq=fullq.split(","),eql=eachq.length;for(var j=0;eql>j;j++)thisq=eachq[j],isUnsupportedMediaQuery(thisq)||mediastyles.push({media:thisq.split("(")[0].match(respond.regex.only)&&RegExp.$2||"all",rules:rules.length-1,hasquery:thisq.indexOf("(")>-1,minw:thisq.match(respond.regex.minw)&&parseFloat(RegExp.$1)+(RegExp.$2||""),maxw:thisq.match(respond.regex.maxw)&&parseFloat(RegExp.$1)+(RegExp.$2||"")})}applyMedia()},makeRequests=function(){if(requestQueue.length){var thisRequest=requestQueue.shift();ajax(thisRequest.href,function(styles){translate(styles,thisRequest.href,thisRequest.media),parsedSheets[thisRequest.href]=!0,w.setTimeout(function(){makeRequests()},0)})}},ripCSS=function(){for(var i=0;i<links.length;i++){var sheet=links[i],href=sheet.href,media=sheet.media,isCSS=sheet.rel&&"stylesheet"===sheet.rel.toLowerCase();href&&isCSS&&!parsedSheets[href]&&(sheet.styleSheet&&sheet.styleSheet.rawCssText?(translate(sheet.styleSheet.rawCssText,href,media),parsedSheets[href]=!0):(!/^([a-zA-Z:]*\/\/)/.test(href)&&!base||href.replace(RegExp.$1,"").split("/")[0]===w.location.host)&&("//"===href.substring(0,2)&&(href=w.location.protocol+href),requestQueue.push({href:href,media:media})))}makeRequests()};ripCSS(),respond.update=ripCSS,respond.getEmValue=getEmValue,w.addEventListener?w.addEventListener("resize",callMedia,!1):w.attachEvent&&w.attachEvent("onresize",callMedia)}}(this);